function saveFormLayout(a,b,c,d,e){var f="";null!=a&&(screenerForm.savedTab=a),null==screenerForm.savedTab&&(screenerForm.savedTab=screenerForm.contentDivIdsArray[0]),f+=screenerForm.savedTab,null!=b&&(screenerForm.savedType[a]=b),null!=screenerForm.savedType&&null!=screenerForm.savedType[a]&&null!=b&&(f+="|"+screenerForm.savedType[a]),screenerForm.savedMarket=c,null!=screenerForm.savedMarket&&(f+="|"+screenerForm.savedMarket),screenerForm.savedMaturityRange=d,null!=screenerForm.savedMaturityRange&&(f+="|"+screenerForm.savedMaturityRange),screenerForm.savedOpenedNewIssueTypes=e,null!=screenerForm.savedOpenedNewIssueTypes&&(f+="|"+screenerForm.savedOpenedNewIssueTypes),document.location.hash=f;var g=jQuery.Event("TMS_Trigger");$(document).trigger(g,[location.hash.slice(1)])}function annuitiesStateChange(a){$("#period_select").val("1").change(),defaultAnnuitiesColumns(),"Select one"!=$("#state_select").find(":selected").text()?annuitiesLoadStates(a[a.selectedIndex].value):$("#period_select").attr("disabled","disabled")}function annuitiesPeriodFilter(){var a=document.getElementById("period_select");-1==a.selectedIndex&&(a.selectedIndex=0),0===a.selectedIndex?[].forEach.call(document.querySelectorAll("#annuitiesTable tbody [hidden]"),function(a){a.removeAttribute("hidden","hidden")}):[].forEach.call(document.querySelectorAll("#annuitiesTable tbody tr"),function(b){b.className==a[a.selectedIndex].value?b.removeAttribute("hidden","hidden"):b.setAttribute("hidden","hidden")})}function renderAnnuitiesTab(){var a,b,c,d,e,f=[];if((e=JSON.parse(sessionStorage.getItem("annuitiesTabData")))&&0!==e.length){document.getElementById("annuitiesAsOf").innerHTML="As of "+e.ratesAsOfDate,document.querySelector("#annuitiesTable tbody").innerHTML="";for(a in e.rateList)b=document.querySelector("#annuitiesTable tbody"),c=b.insertRow(-1),c.className="guarantee_period_"+e.rateList[a].guaranteePeriod,d=c.insertCell(0),d.innerHTML="<a href='https://www.fidelity.com/annuities/deferred-fixed-annuities/compare' target='_blank'>"+e.rateList[a].issuerProduct,d=c.insertCell(1),d.innerHTML=""==e.rateList[a].guaranteePeriod?"--":e.rateList[a].guaranteePeriod+" years",d=c.insertCell(2),d.innerHTML=""==e.rateList[a].baseRatePct?"--":e.rateList[a].baseRatePct+"%",d=c.insertCell(3),d.innerHTML=""==e.rateList[a].jumboRatePct?"--":e.rateList[a].jumboRatePct+"%",isNaN(parseFloat(e.rateList[a].guaranteePeriod))||f.push(e.rateList[a].guaranteePeriod)}else displayAnnuitiesErrorMsg();return f}function annuitiesLoadStates(a){function b(a){return a.filter(function(a,b,c){return c.indexOf(a)===b})}var c="",d=[];$.ajax({type:"GET",url:"/ftgw/fi/FIAnnuityData?stateCode="+a,data:"",accepts:{text:"application/json"},success:function(a){if(sessionStorage.setItem("annuitiesTabData",a),a&&0!==a.length){d=renderAnnuitiesTab(),sortAnnuitiesInit("guaranteePeriod"),d=b(d),d.sort(function(a,b){return parseFloat(a)>parseFloat(b)?1:parseFloat(a)<parseFloat(b)?-1:0}),document.getElementById("period_select").length=1;for(i in d)c=document.createElement("option"),c.innerHTML=d[i]+" years",c.value="guarantee_period_"+d[i],document.getElementById("period_select").appendChild(c);document.getElementById("period_select").selectedIndex=0,$("#period_select").removeAttr("disabled"),document.getElementById("annuitiesError").setAttribute("hidden","hidden"),document.getElementById("annuitiesTableForm").removeAttribute("hidden","hidden"),$(".annIconHelp").tooltip()}else displayAnnuitiesErrorMsg()},error:function(a,b,c){displayAnnuitiesErrorMsg()}})}function displayAnnuitiesErrorMsg(){document.getElementById("annuitiesError").removeAttribute("hidden","hidden"),document.getElementById("annuitiesTableForm").setAttribute("hidden","hidden"),$("#period_select").attr("disabled","disabled")}function sortAnnuitiesTable(a,b){var c,d,e="issuerProduct",f=JSON.parse(sessionStorage.getItem("annuitiesTabData"));f&&f.rateList?(a===issuerProduct?f.rateList.sort(function(c,d){return"asc"===b?c[a]>d[a]?1:c[a]<d[a]?-1:0:d[a]>c[a]?1:d[a]<c[a]?-1:0}):f.rateList.sort(function(f,g){return c=isNaN(parseFloat(f[a]))?0:parseFloat(f[a]),d=isNaN(parseFloat(g[a]))?0:parseFloat(g[a]),"asc"===b?c>d?1:c<d?-1:f[e]>g[e]?1:f[e]<g[e]?-1:0:d>c?1:d<c?-1:g[e]>f[e]?1:g[e]<f[e]?-1:0}),sessionStorage.setItem("annuitiesTabData",JSON.stringify(f)),renderAnnuitiesTab(),annuitiesPeriodFilter()):displayAnnuitiesErrorMsg()}function sortAnnuitiesInit(a){var b="#"+a+" .annSortArrow",c=document.getElementById(a),d=c.getAttribute("sortOrder");sortAnnuitiesTable(a,d),defaultAnnuitiesColumns(),c.classList.add("borderBottomBlack"),"asc"===d?(document.querySelector(b).classList.add("black_up_arrow"),c.setAttribute("sortOrder","desc")):(document.querySelector(b).classList.add("black_dwn_arrow"),c.setAttribute("sortOrder","asc"))}function defaultAnnuitiesColumns(){[].forEach.call(document.querySelectorAll(".annSortArrow"),function(a){a.classList.remove("black_dwn_arrow"),a.classList.remove("black_up_arrow"),a.parentElement.setAttribute("sortOrder","desc"),a.parentElement.classList.remove("borderBottomBlack")}),document.getElementById("guaranteePeriod").setAttribute("sortOrder","asc")}function showHideCombo(a){saveFormLayout(null,clickedListId,a.id)}function updateSelect(a){for(var b=document.getElementById(a),c=b.getElementsByTagName("input"),d=[],e=1;e<c.length;e++)c[e].checked&&d.push(c[e].value);var f="",g=screenerForm.clickedSelectMenu.options[0].text;f=0==d.length?"All":g.indexOf("Morningstar Rating")>-1?d.join(", "):d.length,screenerForm.clickedSelectMenu&&(g.indexOf("State")>-1?screenerForm.clickedSelectMenu.options[0].text="States: "+f:g.indexOf("Categor")>-1?screenerForm.clickedSelectMenu.options[0].text="Categories: "+f:g.indexOf("Morningstar Rating")>-1&&(screenerForm.clickedSelectMenu.options[0].text="Morningstar Ratings: "+f))}function showhidepopup(a,b){var c=document.getElementById(a),d=document.getElementById("blankdiv");if("block"==c.style.display)openPopup="",c.style.display="none",d&&(d.style.display="none"),updateSelect(a);else{if("default"!=b.options[b.selectedIndex].value){openPopup=a,c.style.display="block",c.style.position="absolute",c.style.left=getAbsoluteLeft(b)-c.offsetWidth/2+100+"px",c.style.top=getAbsoluteTop(b)+b.offsetHeight+10+"px";parseInt(c.style.left,10)+c.offsetWidth>screen.right&&(c.style.left=screen.right-c.offsetWidth-10+"px"),d&&(d.style.display="block")}}b&&(screenerForm.clickedSelectMenu=b,b.blur())}function closeOpenPopup(){if(""!=openPopup){updateSelect(openPopup);var a=document.getElementById(openPopup),b=document.getElementById("blankdiv");a.style.display="none",b&&(b.style.display="none")}}function selectDeselectAll(a){var b=document.getElementById(a),c=b.getElementsByTagName("input");c[0].checked="checked";for(var d=1;d<c.length;d++)"checkbox"==c[d].getAttribute("type")&&(c[d].checked="")}function selectDeselectOther(a){for(var b=document.getElementById(a),c=b.getElementsByTagName("input"),d=!1,e=1;e<c.length;e++)if(c[e].checked){d=!0;break}c[0].checked=d?"":"checked"}function hideShowContents(a,b,c){forminfo.fundSelected=b;var d=a.getElementsByTagName("SELECT");if(""!=b)for(var e=0;e<d.length;e++)"true"==c?d[e].style.display="none":(d[e].style.visibility="visible",d[e].style.display="inline","corporate"==b||"agency"==b||"yield"==b?"type"!=d[e].id&&"state"!=d[e].id&&"sinking"!=d[e].id||(d[e].style.display="none"):("multisector"==b||"yield-bond"==b?"investmentCategory"==d[e].id||"muniCategory"==d[e].id||"internationalCategory"==d[e].id?d[e].style.display="none":d[e].style.display="inline":("investment"==b&&("investmentCategory"==d[e].id&&(d[e].style.display="inline"),"muniCategory"!=d[e].id&&"internationalCategory"!=d[e].id||(d[e].style.display="none")),"municipal-bond"==b&&("muniCategory"==d[e].id&&(d[e].style.display="inline"),"investmentCategory"!=d[e].id&&"internationalCategory"!=d[e].id||(d[e].style.display="none")),"international"==b&&("internationalCategory"==d[e].id&&(d[e].style.display="inline"),"muniCategory"!=d[e].id&&"investmentCategory"!=d[e].id||(d[e].style.display="none"))),"type"==d[e].id&&(d[e].style.display="none")),"yield"==b?("credit"==d[e].id&&(d[e].style.display="none"),"highyieldCredit"==d[e].id&&(d[e].style.display="inline")):("credit"==d[e].id&&(d[e].style.display="inline"),"highyieldCredit"==d[e].id&&(d[e].style.display="none")))}function changeOption(a){"treasury"==a?(document.getElementById("treasury-option").style.display="block",document.getElementById("other-option").style.display="none",document.getElementById("corp-hy-option").style.display="none"):"yield"==a?(document.getElementById("treasury-option").style.display="none",document.getElementById("other-option").style.display="none",document.getElementById("corp-hy-option").style.display="block"):(document.getElementById("other-option").style.display="block",document.getElementById("treasury-option").style.display="none",document.getElementById("corp-hy-option").style.display="none")}function createFindVsDesc(a){var b=null;return"bond-tab-content"==a.id?b=document.getElementById("bond-find"):"fund-tab-content"==a.id?b=document.getElementById("fund-find"):"cd-tab-content"==a.id&&(b=document.getElementById("cd-find")),b}function validate(a){for(var b="\n",c=document.getElementById(a),d=c.getElementsByTagName("select"),e=0;e<d.length;e++){if("none"!=d[e].style.display)if(""==d[e].style.display&&"type"!=d[e].id);else switch(d[e].options[d[e].selectedIndex].value){case"Type":b+=" - Select Type";break;case"Maturity":b+="\n - Select Maturity";break;case"Credit Quality":b+="\n - Select Credit Quality";break;case"Callable Bonds":b+="\n - Select Callable Bonds";break;case"sinking":b+="\n - Select Sinking Fund Protection";break;case"Grade":b+="\n - Select Grade";break;case"state":for(var f=document.getElementById("states-list"),g=f.getElementsByTagName("input"),h=0,i=1;i<g.length;i++){var j=g[i];j.checked&&(h+=1)}h>5&&(b+="\n - Select 5 States or All")}if(e==d.length-1)if("\n"!=b)alert("You must complete all required fields"+b);else if("bond-tab-content"!==a&&"cd-tab-content"!==a){var k=fundresearch_url+"/fund-screener/results/table/overview/averageAnnualReturnsYear3/desc/1?",l="",m="&msrV=advanced",n="",o="TBND";switch(forminfo.fundSelected){case"investment":l=processCheckboxDiv("investment",o);break;case"municipal-bond":o="MBND",l=processCheckboxDiv("muni",o);break;case"multisector":l="&ft="+encodeURIComponent("TBND_MU");break;case"international":l=processCheckboxDiv("international",o);break;case"yield-bond":l="&ft="+encodeURIComponent("TBND_BL,TBND_HY")}var p=document.getElementById("morningstarDiv");if(mstarInput=p.getElementsByTagName("input"),!mstarInput[0].checked){for(var q="",r=0,e=1;e<mstarInput.length;e++){var j=mstarInput[e];j.checked&&(r++,q+=1==r?j.value:","+j.value)}0!=r&&(n="&msrA="+encodeURIComponent(q))}k+=l+m+n,fidFundsOnlyCB=document.getElementById("fidelity-fund"),fidFundsOnlyCB.checked&&(k+="&fidelityFundOnly=F"),window.location=k}}}function processCheckboxDiv(a,b){var c="",d="",e=0,f=document.getElementById(a+"CategoryDiv");inputs=f.getElementsByTagName("input");for(var g=1;g<inputs.length;g++){var h=inputs[g];d+=1==g?b+"_"+h.value:","+b+"_"+h.value,h.checked&&(e++,c+=1==e?b+"_"+h.value:","+b+"_"+h.value)}return""==c&&(c="MBND"==b?b+"_"+inputs[0].value:d),c="&ft="+encodeURIComponent(c)}function selectGrade(a){hideShowContents(document.getElementById("bond-tab-content"),a.options[a.selectedIndex].value,"false")}function submitBondFundSrch(){var a=document.getElementById("findFundsForm").question;if(""==a.value||"Search Funds          "==a.value&&!placeholderSupportFlag)return alert("Please enter a search term"),a.focus(),!1;var b=digitalUrl+"/search/funds";return b+="?q="+a.value.replace(/\"/g,""),b+="&category=Muni+California+Intermediate",b+="&category=Muni+California+Long",b+="&category=Muni+Massachusetts",b+="&category=Muni+Minnesota",b+="&category=Muni+New+Jersey",b+="&category=Muni+New+York+Intermediate",b+="&category=Muni+New+York+Long",b+="&category=Muni+Ohio",b+="&category=Muni+Pennsylvania",b+="&category=Muni+Single+State+Interm",b+="&category=Muni+Single+State+Long",b+="&category=Muni+Short",b+="&category=Muni+National+Interm",b+="&category=Muni+National+Long",b+="&category=High+Yield+Muni",b+="&category=AIBF",b+="&category=Emerging+Markets+Bond",b+="&category=World+Bond",b+="&category=ATBF",b+="&category=Ultrashort+Bond",b+="&category=Short+Government",b+="&category=Short-Term+Bond",b+="&category=Intermediate+Government",b+="&category=Intermediate-Term+Bond",b+="&category=Long+Government",b+="&category=Long-Term+Bond",b+="&category=Inflation-Protected+Bond",b+="&category=High+Yield+Bond",b+="&category=Bank+Loan",b+="&category=Multisector+Bond",window.location.href=b,!1}function leaveFidelityUrl(a){confirm("You are about to leave Fidelity.com for a site that is unaffiliated with Fidelity. Fidelity has not been involved in the preparation of the content supplied at the unaffiliated site and does not guarantee or assume any responsibility for its content.")&&window.open(a,"newwindow",config="height=475,width=725,toolbar=yes,menubar=yes,scrollbars=yes,resizable=yes,location=no,directories=no,status=no")}function leaveFidelityUrlRefinitiv(a){confirm("You are leaving Fidelity.com for another website. The site owner is not affiliated with Fidelity and is solely responsible for the information and services it provides. Fidelity disclaims any liability arising from your use of such information or services. Review the new site’s terms, conditions, and privacy policy, as they will be different from those of Fidelity’s sites.")&&window.open(a,"_blank").focus()}function processRefinitivData(a){var b=a.originalEvent.data;switch(b.data.chart){case"priceYield1":case"priceYield2":var c=b.data.ric,d=b.data.period,e=b.data.type;return a.originalEvent.origin+"/PriceYield?ric="+c+"&instrumentNo=1&type="+e+"&period="+d;case"spread":var f=b.data.ric1,g=b.data.ric2,d=b.data.period;return a.originalEvent.origin+"/Spread?ric1="+f+"&ric2="+g+"&period="+d;default:return""}}function refinitivTabClicked(a,b){var c,d,e;for(d=document.getElementsByClassName("refinitiv-tabcontent"),c=0;c<d.length;c++)d[c].style.display="none";for(e=document.getElementsByClassName("refinitiv-tablinks"),c=0;c<e.length;c++)e[c].className=e[c].className.replace(" active","");document.getElementById(b).style.display="block",a.currentTarget.className+=" active"}function Pagination(a,b,c,d){this.pageClass=a,this.linkClass=b,this.selected=c,this.hideNextPrev=d||!0,this.pages=$("."+this.pageClass);var e=$("."+this.linkClass+" li a");this.links=e.slice(1,-1);for(var f=0;f<this.links.length;f++)$(this.links[f]).bind("click",{pageNum:f},$.proxy(this.changePageHandler,this));this.prevLink=e.filter(":first"),this.prevLinkBack="none"!==$(this.prevLink).parent().css("display"),$(this.prevLink).bind("click",$.proxy(this.prevPage,this)),this.nextLink=e.filter(":last"),$(this.nextLink).bind("click",$.proxy(this.nextPage,this))}function showHideDiv(a,b){document.getElementById(a).style.display="none",document.getElementById(b).style.display="block"}function getAbsoluteLeft(a){for(oLeft=a.offsetLeft;null!==a.offsetParent;)oParent=a.offsetParent,oLeft+=oParent.offsetLeft,a=oParent;return oLeft}function getAbsoluteTop(a){for(oTop=a.offsetTop;null!==a.offsetParent;)oParent=a.offsetParent,oTop+=oParent.offsetTop,a=oParent;return oTop}function getScrollXY(){var a=0,b=0;return"number"==typeof window.pageYOffset?(b=window.pageYOffset,a=window.pageXOffset):document.body&&(document.body.scrollLeft||document.body.scrollTop)?(b=document.body.scrollTop,a=document.body.scrollLeft):document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)&&(b=document.documentElement.scrollTop,a=document.documentElement.scrollLeft),[a,b]}function getWindowSize(){var a=0,b=0;return"number"==typeof window.innerWidth?(a=window.innerWidth,b=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(a=document.documentElement.clientWidth,b=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(a=document.body.clientWidth,b=document.body.clientHeight),[a,b]}function ScreenObject(){var a=document.height||document.body.offsetHeight,b=document.width||document.body.offsetWidth;return this.left=getScrollXY()[0],this.right=b>getWindowSize()[0]?getWindowSize()[0]+getScrollXY()[0]:b,this.top=getScrollXY()[1],this.bottom=a>getWindowSize()[1]?getWindowSize()[1]+getScrollXY()[1]:a,this}function popWin(a){var b,c,d=420,e=245;3==popWin.arguments.length&&(e=popWin.arguments[1],d=popWin.arguments[2]);var f=480,g=190;5==popWin.arguments.length&&(e=popWin.arguments[1],d=popWin.arguments[2],f=popWin.arguments[3],g=popWin.arguments[4]),245==e?(b=window.open(a,"infowindow","width="+e+",height="+d+",left="+f+",top="+g+",location=no,resizable=yes,menubar=no,status=no,toolbar=no,scrollbars=yes"),IE4Win||b&&b.focus()):617==e?(c=window.open(a,"infowindow2","width="+e+",height="+d+",left="+f+",top="+g+",location=no,resizable=yes,menubar=no,status=no,toolbar=no,scrollbars=yes"),IE4Win||c&&c.focus()):(b=window.open(a,"infowindow","width="+e+",height="+d+",left="+f+",top="+g+",location=no,resizable=yes,menubar=no,status=no,toolbar=no,scrollbars=yes"),IE4Win||b&&b.focus())}function validateSearch(){return""!=document.getElementById("searchText").value||(alert("Please enter search terms"),!1)}function runResultPage(){var a=document.getElementById("searches").options[document.getElementById("searches").selectedIndex].value;if(null==a||""==a)return alert("You have not selected any option."),!1;var b=new Array;b=a.split("?");var c=b[1],d=fi_url+"/ftgw/fi/gotoBL/FIIndividualBondsSearch?"+c+"operation=run";window.parent.location=d}function hideChatRoompopup(a){document.getElementById(a).style.display="none",chatsourceID&&chatsourceID.focus()}function showChatRoompopup(a,b,c){chatsourceID=a;var d=document.getElementById(b);if(d.style.display="block",d.style.left=getAbsoluteLeft(a)-80+"px",d.style.top=getAbsoluteTop(a)+a.offsetHeight+5+"px",document.getElementById(c)){document.getElementById(c).focus()}}function showChart(a,b){$("#"+a).removeClass("hidden"),$("#"+a+"Link").addClass("selected"),$("#"+b).addClass("hidden"),$("#"+b+"Link").removeClass("selected")}function resizePopup(){window.resizeBy(1,1)}function submitValLink(a,b,c){var d=$(".landingRWVAccounts #account").val();if($(".landingRWVAccounts #account").length&&!d)return void alert("Please select an account");""!=c&&null!=c&&"FIIndividualBondsSearch"==c&&(b+="&displayFormat=TABLE"),b+="&domId="+a.id,d&&(b+="&account="+d);var e=$("#clickedYieldValue").val();""==e&&(e=a.id+"~",$("#clickedYieldValue").val(e)),e&&""!=e&-1==e.indexOf(a.id+"~")&&(e=e+a.id+"~",$("#clickedYieldValue").val(e)),a.href=b}function submitNewIssueCDLink(a,b,c,d){var e=$(".landingRWVAccounts #account").val();if(c&&$(".landingRWVAccounts #account").length&&!e)return $(b).blur(),void alert("Please select an account");null!=e&&""!=e&&(a+="&account="+e),animatedWaitCreate(),$("table.topRates th a").removeClass("clicked"),$(b).addClass("clicked"),saveFormLayout("tbcds","treasury","cd-new-issue",$("#"+d).attr("id").split("-")[1]),jQuery.ajax({type:"GET",async:!0,url:a,dataType:"text",data:"",success:function(a){null!=a&&""!=a?($("#allNewIssues").remove(),$("#cd-newIssues-secondary-toggle").remove(),$("#newIssueCDs #filterRates .topRates").after(a)):$("#allNewIssues").html("<div><p>The application is experiencing technical difficulties.  Please try again later.</p></div>"),animatedWaitDestroy()},error:function(a,b,c){FixedIncome.isSessionTimeout(a)||($("#allNewIssues").html("<div><p>The application is experiencing technical difficulties.  Please try again later.</p></div>"),animatedWaitDestroy())}})}function rebindYTLtagLink(){var a=$("#yieldTableDiv a"),b=0;for(b=0;b<_VS.L(a);b++)_VS.EL(a[b],"mousedown",_VS.LT)}function saveClickForYTLink(){var a=$("#clickedYieldValue").val();if(""!=a){var b=a.split("~");jQuery.each(b,function(){document.getElementById(this)&&$("#"+this).css("color","#800080")})}}function updateYieldTable(){var a=$("#tbcurrent-yields ul li.yields--highest-yield").hasClass("ui-tabs-active");jQuery.ajax({type:"GET",async:!0,url:"/ftgw/fi/FIYieldTable",dataType:"text",data:"",success:function(b){null!=b&&""!=b?($("#tbcurrent-yields").html(b),a||$("#tbcurrent-yields ul li.yields--median-yield a").trigger("click"),saveClickForYTLink()):$("#yieldTableDiv").html("<div><p>The application is experiencing technical difficulties.  Please try again later.</p></div>")},error:function(a,b,c){$("#yieldTableDiv").html("<div><p>The application is experiencing technical difficulties.  Please try again later.</p></div>")}})}function invokeTimer(a,b,c,d){function e(){var b=setInterval(a,c);d&&setTimeout(function(){clearInterval(b)},d)}b||(b=0),arguments.length<=2?setTimeout(a,b):setTimeout(e,b)}function initSubtabs(){var a="",b=location.hash,c=null,d=null,e=null,f=null;if(b=decodeURIComponent(b),b="#"+b.replace(/[^\w|-]/g,""),0==b.indexOf("#tb")){b=b.substring(1);b.indexOf("|")>-1&&(tokens=b.split("|"),b=tokens[0],c=tokens[1],tokens.length>2&&("tbnewissues"==b&&"bond-type"==c?f=tokens[2]:d=tokens[2]),tokens.length>3&&(e=tokens[3]));var g=$.inArray(b,screenerForm.contentDivIdsArray);if(screenerForm.contentDivIdsArray.splice(g,1),screenerForm.contentDivIdsArray.splice(0,0,b),referrerCross){var h=getQueryValue(referrerCross,"requestpage");referrerCross="/ftgw/fi/FindBondsCDsIndividualBonds?"+referrerCross,d&&d.indexOf("cd-market")>-1&&"FILandingCD"===h?cdtaburl=referrerCross:b.indexOf("tbindividual-bonds")>-1&&requestPageHashMappings[h]===c&&(a=referrerCross),firstFlag=!0}a&&$("#ui-id-4").attr("href",a),(null!=b&&null!=c||"tbbondfund"===b||"tbannuities"===b)&&$("#subTabs").tabs({active:$("li[aria-controls="+b+"]").index()}),"tbcds"===b&&("cd-new-issue"===d?($("#subTabs #tbcds .linkTabs li."+d+" a").trigger("click"),null==e?saveFormLayout(screenerForm.contentDivIdsArray[0],"treasury",d):saveFormLayout(screenerForm.contentDivIdsArray[0],"treasury",d,e)):"cd-market"===d?($("#subTabs #tbcds .linkTabs li."+d+" a").trigger("click"),saveFormLayout(screenerForm.contentDivIdsArray[0],"treasury",d)):$("#subTabs #tbcds .linkTabs li.cd-new-issue a").trigger("click")),"tbnewissues"==b&&(showRerunForRWV(),"bond-type"===c?($("#subTabs li.new-issue--bond-type a").trigger("click"),saveFormLayout(screenerForm.contentDivIdsArray[0],null,c,null,f)):"all-offerings"===c?($("#subTabs li.new-issue--all-offerings a").trigger("click"),saveFormLayout(screenerForm.contentDivIdsArray[0],null,c)):$("#subTabs li.new-issue--bond-type a").trigger("click")),"tbcurrent-yields"==b&&("highest-yield"===c?saveFormLayout("tbcurrent-yields",null,"highest-yield"):"median-yield"===c&&($("#subTabs li.yields--median-yield a").trigger("click"),saveFormLayout("tbcurrent-yields",null,"median-yield"))),"tbbondfund"===b&&(loadFundTab(),$("#legal-funds").show()),"tbannuities"===b&&$("#legal-annuities").show(),"tbetfs"===b&&(loadETFTab(),$("#legal-ETFs").show()),"tbetfs"===b||"tbbondfund"===b||"tbannuities"===b?$("#FindBondsCDs .landingRWVAccounts").hide():$("#FindBondsCDs .landingRWVAccounts").show()}$("#subTabs").tabs({load:function(b,c){showDisclaimer(b,c);var d=location.hash,e=null;if(d=decodeURIComponent(d),d="#"+d.replace(/[^\w|-]/g,""),0==d.indexOf("#tb")){d=d.substring(1);d.indexOf("|")>-1&&(tokens=d.split("|"),d=tokens[0],e=tokens[1]);var f=$.inArray(d,screenerForm.contentDivIdsArray);if(screenerForm.contentDivIdsArray.splice(f,1),screenerForm.contentDivIdsArray.splice(0,0,d),"tbindividual-bonds"==screenerForm.contentDivIdsArray[0]){isBackOrEdit=""!=referrerCross||$("#ui-id-4").attr("href")&&-1!=$("#ui-id-4").attr("href").indexOf("&preferenceName=")||-1!=cdtaburl.indexOf("&preferenceName=");var g=getParamByName("requestpage",$("#ui-id-4").attr("href"));e||(e="treasury"),-1===$("#ui-id-4").attr("href").indexOf("&")&&a&&g&&requestPageHashMappings[g]===e?$("#ui-id-4").attr("href",a):(-1===$("#ui-id-4").attr("href").indexOf("&")||g&&requestPageHashMappings[g]!==e)&&$("#ui-id-4").attr("href","/ftgw/fi/FindBondsCDsIndividualBonds?ref_rfi=0010"),removeCDsDom(),null==e?loadBondTab("treasury","pcb_usTreasSec"):($("#firstLoad").val("true"),loadBondsTabWithSubsection(e))}}editFlag||animatedWaitDestroy()},beforeLoad:function(a,b){},beforeActivate:function(a,b){var c=b.newTab.attr("aria-controls"),d=b.newTab.find(".gui-tabs-anchor.locked").length>0||-1===document.cookie.indexOf("SC=");if("tbnewissues"===c&&d)return window.location=contextPath+"/gotoFIBL/FILanding?tab="+c,!1;"tbcds"!==b.newTab.attr("aria-controls")&&("tbcurrent-yields"==b.newTab.attr("aria-controls")?1==$("#tbcurrent-yields li.yields--median-yield").hasClass("ui-tabs-active")?saveFormLayout("tbcurrent-yields",null,"median-yield"):saveFormLayout("tbcurrent-yields",null,"highest-yield"):saveFormLayout(b.newTab.attr("aria-controls"),null,null)),"tbindividual-bonds"===b.newTab.attr("aria-controls")&&removeCDsDom(),"tbcds"===b.newTab.attr("aria-controls")?(removeIndividuslBondsDom(),$("#tbcds .cd-market").hasClass("ui-tabs-active")?$("#subTabs #tbcds .linkTabs li.cd-market a").trigger("click"):$("#tbcds .cd-new-issue").hasClass("ui-tabs-active")&&$("#subTabs #tbcds .linkTabs li.cd-new-issue a").trigger("click")):cdtaburl="","#tbnewissues"===location.hash&&($("#tbindividual-bonds").children().remove(),$("#tbnewissues .new-issue--all-offerings").hasClass("ui-tabs-active")?$("#subTabs li.new-issue--all-offerings a").trigger("click"):$("#tbnewissues .new-issue--bond-type").hasClass("ui-tabs-active")&&$("#subTabs li.new-issue--bond-type a").trigger("click")),"#tbbondfund"===location.hash&&loadFundTab(),"#tbetfs"===location.hash&&loadETFTab(),editFlag||"tbindividual-bonds"!==b.newTab.attr("aria-controls")||"tbnewissues"!==b.oldTab.attr("aria-controls")||$("#ui-id-4").attr("href","/ftgw/fi/FindBondsCDsIndividualBonds?ref_rfi=0010"),"tbnewissues"===b.newTab.attr("aria-controls")?(animatedWaitCreate(),showRerunForRWV()):"tbcds"!=b.newTab.attr("aria-controls")&&hideRerunForRWV(),"tbbondfund"===b.newTab.attr("aria-controls")||"tbetfs"===b.newTab.attr("aria-controls")||"tbannuities"===b.newTab.attr("aria-controls")?$("#FindBondsCDs .landingRWVAccounts").hide():$("#FindBondsCDs .landingRWVAccounts").show(),"tbbondfund"===b.newTab.attr("aria-controls")?"true"!=$("#searchFundsBtn").attr("aria-selected")&&$("#searchFundsBtn a").trigger("click"):"true"!=$("#searchBondsBtn").attr("aria-selected")&&$("#searchBondsBtn a").trigger("click")},activate:function(a,b){showDisclaimer(a,b),showLearnMore()}}),showDisclaimer4YieldsLanding();var i={state:"states",investmentCategory:"investmentCategoryDiv",muniCategory:"muniCategoryDiv",internationalCategory:"internationalCategoryDiv",rating:"morningstarDiv"};for(var j in i){var k=document.getElementById(j);null!=k&&(screenerForm.clickedSelectMenu=k,updateSelect(i[j]))}}function loadBondsTabWithSubsection(a){var b;switch(a){case"treasury":b="pcb_usTreasSec";break;case"tips":b="pcb_advTipsSec";break;case"cd":b="pcb_advCDsSecondary";break;case"agency":b="pcb_advAgencySecodary";break;case"municipal":b="pcb_advMunicipalSec";break;case"corporate":b="pcb_advCorpInvGradeSec";break;case"corphysec":b="pcb_advCorpHighYieldSec";break;case"allofferings":b="pcb_advOffersSec";break;case"advoffernew":b="pcb_advOffersNew";break;case"advcatstigrs":b="pcb_advCatsTigrs";break;default:b="pcb_usTreasSec"}"tips"===a?loadBondTab("treasury",b):"corphysec"===a?loadBondTab("corporate",b):"advoffernew"===a||"advcatstigrs"===a?loadBondTab("allofferings",b):loadBondTab(a,b)}function loadBondsSubTab(){var a=decodeURIComponent(location.hash).replace(/[^\w|-]/g,"");if(0==a.indexOf("tb")){var b=a.indexOf("|"),c="";c=b>-1&&a.split("|")[1].length?a.split("|")[1]:"treasury",loadBondsTabWithSubsection(c)}}function loadFundTab(){FixedIncome.bodyView.animatedWaitCreate(),$.ajax({type:"GET",url:"/ftgw/fi/FindBondsCDsFunds",data:"",success:function(a){$("#tbbondfund").html(a);var b=new FixedIncome.MFEPreCountParam,c=new FixedIncome.FundsSearchSelectTypeView({el:$("#bondfund #result-body #search-panel .section1"),model:b}),d=(new FixedIncome.FundsSearchMiddleFilter({el:$("#bondfund #result-body #search-panel .section2"),model:b}),new FixedIncome.FundsSearchBottomView({el:$("#search-bottom"),model:b,aValDeferred:c.aValDeferred}));$.when(c.fundtypeDeferred,d.previewCountDeferred).done(function(){FixedIncome.bodyView.animatedWaitDestroy()}),FixedIncome.ratingsView=new FixedIncome.QuantileView({quintileFor:"ratings",selectedTextId:"selectedRating",el:"#ratings-sec",modelKey:"mStarRating",model:b}),FixedIncome.returnsView=new FixedIncome.QuantileView({quintileFor:"returns",selectedTextId:"selectedReturns",el:"#returns-sec",modelKey:"returns",model:b}),FixedIncome.expensesView=new FixedIncome.QuantileView({quintileFor:"expenses",selectedTextId:"selectedExpenses",el:"#expenses-sec",modelKey:"expenses",model:b})},error:function(a,b,c){FixedIncome.bodyView.animatedWaitDestroy()}})}function loadETFTab(){null==tokenF2&&(tokenF2=F2.AppHandlers.getToken(),F2.AppHandlers.on(tokenF2,F2.Constants.AppHandlers.APP_CREATE_ROOT,function(a){a.root=document.getElementById(a.rootId)}),F2.AppHandlers.on(tokenF2,F2.Constants.AppHandlers.APP_RENDER,function(a,b){$(a.root).append(b)}),F2.init(),F2.registerApps([{appId:"com_fidelity_pi_etf_themeoptions",rootId:"f2_etf_container",manifestUrl:"//"+etf_f2_url+"/screener/F2/Apps",isSecure:!1,enableBatchRequests:!0,context:{code:"500"}}]))}function resetElements(){($("#saved_searches_box_alert").is(":visible")||$("#saved_searches_box").is(":visible"))&&$("#saved_searches a:first").focus(),$("#saved_searches_box, #saved_searches_box_alert").hide(),$("#saved_searches").removeClass("selected reverseArrow").addClass("downArrow")}function deleteSearch(a){var b="usTreasSec";if(tab=$('.primary-content-box[class*="block"]'),tab){var c=tab.find("form").attr("id");c&&(b=c)}var d=$('#primary_tab_list li[class*="selected"]'),e=d.attr("id"),f="pcb_"+b,g="preferenceNameToDelete="+a+"&operation=delete&primTabId="+e+"tabId=pcb_"+f;$.ajax({type:"POST",url:"/ftgw/fi/FindBondsCDsIndividualBonds",data:g,success:function(b){var c=$("table.saved-searches-table tr td");$.each(c,function(b){if(c[b].innerHTML===decodeURI(a)){c[b].parentNode.parentNode.removeChild(c[b].parentNode);var d=$("#saved_searches .savedCount");return d.text(parseInt(d.text())-1),!1}})},error:function(a,b,c){}})}function getQueryValue(a,b){var c=a.indexOf(b),d="",e="";return-1!=c&&(c=c+b.length+1,d=a.indexOf("&",c),-1==d&&(d=a.length),e=a.substring(c,d)),e}function runNavi(a){switch(requestPage=getQueryValue(a,"requestpage"),requestPage){case"FISearchTreasury":"usTreasSec";break;case"FISearchTIPS":"advTipsSec";break;case"FISearchCD":"advCDsSecondary";break;case"FISearchAgency":"advAgencySecodary";break;case"FISearchMunicipal":"advMunicipalSec";break;case"FISearchCorporate":"advCorpInvGradeSec";break;case"FISearchHighYield":"advCorpHighYieldSec",subTitle="corphysec";break;case"FISearchAcrossOff":"advOffersSec";break;case"FISearchAcrossOffNewIssue":"advOffersNew";break;case"FISearchCatsTigrs":"advCatsTigrs"}window.location.href="/ftgw/fi/"+a.replace("&displayFormat=TABLE","").replace("&displayFormat=GRAPH","")+"&displayFormat=TABLE"}function sortCDResult(a){var b=$(".landingRWVAccounts #account").val();if(0==$("#tbcds #newIssueCDs table.topRates th a.clicked#allCDs").length&&$(".landingRWVAccounts #account").length&&!b)return void alert("Please select an account");null!=b&&""!=b&&(a+="&account="+b),animatedWaitCreate(),jQuery.ajax({type:"GET",async:!0,url:a,dataType:"text",data:"",success:function(a){null!=a&&""!=a?($("#allNewIssues").remove(),$("#cd-newIssues-secondary-toggle").remove(),$("#newIssueCDs #filterRates .topRates").after(a)):$("#allNewIssues").html("<div><p>The application is experiencing technical difficulties.  Please try again later.</p></div>"),animatedWaitDestroy()},error:function(a,b,c){FixedIncome.isSessionTimeout(a)||($("#allNewIssues").html("<div><p>The application is experiencing technical difficulties.  Please try again later.</p></div>"),animatedWaitDestroy())}})}function checkForm(a){var b=$(a).find('input[id="cuvalue"]:checked').size();return b>2?(alert("Please select only two bonds for comparison."),!1):!(null==b||0==b||""==b||b<=1)||(alert("Please select two bonds for comparison."),!1)}function generateSelectedCDs(a){var b={cusips:"",prices:"",maturityDates:"",numOfCDs:""};return a.each(function(a){var c="";a>0&&(c=",");var d=$(this),e=d.find("td input[name='cusip']");b.cusips=b.cusips+c+e.val().trim();var f=d.find("td.issue-price").text(),g=f.trim().replace(/,/g,"").replace(/--/g,"");b.prices=b.prices+c+g;var h=d.find("td.maturitydttd").text(),i=h.trim().replace(/--/g,"");b.maturityDates=b.maturityDates+c+i}),b.numOfCDs=a.size(),b}function checkFormForCustomLadder(a){var b=$(a).find('input[id="cuvalue"]:checked').size();return!(b<2||b>50)||(alert("Please select at least two but not more than fifty CDs."),!1)}function takeActionForCustomCDLadder(a){if(checkFormForCustomLadder($(a).closest('form[name="theForm"]'))){var b=generateSelectedCDs($(a).closest('form[name="theForm"]').find("tr.highlight")),c=$("#createCustomCDLadderForm");c.find("input[name='CDL_CUSIPS']").val(b.cusips),c.find("input[name='CDL_PRICES']").val(b.prices),c.find("input[name='CDL_MATURITY_DATES']").val(b.maturityDates),c.find("input[name='CDL_NUM_OF_CDS']").val(b.numOfCDs),c.submit()}}function takeActionForCDsTable(a){var b=$(a).closest(".takeActionPanel").find('input[name="pickup1"]:checked');if(b.length<=0)return alert("Please select an option to submit"),!1;var c=b[0].value;if("Compare two bonds"===c)$(a).closest('form[name="theForm"]').action="/ftgw/fi/FICompareBonds",checkForm($(a).closest('form[name="theForm"]'))&&$(a).closest('form[name="theForm"]').submit();else if("Fixed Income Analysis"===c){var d=document.getElementById($(a).closest('form[name="theForm"]').attr("id"));FixedIncomeAnalysis(d)}else if("Custom Ladder"===c&&checkFormForCustomLadder($(a).closest('form[name="theForm"]'))){var e=generateSelectedCDs($(a).closest('form[name="theForm"]').find("tr.highlight")),f=$("#createCustomCDLadderForm");f.find("input[name='CDL_CUSIPS']").val(e.cusips),f.find("input[name='CDL_PRICES']").val(e.prices),f.find("input[name='CDL_MATURITY_DATES']").val(e.maturityDates),f.find("input[name='CDL_NUM_OF_CDS']").val(e.numOfCDs),f.submit()}}function OnclickIndividualBondSub(a,b,c){saveFormLayout(b,a.id)}function test(){return!1}function leaveFidelity(a){confirm("You are now leaving Fidelity.com for a website that is unaffiliated with Fidelity. Fidelity has not been involved in the preparation of the content supplied at the unaffiliated site and does not guarantee or assume any responsibility for its content.")&&window.open(a,"newwindow",config="height=380,width=617,toolbar=yes,menubar=yes,scrollbars=yes,resizable=yes,location=no,directories=no,status=no")}function addUniqueClass(a,b){a.hasClass(b)||a.addClass(b)}function showModal(a){$("#invalidSearchNameBox").hide(),$("#searchNameBox").show(),$("#saveSearchWindowButtonsBox").show(),$("#validSearchNameBox").hide(),$("#closeWindowButtonsBox").hide();var b=$(document).height();$("#mask").height(b).show();var c=$(window).height();$(".modal-window-wrapper").show();var d=$(a).outerHeight();marginTop=(c-d)/2,$(".modal-window-wrapper").css("margin-top",marginTop)}function loadBondSearch(a){if("true"==useNewBondCounts){const b=getQueryFromTabId(a);var c=-1;$.ajax({type:"GET",url:previewCountUrl+"?"+b,xhr:function(){var a=$.ajaxSettings.xhr();return a.withCredentials=!0,a},success:function(b){try{obj=$.parseJSON(b),c=parseInt(obj.totalCount),updateDefaultBondCountForTab(a,c)}catch(b){console.log(b),updateDefaultBondCountForTab(a,-1)}loadBondSearchPart2(a,c)},error:function(b){console.log(b.status),updateDefaultBondCountForTab(a,c),loadBondSearchPart2(a,c)}})}else{var c=$("#"+a+" .matchingResults .previewBondCount").first().text();$("#"+a+" #adv_SeeResults ").val("See "+c+" CUSIPs"),$("#"+a+" #adv_SeeResults .previewBondCount").text(c),loadBondSearchPart2(a,c)}}function updateDefaultBondCountForTab(a,b){const c=getClassNameFromTabId(a);b>=0?($(".hideDefaultBondCount ."+c).attr("value",b.toString()),$("#"+a+" .matchingResults .previewBondCount").first().text(b),$("#"+a+" #adv_SeeResults ").val("See "+b+" CUSIPs"),$("#"+a+" #adv_SeeResults .previewBondCount").text(b.toString())):($(".hideDefaultBondCount ."+c).attr("value",b.toString()),$("#"+a+" .matchingResults").hide().next().hide(),$("#"+a+" #adv_SeeResults ").val("See CUSIPs"),$("#"+a+" #adv_SeeResults .previewBondCount").text(""))}function loadBondSearchPart2(a){"pcb_advMunicipalSec"===a?addDatapickerForCallProtection("advMunicipalSec"):"pcb_advCorpInvGradeSec"===a?addDatapickerForCallProtection("advCorpInvGradeSec"):"pcb_advCorpHighYieldSec"===a?addDatapickerForCallProtection("advCorpHighYieldSec"):"pcb_advOffersSec"===a?addDatapickerForCallProtection("advOffersSec"):"pcb_advAgencySecodary"===a&&addDatapickerForCallProtection("advAgencySecodary"),$(".nextCallDateTooltip").tooltip();var b="";switch(a){case"pcb_advTipsSec":b="tips";break;case"pcb_usTreasSec":b="treasury";break;case"pcb_advCorpInvGradeSec":b="corporate";break;case"pcb_advCorpHighYieldSec":b="corphysec";break;case"pcb_advOffersNew":b="advoffernew";break;case"pcb_advOffersSec":b="allofferings";break;case"pcb_advCatsTigrs":b="advcatstigrs"}""!=b&&saveFormLayout("tbindividual-bonds",b);try{$("div.primary-content-box").removeClass("block"),$("div.primary-content-box").addClass("none"),$("#"+a).removeClass("none"),$("#"+a).addClass("block");var c=$("#"+a).find("form").get(0);if(resetAllFormsExceptThis(c.id),c.minmaturity&&(""==c.minmaturity.value||"mm/yyyy"==c.minmaturity.value)){var d=new Date,e=$.datepicker.formatDate("mm/yy",d);c.minmaturity.value=e}c.maxmaturity&&""==c.maxmaturity.value&&(c.maxmaturity.value="mm/yyyy"),$("#advMunicipalSec_taxable").val("E"),disableDropdown("#advMunicipalSec_makeWholeCall");getMinMax($("#"+a).children("form").attr("id"),null,null,null,!0),loadFootNote(a)}catch(a){console.log(a.message)}}function disableDropdown(a){$(a).val("N").change(),$(a).attr("disabled","disabled"),$(a+"_label").css("color","grey")}function onDateSelection(a,b,c){const d=$("#"+a+b).closest("form").attr("id");if("BT"===$("#"+a+"_typenextcalldate").val()){const e="_onenextcalldate"===b?"_twonextcalldate":"_onenextcalldate",f="_onenextcalldate"===b?"minDate":"maxDate";if($("#"+a+e).datepicker("option",f,c),""===$("input#"+a+e+".datepicker_ncd.hasDatepicker").val())return}"advOffersNew"!==d&&getBondCountFromSolr(d),clearNextCallDateErrMsg(a)}function addDatapickerForCallProtection(a){$("#"+a+"_onenextcalldate").datepicker({showButtonPanel:!0,closeText:"Close",changeMonth:!0,changeYear:!0,yearRange:"-0:+100",showOn:"both",buttonImage:fiContentUrl+"/images/calendar.gif",buttonImageOnly:!0,buttonText:"",minDate:0,onSelect:function(b){onDateSelection(a,"_onenextcalldate",b)}}),$("#"+a+"_twonextcalldate").datepicker({showButtonPanel:!0,closeText:"Close",changeMonth:!0,changeYear:!0,yearRange:"-0:+100",showOn:"both",buttonImage:fiContentUrl+"/images/calendar.gif",buttonImageOnly:!0,buttonText:"",minDate:0,onSelect:function(b){onDateSelection(a,"_twonextcalldate",b)}})}function loadFootNote(a){try{$("div.footnote").removeClass("block"),$("div.footnote").addClass("none");var b=$("#footnote_"+a);b.length>0?b.addClass("block"):$("#footnote_pcb_common").addClass("block")}catch(a){console.log(a.message)}}function completedSaveSearch(){if($("#closeWindowButtonsBox").is(":visible")&&$("#alert_new_bonds").is(":checked")){var a=tab.find("form").attr("id"),b=document.getElementById(a),c=b.preferenceName.value;processForm(b);var d=getSearchCriteriaParams(b),e=alertUrl+"/ftgw/alerts/SaveFISavedSearchSubscription?ACTION=INSERT&ReturnPage=FIAdvRedirectLanding&returnQueryString="+encodeURIComponent(d+"#backFromAlertPreferenceName="+c);location.hash.indexOf("#tbcds|treasury|cd-market")>-1&&(e=e.replace("FISearchCD","FILandingCD")),top.location.href=e}$("#modelPopUp_SaveSearch").hide(),$("#mask").hide(),$(".modal-window-wrapper").hide(),$(".alert-new-bonds").show()}function getGoToURL(){var a=contextPath+"/gotoBL/FIAdvRedirectLanding",b="tab=",c=location.hash;if(c.indexOf("tbindividual-bonds")>-1||c.indexOf("tbcds|treasury|cd-market")>-1){var d="usTreasSec";if(tab=$('.primary-content-box[class*="block"]'),tab){var e=tab.find("form").attr("id");e&&(d=e)}var f=document.getElementById(d),g=processForm(f),h=getSearchCriteriaParams(f);isMoreCriteriaCollapsed(f)?h+="expandedState=N":h+="expandedState=Y";var i=a+"?"+h;g&&(c.indexOf("#tbcds|treasury|cd-market")>-1&&(i=i.replace("FISearchCD","FILandingCD")),window.location=i+"&"+b+encodeURIComponent(c.slice(1)))}else window.location=contextPath+"/gotoBL/FILanding?"+b+encodeURIComponent(c.slice(1));return!1}function showOfferings(a,b,c,d){var e=document.getElementById(a);e.operation.value="",$("#"+a).find('[name="isAdvSearch"]').length||$("<input type='hidden' name='isAdvSearch' value='Y'/>").appendTo("#"+a);var f="FISecBondCount"===b,g=processForm(e,f);if(g){if(f&&animatedWaitCreate(),"undefined"!=typeof formStr&&formStr==getSearchCriteriaParams(e)){$("#hiddenAdvSaveSearchInd").length<1?$("<input type='hidden' id='hiddenAdvSaveSearchInd' name='advSaveSearchInd' value='Y'/>").appendTo("#"+a):$("#hiddenAdvSaveSearchInd").val("Y"),$("#hiddenIsAdvSearch").length<1?$("<input type='hidden' id='hiddenIsAdvSearch' name='isAdvSearch' value='Y'/>").appendTo("#"+a):$("#hiddenIsAdvSearch").val("Y");var h="<input type='hidden' id='hiddenPreferenceName' name='preferenceName' value='"+$("#searchName").val()+"'/>";$("#"+a+" #hiddenPreferenceName").length<1?$(h).appendTo("#"+a):$("#"+a+" #hiddenPreferenceName").val($("#searchName").val()),formStr=""}if("advCatsTigrs"!=a&&"advOffersNew"!=a&&(e.displayFormat.value="TABLE"),$(".landingRWVAccounts #account").length>0&&""!=$(".landingRWVAccounts #account").val()&&($("#accountCopy").length<1?$("<input type='hidden' id='accountCopy' name='account' value='"+$(".landingRWVAccounts #account").val()+"'/>").appendTo("#"+a):$("#accountCopy").val($(".landingRWVAccounts #account").val())),"FISearchAcrossOffNewIssue"!=e.requestpage.value){var i=$("#"+e.id).serialize(),j={};f&&"true"==useNewBondCounts?(j.type="GET",j.url=previewCountUrl+"?"+i):(j.type="POST",j.url="/ftgw/fi/"+b+"?",j.data=i),$.ajax({type:j.type,url:j.url,data:j.data,success:function(f,g,h){isReqSuccess=!0;try{obj=$.parseJSON(f)}catch(b){return restoreChangedValue(a,d),animatedWaitDestroy(),!1}if("FIIndividualBondsSearchCount"==b)try{if("error"==obj.status){var i=obj.text.match(/\d+/),j=addCommas(i);return updateDownloadURL(a),animatedWaitDestroy(),$("#bondCountStrong").text(j),showModal("#modelPopUp_BondCount"),$("#modelPopUp_BondCount").show(),restoreChangedValue(a,d),!1}if("success"==obj.status){var k=parseInt(obj.totalCount);if(0===k)return animatedWaitDestroy(),showResultHandling(),restoreChangedValue(a,d),!1;$("<input type='hidden' name='advDataId' value='"+h.getResponseHeader("fsreqid")+"'/>").appendTo("#"+e.id);try{isiPhoneOriPad()&&(e.displayFormat&&(e.displayFormat.value="TABLE"),e.displayChartFormat&&(e.displayChartFormat.value="TABLE"))}catch(a){console.log(a.message)}$("select[name='callind'],select[name='callable']").removeAttr("disabled"),processForm(e),$("#referrerCrossVal").val($("#"+e.id).serialize()),e.submit(),$(".greyout").next("select").attr("disabled","disabled")}else restoreChangedValue(a,d),animatedWaitDestroy()}catch(b){restoreChangedValue(a,d),animatedWaitDestroy()}try{"FISecBondCount"===b&&(k=parseInt(obj.totalCount),k>=0&&!previewCountInvalid?(c&&"afterHour"===c&&$(".matchingResults").removeClass("border-line").next(".message-page").show(),$(e).find(".matchingResults").show(),$(e).find(".previewBondCount").text(k),$(e).find("#adv_SeeResults").val("See "+k+" CUSIPs")):($(e).find(".matchingResults").hide().next().hide(),$(e).find(".previewBondCount").text(""),$(e).find("#adv_SeeResults").val("See CUSIPs")),restoreChangedValue(a,d),animatedWaitDestroy())}catch(b){restoreChangedValue(a,d),animatedWaitDestroy(),console.log(b.message)}},error:function(){restoreChangedValue(a,d),"FISecBondCount"===b&&($(e).find(".matchingResults").hide().next().hide(),$(e).find(".previewBondCount").text(""),$(e).find("#adv_SeeResults").val("See CUSIPs")),animatedWaitDestroy()}})}else $("select[name='callind'],select[name='callable']").removeAttr("disabled"),$("#referrerCrossVal").val($("#"+e.id).serialize()),"advOffersNew"!==a&&"advOffersSec"!==a||$(e).submit(function(){return $(e).find(":input").each(function(a,b){$(b).is(":disabled")&&$(b).removeAttr("disabled")}),!0}),e.submit(),$(".greyout").next("select").attr("disabled","disabled")}else g||(restoreChangedValue(a,d),f&&($(e).find(".matchingResults").hide().next().hide(),$(e).find(".previewBondCount").text(""),$(e).find("#adv_SeeResults").val("See CUSIPs")),animatedWaitDestroy())}function restoreChangedValue(a,b){restoreDefaultValues(document.getElementById(a));var c=$("#"+a);b&&(void 0==b.checkedAllFlag||b.checkedAllFlag||"advOffersSec"!==a||$("#advOffersSec .bondTypeMulti .multi-select-dropdown").children("input:checkbox").prop("checked",!1),c.find("[name=minRatings]").is(":visible")&&void 0!=b.minRatingsVal&&(c.find("[name=minRatings]").val(b.minRatingsVal),""===b.minRatingsVal&&(c.find("[name=minmoody]").val(""),c.find("[name=minsandp]").val(""))),c.find("[name=maxRatings]").is(":visible")&&void 0!=b.maxRatingsVal&&(c.find("[name=maxRatings]").val(b.maxRatingsVal),""===b.maxRatingsVal&&(c.find("[name=maxmoody]").val(""),c.find("[name=maxsandp]").val(""))),c.find("[name=minUnderlying]").is(":visible")&&void 0!=b.minUnderlyingVal&&(c.find("[name=minUnderlying]").val(b.minUnderlyingVal),""===b.minUnderlyingVal&&(c.find("[name=minMoodyUnderlying]").val(""),c.find("[name=minSandPUnderlying]").val(""))),c.find("[name=maxUnderlying]").is(":visible")&&void 0!=b.maxUnderlyingVal&&(c.find("[name=maxUnderlying]").val(b.maxUnderlyingVal),""===b.maxUnderlyingVal&&(c.find("[name=maxMoodyUnderlying]").val(""),c.find("[name=maxSandPUnderlying]").val(""))),c.find("[name=minmoody]").is(":visible")&&(void 0!=b.minmoody&&c.find("[name=minmoody]").val(b.minmoody),void 0!=b.maxmoody&&c.find("[name=maxmoody]").val(b.maxmoody),void 0!=b.minsandp&&c.find("[name=minsandp]").val(b.minsandp),void 0!=b.maxsandp&&c.find("[name=maxsandp]").val(b.maxsandp)),c.find("[name=minMoodyUnderlying]").is(":visible")&&(void 0!=b.minMoodyUnderlying&&c.find("[name=minMoodyUnderlying]").val(b.minMoodyUnderlying),void 0!=b.maxMoodyUnderlying&&c.find("[name=maxMoodyUnderlying]").val(b.maxMoodyUnderlying),void 0!=b.minSandPUnderlying&&c.find("[name=minSandPUnderlying]").val(b.minSandPUnderlying),void 0!=b.maxSandPUnderlying&&c.find("[name=maxSandPUnderlying]").val(b.maxSandPUnderlying)))}function showResultHandling(){var a=$(document).height();$("#mask").height(a).show();var b=$(window).height();$(".result-handling-window-wrapper").show();var c=$("#modelPopUp_ResultHandling").outerHeight();marginTop=(b-c)/2,$(".result-handling-window-wrapper").css("margin-top",marginTop)}function processForm(a,b){var c=!0;if(a.minmaturity&&(-1!=a.minmaturity.value.indexOf("yyyy")?a.minmaturity.value="":c=validateMaturityDate(a.minmaturity)&&c),a.maxmaturity&&(-1!=a.maxmaturity.value.indexOf("yyyy")?a.maxmaturity.value="":c=validateMaturityDate(a.maxmaturity)&&c),a.askQuantity)if(a.askQuantity.checked)a.minQuantity.value="",a.maxQuantity.value="",hideError(a,"askQuantity");else{var d="Please enter a value in numeric format.";c=validateMinMax(d,"askQuantity",0,a.minQuantity,a.maxQuantity,a)&&c,!c&&isMoreCriteriaCollapsed(a)&&expandShowMoreCriteria(a)}if(a.bidQuantity)if(a.bidQuantity.checked)a.minQuantityBid.value="",a.maxQuantityBid.value="",hideError(a,"bidQuantity");else{var d="Please enter a value in numeric format.";c=validateMinMax(d,"bidQuantity",0,a.minQuantityBid,a.maxQuantityBid,a)&&c,!c&&isMoreCriteriaCollapsed(a)&&expandShowMoreCriteria(a)}if(a.askPrice)if(a.askPrice.checked)a.minprice.value="",a.maxprice.value="",hideError(a,"askPrice");else{var d="Please enter a value in numeric format.";c=validateMinMax(d,"askPrice",3,a.minprice,a.maxprice,a)&&c,!c&&isMoreCriteriaCollapsed(a)&&expandShowMoreCriteria(a)}if(a.coupon)if(a.coupon.checked)a.mincoupon.value="",a.maxcoupon.value="",hideError(a,"coupon");else{var d="Please enter a value in numeric format.";c=validateMinMax(d,"coupon",3,a.mincoupon,a.maxcoupon,a)&&c,!c&&isMoreCriteriaCollapsed(a)&&expandShowMoreCriteria(a)}if(a.askYield)if(a.askYield.checked)a.minyield.value="",a.maxyield.value="",hideError(a,"askYield");else{var d="Please enter a value in numeric format.";c=validateMinMax(d,"askYield",3,a.minyield,a.maxyield,a)&&c}if(a.bondtierind&&("All"==a.dummybondtierind.value&&(a.bondotherind.value="Y",a.bondtierind.value="Y"),""==a.dummybondtierind.value&&(a.bondotherind.value="Y",a.bondtierind.value=""),"Y"==a.dummybondtierind.value&&(a.bondotherind.value="",a.bondtierind.value="Y")),a.incomeSource&&(""==a.incomeSource.value&&(a.general.value="G",a.revenue.value="R"),"G"==a.incomeSource.value&&(a.general.value="G",a.revenue.value=""),"R"==a.incomeSource.value&&(a.general.value="",a.revenue.value="R")),a.paymentmonth&&a.subPaymentMonth){var e="";if(a.subPaymentMonth[0].checked)e="";else{for(var f=1;f<a.subPaymentMonth.length;f++)if(a.subPaymentMonth[f].checked)switch(a.subPaymentMonth[f].value){case"Weekly":e+="W";break;case"Monthly":e+="M";break;case"Quarterly":e+="Q";break;case"Semiannually":e+="S";break;case"Annually":e+="A";break;case"At Maturity":e+="T";break;case"Irregular":e+="I"}"WMQSATI"==e&&(e="")}a.paymentmonth.value=e}if(a.eitherRatingsInd&&(a.eitherRatingsInd.checked?$("#"+a.id+" input[name='orRating']").length>0?a.orRating.value="Y":($("<input type='hidden' name='orRating' value='Y'/>").appendTo("#"+a.id),a.orRating.value="Y"):$("#"+a.id+" input[name='orRating']").length>0?a.orRating.value="N":($("<input type='hidden' name='orRating' value='N'/>").appendTo("#"+a.id),a.orRating.value="N")),c){a.minRatings&&""!=a.minRatings.value&&""==a.maxRatings.value&&""==a.maxsandp.value&&""==a.maxmoody.value?"advCorpHighYieldSec"!=a.id?(a.maxRatings.value="Aaa/AAA",a.maxmoody.value="Aaa",a.maxsandp.value="AAA"):(a.maxRatings.value="Ba1/BB+",a.maxmoody.value="Ba1",a.maxsandp.value="BB+"):a.maxRatings&&""!=a.maxRatings.value&&""==a.minRatings.value&&""==a.minsandp.value&&""==a.minmoody.value&&("advCorpHighYieldSec"!=a.id?(a.minRatings.value="Aaa/AAA",a.minmoody.value="Aaa",a.minsandp.value="AAA"):(a.minRatings.value="Ba1/BB+",a.minmoody.value="Ba1",a.minsandp.value="BB+")),a.minUnderlying&&""!=a.minUnderlying.value&&""==a.maxUnderlying.value&&""==a.maxMoodyUnderlying.value&&""==a.maxSandPUnderlying.value?(a.maxUnderlying.value="Aaa/AAA",a.maxMoodyUnderlying.value="Aaa",a.maxSandPUnderlying.value="AAA"):a.maxUnderlying&&""!=a.maxUnderlying.value&&""==a.minUnderlying.value&&""==a.minMoodyUnderlying.value&&""==a.minSandPUnderlying.value&&(a.minUnderlying.value="Aaa/AAA",a.minMoodyUnderlying.value="Aaa",a.minSandPUnderlying.value="AAA");var g="advCorpHighYieldSec"==a.id?"Ba1":"Aaa",h="advCorpHighYieldSec"==a.id?"BB+":"AAA";a.minmoody&&""!=a.minmoody.value&&""==a.maxmoody.value?a.maxmoody.value=g:a.maxmoody&&""!=a.maxmoody.value&&""==a.minmoody.value&&(a.minmoody.value=g),a.minsandp&&""!=a.minsandp.value&&""==a.maxsandp.value?a.maxsandp.value=h:a.maxsandp&&""!=a.maxsandp.value&&""==a.minsandp.value&&(a.minsandp.value=h),a.minSandPUnderlying&&""!=a.minSandPUnderlying.value&&""==a.maxSandPUnderlying.value?a.maxSandPUnderlying.value="AAA":a.maxSandPUnderlying&&""!=a.maxSandPUnderlying.value&&""==a.minSandPUnderlying.value&&(a.minSandPUnderlying.value="AAA"),a.minMoodyUnderlying&&""!=a.minMoodyUnderlying.value&&""==a.maxMoodyUnderlying.value?a.maxMoodyUnderlying.value="Aaa":a.maxMoodyUnderlying&&""!=a.maxMoodyUnderlying.value&&""==a.minMoodyUnderlying.value&&(a.minMoodyUnderlying.value="Aaa")}if(("advOffersSec"==a.id||"advOffersNew"==a.id)&&a.acrossAll){0==$("#"+a.id+" .bondTypeMulti .multi-select-dropdown").children("input:checkbox:checked").length&&$("#"+a.id+" .bondTypeMulti .multi-select-dropdown").children("input:checkbox").prop("checked",!0)}return c}function hideError(a,b){var c=document.getElementById(a.id+"_"+b+"ErrMsg");c&&$(c).remove(),$("#"+a.id+"_sliderBox_"+b+" div.slider-title").removeClass("label-wrap error"),setMinMaxInputAriaInvalid(a.id,b,"false")}function validateMinMax(a,b,c,d,e,f){var g=!0;if(validateForDecimalPlaces(d,c,b)&&validateForDecimalPlaces(e,c,b)){hideError(f,b);var h=Number(d.value),i=Number(e.value);(!validateRange(d,b)||!validateRange(e,b)||h>i)&&(showPropertyError(d,"Please enter a value within the range shown",b),g=!1)}else{$("#"+f.id+"_sliderBox_"+b+" div.slider-title").addClass("label-wrap error");var j=document.getElementById(f.id+"_"+b+"ErrMsg");if(j)$(j).removeClass("none");else{var k="<div id='"+f.id+"_"+b+"ErrMsg' class='error-msg' role='alert' tabindex='0'><strong>Error:</strong> "+a+"</div>";$("#"+f.id+"_sliderBox_"+b).append(k)}setMinMaxInputAriaInvalid(f.id,b,"true"),g=!1}return g}function showPropertyError(a,b,c){var d=a.form;$("#"+d.id+"_sliderBox_"+c+" div.slider-title").addClass("label-wrap error");var e=document.getElementById(d.id+"_"+c+"ErrMsg");e&&$(e).remove();var f="<div id='"+d.id+"_"+c+"ErrMsg' class='error-msg' role='alert' tabindex='0'><strong>Error:</strong> "+b+"</div>";$("#"+d.id+"_sliderBox_"+c).append(f),setMinMaxInputAriaInvalid(d.id,c,"true")}function validateForDecimalPlaces(a,b,c){var d=/^\d+[\.]\d{1,3}$/,e=/^\d{1,10}$/,f=!1,g=a.value;return a&&0==b&&g.match(e)?f=!0:a&&b>0&&(g.match(d)||g.match(e)||!isNaN(parseFloat(a.value))&&"askYield"===c)?(a.value=parseFloat(a.value).toString(),f=!0):a&&b>0&&g.match(/^[\.]\d{1,3}$/)&&(a.value=0+a.value,f=!0),f}function validateMaturityDate(a){var b=/(^\d{2}\/\d{4}$)/,c=!0;if(a.value&&a.value.match(b)){var d=new Date,e=getDate(a.value),f=a.value.split("/"),g=parseInt(f[0]-1);if(d.setHours(0,0,0,0),-1!=$("#ui-id-4").attr("href").indexOf("&preferenceName=")&&-1!=cdtaburl.indexOf("&preferenceName=")||e<d&&(addInvalidMaturityErrorMSg(a),c=!1),g>11)addInvalidMaturityErrorMSg(a),c=!1;else if("minmaturity"==a.name){var h=getDate(a.form.maxmaturity.value);(e<d||h<d||e>h)&&(addInvalidMaturityErrorMSg(a),c=!1)}else if("maxmaturity"==a.name){var i=getDate(a.form.minmaturity.value);(e<d||i<d||e<i)&&(addInvalidMaturityErrorMSg(a),c=!1)}c&&clearMaturityErrMsg(a)}else"mm/yyyy"!=a.value&&""!=a.value&&(addMaturityErrorMSg(a),c=!1);return c}function validateCombinationNextCallDate(a){var b=$("#"+a+"_typenextcalldate").find(":selected").text(),c=$("#"+a+"_onenextcalldate"),d=$("#"+a+"_twonextcalldate");if("After"==b||"Before"==b)validateNextCallDate(c,a);else if("Between"==b){const e=validateNextCallDate(c,a);e&&validateNextCallDate(d,a)}}function getBoundSearchId(a){return"municipal"===a?"advMunicipalSec":"corporate"===a?getBoundSearchIdForCoroprateBounds():"allofferings"===a?"advOffersSec":"agency"===a?"advAgencySecodary":void 0}function getBoundSearchIdForCoroprateBounds(){return document.querySelector("#Corporate_tab_list > li:nth-child(2) > a").classList.contains("selected")?"advCorpHighYieldSec":"advCorpInvGradeSec"}function validateNextCallDate(a,b){const c=validateNextCallDateAndUpdateError(a.val(),b);return c||window.event.stopPropagation(),c}function validateNextCallDateAndUpdateError(a,b){const c=isValidDate(a);return c?clearNextCallDateErrMsg(b):addNextCallDateErrorMSg(b),c}function validateNextCallDatesForSavedSearch(a){if(a.typenextcalldate){const b=a.typenextcalldate.value;if(b&&b.length>0){validateNextCallDateAndUpdateError(a.onenextcalldate.value,a.id)&&"BT"===b&&validateNextCallDateAndUpdateError(a.twonextcalldate.value,a.id)}}}function clearMaturityErrMsg(a){$("#"+a.form.id+" div#maturityDateErrIcon").removeClass("error"),$("#"+a.form.id+"_maturityDateErrMsg").addClass("none"),$("#"+a.form.id+" div[err='msg']").addClass("none"),$("#"+a.id).attr("aria-invalid","false")}function clearNextCallDateErrMsg(a){$("#"+a+"_nextCallDateErrIcon").removeClass("error"),$("#"+a+"_nextCallDateErrMsg").addClass("none")}function addMaturityErrorMSg(a){$("#"+a.form.id+" div#maturityDateErrIcon").addClass("error"),$("#"+a.form.id+"_maturityDateErrMsg").removeClass("none"),$("#"+a.form.id+" div[err='msg']").addClass("none"),$("#"+a.id).attr("aria-invalid","true")}function addNextCallDateErrorMSg(a){$("#"+a+"_nextCallDateErrIcon").addClass("error"),$("#"+a+"_nextCallDateErrMsg").removeClass("none")}function addInvalidMaturityErrorMSg(a){$("#"+a.form.id+" div#maturityDateErrIcon").addClass("error"),$("#"+a.form.id+"_maturityDateErrMsg").addClass("none"),$("#"+a.form.id+" div[err='msg']").removeClass("none"),$("#"+a.id).attr("aria-invalid","true")}function resetCheckBoxes(a){$("#"+a+" input:checkbox").prop("checked",!0)}function resetCheckBoxesWithTrigger(a){triggerClick("askQuantity",a),triggerClick("bidQuantity",a),triggerClick("askPrice",a),triggerClick("coupon",a),triggerClick("askYield",a)}function triggerClick(a,b){$("#"+b+' input[name="'+a+'"]').prop("checked",!0),$("#"+b+' input[name="'+a+'"]').trigger("click"),$("#"+b+' input[name="'+a+'"]').prop("checked",!0)}function resetErrors(a){hideError(a,"askQuantity"),hideError(a,"bidQuantity"),hideError(a,"askPrice"),hideError(a,"coupon"),hideError(a,"askYield"),clearMaturityErrMsg(a.minmaturity),clearMaturityErrMsg(a.maxmaturity),hideDropdownCheckobxError(a)}function hideDropdownCheckobxError(a){$("#"+a.id+" div#paymentFreqErrIcon").removeClass("error"),$("#"+a.id+"_paymentFreqErrMsg").addClass("none"),$("#"+a.id+" div#sectorErrIcon").removeClass("error"),$("#"+a.id+"_sectorErrMsg").addClass("none"),$("#"+a.id+"_sectorNoCountMsg").addClass("none"),$("#"+a.id+" div#useErrIcon").removeClass("error"),$("#"+a.id+"_useErrMsg").addClass("none"),$("#"+a.id+" div#statecodeErrIcon").removeClass("error"),$("#"+a.id+"_statecodeErrMsg").addClass("none"),$("#"+a.id+" div#productErrIcon").removeClass("error"),$("#"+a.id+"_productErrMsg").addClass("none")}function resetform(a){var b=$(a).parents("form:first").get(0),c=b.id;return resetFormById(c),$("#"+c+" select").each(function(){"select-one"==this.type&&"All"==this.options[this.selectedIndex].text&&(this.selectedIndex=0),"callind"!=$(this).attr("name")&&"callable"!=$(this).attr("name")||$(this).trigger("change",!0)}),resetErrors(b),$("#"+c+" .multi-select-dropdown input").each(function(){var a=$(this).parent(".multi-select-dropdown"),b=$(a).prev(".multi-select-input");$(b).val($(b).attr("defval"))}),"advOffersSec"!=c&&"advOffersNew"!=c||($(".bondTypeMulti .multi-select-dropdown input:checkbox").prop("checked",!1),$("#"+c+" .slider-wrap input:text").attr("disabled","disabled"),$("#"+c+" input[name='askYield']").attr("disabled","disabled"),$("#"+c+" input[name='askPrice']").attr("disabled","disabled"),$("#"+c+" input[name='coupon']").attr("disabled","disabled")),setDefaultDateToForm(c),getMinMax(c,!0),updateMultiSeletLabel(c),restoreDefaultSolrBondCount(c),!1}function restoreDefaultSolrBondCount(a){var b="";switch(a){case"usTreasSec":b="treasurysec";break;case"advTipsSec":b="tips";break;case"advCDsSecondary":b="cdsec";break;case"advAgencySecodary":b="agencysec";break;case"advMunicipalSec":b="municipalsec";break;case"advCorpInvGradeSec":b="corpInvestmentGrade";break;case"advCorpHighYieldSec":b="corpHighYield";break;case"advOffersSec":b="allofferingsec";break;default:return}var c=$(".hideDefaultBondCount ."+b).val();$("#"+a+" .matchingResults .previewBondCount").text(c),$("#"+a+" #adv_SeeResults .previewBondCount").text(c),$("#"+a+" #adv_SeeResults ").val("See "+c+" CUSIPs")}function getClassNameFromTabId(a){switch(a){case"pcb_usTreasSec":return"treasurysec";case"pcb_advTipsSec":return"tips";case"pcb_advCDsSecondary":return"cdsec";case"pcb_advAgencySecodary":return"agencysec";case"pcb_advMunicipalSec":return"municipalsec";case"pcb_advCorpInvGradeSec":return"corpInvestmentGrade";case"pcb_advCorpHighYieldSec":return"corpHighYield";case"pcb_advOffersSec":return"allofferingsec";default:return}}function getQueryFromTabId(a){switch(a){case"pcb_usTreasSec":return"prodmajor=TREAS";case"pcb_advTipsSec":return"prodmajor=TREAS&prodminor=TIPS";case"pcb_advCDsSecondary":return"prodmajor=CD&prodminor=ALL";case"pcb_advAgencySecodary":return"prodmajor=AGENCY";case"pcb_advMunicipalSec":return"prodmajor=MUNI&prodminor=ALL";case"pcb_advCorpInvGradeSec":return"prodmajor=CORP&prodminor=IG";case"pcb_advCorpHighYieldSec":return"prodmajor=CORP&prodminor=HY";case"pcb_advOffersSec":return"requestpage=FISearchAcrossOff&acrossAgency=AGENCY&acrossCD=CD&acrossCorp=CORP&acrossMuni=MUNI&acrossTreas=TREAS";default:return}}function loadBondTab(a,b){$("#primary_tab_list li").removeClass("selected"),$(".findbondscds-individual--bonds #"+a).addClass("selected"),$(".shadow").removeClass("shadow"),$(".findbondscds-individual--bonds #"+a).next().addClass("shadow");try{loadBondSearch(b)}catch(a){}}function populateMinMoodyAndSnP(a){var b=a.form;if(b&&""==a.value&&(b.minmoody.value="",b.minsandp.value=""),b&&a.value&&-1!=a.value.indexOf("/")){var c=a.value.split("/");b.minmoody.value=c[0],b.minsandp.value=c[1]}b&&a.value&&"C"==a.value?(b.minmoody.value="C",b.minsandp.selectedIndex=b.minsandp.length-1):b&&a.value&&"B"==a.value&&(b.minmoody.value="B",b.minsandp.value="B-")}function populateMaxMoodyAndSnP(a){var b=a.form;if(b&&""==a.value&&(b.maxmoody.value="",b.maxsandp.value=""),b&&a.value&&-1!=a.value.indexOf("/")){var c=a.value.split("/");b.maxmoody.value=c[0],b.maxsandp.value=c[1]}b&&a.value&&"C"==a.value?(b.maxmoody.value="C",b.maxsandp.selectedIndex=b.maxsandp.length-1):b&&a.value&&"B"==a.value&&(b.maxmoody.value="B",b.maxsandp.value="B-")}function populateUnderlyingMinMoodyAndSnP(a){var b=a.form;if(b&&""==a.value&&(b.minMoodyUnderlying.value="",b.minSandPUnderlying.value=""),b&&a.value&&-1!=a.value.indexOf("/")){var c=a.value.split("/");b.minMoodyUnderlying.value=c[0],b.minSandPUnderlying.value=c[1]}}function populateUnderlyingMaxMoodyAndSnP(a){var b=a.form;if(b&&""==a.value&&(b.maxMoodyUnderlying.value="",b.maxSandPUnderlying.value=""),b&&a.value&&-1!=a.value.indexOf("/")){var c=a.value.split("/");b.maxMoodyUnderlying.value=c[0],b.maxSandPUnderlying.value=c[1]}}function showSearchPopup(){!$("div.label-wrap.error").length>0&&(showModal("#modelPopUp_SaveSearch"),$("#modelPopUp_SaveSearch").show())}function saveSearch(){try{var a="usTreasSec";if(tab=$('.primary-content-box[class*="block"]'),tab){var b=tab.find("form").attr("id");b&&(a=b)}$("#hiddenAdvSaveSearchInd").length<1?$("<input type='hidden' id='hiddenAdvSaveSearchInd' name='advSaveSearchInd' value='Y'/>").appendTo("#"+a):$("#hiddenAdvSaveSearchInd").val("Y"),$("#hiddenIsAdvSearch").length<1?$("<input type='hidden' id='hiddenIsAdvSearch' name='isAdvSearch' value='Y'/>").appendTo("#"+a):$("#hiddenIsAdvSearch").val("Y");var c="<input type='hidden' id='hiddenPreferenceName' name='preferenceName' value='"+$("#searchName").val()+"'/>";$("#"+a+" #hiddenPreferenceName").length<1?$(c).appendTo("#"+a):$("#"+a+" #hiddenPreferenceName").val($("#searchName").val());var d=document.getElementById(a);if(validateNextCallDatesForSavedSearch(d),$("#"+a).find(".error-msg:visible").size()>0||!processForm(d))return $("#modelPopUp_SaveSearch").hide(),$("#mask").hide(),$(".modal-window-wrapper").hide(),!1;if(!validateSearch())return!1;d.operation.value="save",$("select[name='callind'],select[name='callable']").removeAttr("disabled");var e=!1,f=$(".landingRWVAccounts #account").value,g=$("#"+a).serialize()+"&account="+f+"&who=advsearch";$.ajax({type:"POST",url:d.action,data:g,success:function(b){restoreValueForCallDrop(a),e=!0;var c=!1,f=$("#saved_searches .savedCount"),g=getSearchCriteriaParams(d),h="FIIndividualBondsSearch?"+g.replace("&displayFormat=TABLE","").replace("&displayFormat=GRAPH","")+"&displayFormat=TABLE",i='<tr><td class="first-col">'+d.preferenceName.value+'</td><td><a href="/ftgw/fi/'+h+'" title="Run '+decodeURI(d.preferenceName.value)+'">Run</a><a href="javascript:void(0);" class="edit" title="Edit '+decodeURI(d.preferenceName.value)+'">Edit</a></td><td class="button-cell"><a href="javascript:(0)" class="delete" ><img src="'+fiContentUrl+'/images/remove.png" width="11" height="11" alt="Delete '+decodeURI(d.preferenceName.value)+'" /></a></td></tr>',j="/ftgw/fi/FindBondsCDsIndividualBonds?"+g,k=encodeURI(d.preferenceName.value);$(".saved-searches-table tr").each(function(){$(this).find(".first-col").html()==d.preferenceName.value&&($(this).remove(),c=!0)}),c||f.text(parseInt(f.text())+1),0!=$("#flyout-data > span").length?$("#flyout-data > span").replaceWith('<table summary="" class="saved-searches-table"><colgroup><col class="col1" /><col class="col2" /><col class="col3" /></colgroup><tbody>'+i+"</tbody></table>"):$("#flyout-data").has("table").find("tbody:last").append(i),$("#flyout-data").has("table").find("tbody:last tr:last a.edit").click(function(){return runEdit(j),!1}),$("#flyout-data").has("table").find("tbody:last tr:last a.delete").click(function(){return deleteSearch(k),!1});var l=$(".saved-searches-table"),m=$(".saved-searches-table tr");m.sort(function(a,b){var c=$("td:eq(0)",a).text(),d=$("td:eq(0)",b).text();return c.toLowerCase()>d.toLowerCase()?1:-1}),$.each(m,function(a,b){l.append(b)}),$("#searchNameBox").hide(),$(".alert-new-bonds").hide(),$("#saveSearchWindowButtonsBox").hide(),$("#invalidSearchNameBox").hide(),$("#validSearchNameBox").show(),$("#validSearchNameBox p strong").html(d.preferenceName.value),$("#closeWindowButtonsBox").show(),restoreDefaultValues(d)},error:function(a,b,c){alert(c)}})}catch(a){console.log(a.message)}}function restoreValueForCallDrop(a){var b=$("#"+a),c=$("select[name='callind']",b),d=$("select[name='callable']",b);"NO"==c.val()?c.trigger("change",!0):"Y"==d.val()&&d.trigger("change",!0)}function getSearchCriteriaParams(a){var b=a.requestpage,c="";if(validateElem(a.prodmajor)&&(c+="prodmajor="+a.prodmajor.value+"&"),validateElem(a.prodminor)&&(c+="prodminor="+a.prodminor.value+"&"),validateElem(a.acrossTreas)&&a.acrossTreas.checked&&(c+="acrossTreas="+a.acrossTreas.value+"&"),validateElem(a.acrossTIPS)&&a.acrossTIPS.checked&&(c+="acrossTIPS="+a.acrossTIPS.value+"&"),validateElem(a.acrossMuni)&&a.acrossMuni.checked&&(c+="acrossMuni="+a.acrossMuni.value+"&"),validateElem(a.acrossAgency)&&a.acrossAgency.checked&&(c+="acrossAgency="+a.acrossAgency.value+"&"),validateElem(a.acrossCD)&&a.acrossCD.checked&&(c+="acrossCD="+a.acrossCD.value+"&"),validateElem(a.acrossCorp)&&a.acrossCorp.checked&&(c+="acrossCorp="+a.acrossCorp.value+"&"),validateElem(a.acrossCorpNote)&&a.acrossCorpNote.checked&&(c+="acrossCorpNote="+a.acrossCorpNote.value+"&"),validateElem(a.acrossHighYieldCorp)&&a.acrossHighYieldCorp.checked&&(c+="acrossHighYieldCorp="+a.acrossHighYieldCorp.value+"&"),validateElem(a.acrossAll)&&a.acrossAll.checked&&(c+="acrossAll="+a.acrossAll.value+"&"),validateElem(a.type)&&(c+="type="+a.type.value+"&"),validateElem(a.minmaturity)&&(c+="minmaturity="+a.minmaturity.value+"&"),validateElem(a.maxmaturity)&&(c+="maxmaturity="+a.maxmaturity.value+"&"),validateElem(a.mincoupon)&&(c+="mincoupon="+a.mincoupon.value+"&"),validateElem(a.maxcoupon)&&(c+="maxcoupon="+a.maxcoupon.value+"&"),validateElem(a.minprice)&&(c+="minprice="+a.minprice.value+"&"),validateElem(a.maxprice)&&(c+="maxprice="+a.maxprice.value+"&"),validateElem(a.minyield)&&(c+="minyield="+a.minyield.value+"&"),validateElem(a.maxyield)&&(c+="maxyield="+a.maxyield.value+"&"),validateElem(a.requestpage)&&"FISearchTreasury"!=b.value&&"FISearchTIPS"!=b.value&&"FISearchCatsTigrs"!=b.value&&(validateElem(a.minmoody)&&(c+="minmoody="+encodeURIComponent(a.minmoody.value)+"&"),validateElem(a.maxmoody)&&(c+="maxmoody="+encodeURIComponent(a.maxmoody.value)+"&"),validateElem(a.minsandp)&&(c+="minsandp="+encodeURIComponent(a.minsandp.value)+"&"),validateElem(a.maxsandp)&&(c+="maxsandp="+encodeURIComponent(a.maxsandp.value)+"&"),validateElem(a.minRatings)&&(c+="minRatings="+encodeURIComponent(a.minRatings.value)+"&"),validateElem(a.maxRatings)&&(c+="maxRatings="+encodeURIComponent(a.maxRatings.value)+"&")),validateElem(a.requestpage)&&"FISearchMunicipal"==b.value&&(validateElem(a.minMoodyUnderlying)&&(c+="minMoodyUnderlying="+encodeURIComponent(a.minMoodyUnderlying.value)+"&"),validateElem(a.maxMoodyUnderlying)&&(c+="maxMoodyUnderlying="+encodeURIComponent(a.maxMoodyUnderlying.value)+"&"),validateElem(a.minSandPUnderlying)&&(c+="minSandPUnderlying="+encodeURIComponent(a.minSandPUnderlying.value)+"&"),validateElem(a.maxSandPUnderlying)&&(c+="maxSandPUnderlying="+encodeURIComponent(a.maxSandPUnderlying.value)+"&"),validateElem(a.minUnderlying)&&(c+="minUnderlying="+encodeURIComponent(a.minUnderlying.value)+"&"),validateElem(a.maxUnderlying)&&(c+="maxUnderlying="+encodeURIComponent(a.maxUnderlying.value)+"&")),validateElem(a.agencygse)&&(c+="agencygse="+a.agencygse.value+"&"),validateElem(a.minQuantity)&&(c+="minQuantity="+a.minQuantity.value+"&"),validateElem(a.maxQuantity)&&(c+="maxQuantity="+a.maxQuantity.value+"&"),validateElem(a.minQuantityBid)&&(c+="minQuantityBid="+a.minQuantityBid.value+"&"),validateElem(a.maxQuantityBid)&&(c+="maxQuantityBid="+a.maxQuantityBid.value+"&"),validateElem(a.zerocpn)&&(c+="zerocpn="+a.zerocpn.value+"&"),validateElem(a.callable)&&(c+="callable="+a.callable.value+"&"),validateElem(a.general)&&(c+="general="+a.general.value+"&"),validateElem(a.revenue)&&(c+="revenue="+a.revenue.value+"&"),validateElem(a.escrowed)&&(c+="escrowed="+a.escrowed.value+"&"),validateElem(a.prerefunded)&&(c+="prerefunded="+a.prerefunded.value+"&"),validateElem(a.insured)&&(c+="insured="+a.insured.value+"&"),validateElem(a.bankqualified)&&(c+="bankqualified="+a.bankqualified.value+"&"),validateElem(a.callind)&&(c+="callind="+a.callind.value+"&"),validateElem(a.minQuantityBid)&&(c+="minQuantityBid="+a.minQuantityBid.value+"&"),validateElem(a.amtind)&&(c+="amtind="+a.amtind.value+"&"),validateElem(a.taxable)&&(c+="taxable="+a.taxable.value+"&"),validateElem(a.bondtierind)&&(c+="bondtierind="+a.bondtierind.value+"&"),validateElem(a.bondotherind)&&(c+="bondotherind="+a.bondotherind.value+"&"),validateElem(a.putind)&&(c+="putind="+a.putind.value+"&"),validateElem(a.survivorsoption)&&(c+="survivorsoption="+a.survivorsoption.value+"&"),validateElem(a.foreigndebt)&&(c+="foreigndebt="+a.foreigndebt.value+"&"),validateElem(a.sinkind)&&(c+="sinkind="+a.sinkind.value+"&"),validateElem(a.specialRedemption)&&(c+="specialRedemption="+a.specialRedemption.value+"&"),validateElem(a.minOfferingQuantity)&&(c+="minOfferingQuantity="+a.minOfferingQuantity.value+"&"),validateElem(a.refpr)&&(c+="refpr="+a.refpr.value+"&"),validateElem(a.sortby)&&(c+="sortby="+a.sortby.value+"&"),validateElem(a.displayFormat)&&(c+="displayFormat="+a.displayFormat.value+"&"),validateElem(a.displayChartFormat)&&(c+="displayChartFormat=TABLE&"),validateElem(a.displayFormatOverride)&&(c+="displayFormatOverride="+a.displayFormatOverride.value+"&"),validateElem(a.currentZoomLevel)&&(c+="currentZoomLevel="+a.currentZoomLevel.value+"&"),validateElem(a.preferenceName)&&(c+="preferenceName="+encodeURI(a.preferenceName.value)+"&"),validateElem(a.statecode))for(var d=0;d<a.statecode.length;d++){var e=a.statecode[d];a.statecode[d].checked&&(c+="statecode="+encodeURI(e.value)+"&")}if(validateElem(a.paymentmonth)&&(c+="paymentmonth="+a.paymentmonth.value+"&"),validateElem(a.sector)){for(var d=0;d<a.sector.length;d++){var f=a.sector[d];a.sector[d].checked&&(c+="sector="+encodeURI(f.value)+"&")}a.sector[0].checked?previewCountInvalid=!1:($("#"+a.id+"_sectorNoCountMsg").removeClass("none"),previewCountInvalid=!0),"true"==useNewBondCounts&&(a.sector[0].checked?previewCountInvalid=!1:($("#"+a.id+"_sectorNoCountMsg").removeClass("none"),previewCountInvalid=!0))}if(validateElem(a.use))for(var d=0;d<a.use.length;d++){var g=a.use[d];a.use[d].checked&&(c+="use="+encodeURI(g.value)+"&")}if(validateElem(a.requestpage)&&(c+="requestpage="+a.requestpage.value+"&"),a.orRating&&"Y"==a.orRating.value&&(c+="orRating="+a.orRating.value+"&"),validateElem(a.typenextcalldate)){const h=a.typenextcalldate.value,i=a.onenextcalldate?a.onenextcalldate.value:"",j=a.twonextcalldate?a.twonextcalldate.value:"";c+="typenextcalldate="+h+"&onenextcalldate="+i+"&","BT"===h&&(c+="twonextcalldate="+j+"&")}return c}function validateElem(a){return void 0!==a&&"undefined"!=a}function validateSearch(){var a='<p>You have entered an invalid character. Please rename your search using only letters, numbers, spaces, underscores ("_"), dollar signs ("$"), periods (".") and hyphens ("-").</p>';if(""==$("#searchName").val())return $("#searchName").addClass("error-bdr"),$("#invalidSearchNameBox").show(),$("#invalidSearchNameBox").html("<p>Please Enter Search Name</p>"),!1;var b=/^[a-zA-Z0-9_\$\.\-\s]*$/;return!!$("#searchName").val().match(b)||($("#searchName").addClass("error-bdr"),$("#invalidSearchNameBox").show(),$("#invalidSearchNameBox").html(a),$("#searchName").focus(),$("#searchName").val(""),!1)}function getMinMax(a,b,c,d,e){try{var f=document.getElementById(a);"advOffersSec"!=f.id&&"advOffersNew"!=f.id||!f.acrossAll||"true"!=$("#firstLoad").val()||updateAcrossFormForBondTypes(f,e);var g=f&&f.prodminor?f.prodminor.value:"",h=f&&f.prodmajor?f.prodmajor.value:"";"usTreasSec"==f.id&&"true"==$("#firstLoad").val()&&isBackOrEdit&&(g=getLatestValueOfParam("prodminor"));var i="&prodminor="+g+"&prodmajor="+h+"&requestpage="+(f.requestpage?f.requestpage.value:"");if(("advOffersSec"==f.id||"advOffersNew"==f.id)&&f.acrossAll){var j=$("#"+f.id+" .bondTypeMulti .multi-select-dropdown").children("input:checkbox:checked").length;(0==j||f.acrossAll&&f.acrossAll.checked)&&(i+="&acrossAll="+f.acrossAll.value),(0==j||f.acrossTreas&&f.acrossTreas.checked)&&(i+="&acrossTreas="+f.acrossTreas.value),(0==j||f.acrossTIPS&&f.acrossTIPS.checked)&&(i+="&acrossTIPS="+f.acrossTIPS.value),(0==j||f.acrossCD&&f.acrossCD.checked)&&(i+="&acrossCD="+f.acrossCD.value),(0==j||f.acrossAgency&&f.acrossAgency.checked)&&(i+="&acrossAgency="+f.acrossAgency.value),(0==j||f.acrossMuni&&f.acrossMuni.checked)&&(i+="&acrossMuni="+f.acrossMuni.value),(0==j||f.acrossCorp&&f.acrossCorp.checked)&&(i+="&acrossCorp="+f.acrossCorp.value),"advOffersSec"==f.id&&(0==j||f.acrossHighYieldCorp&&f.acrossHighYieldCorp.checked)&&(i+="&acrossHighYieldCorp="+f.acrossHighYieldCorp.value),"advOffersNew"==f.id&&(0==j||f.acrossCorpNote&&f.acrossCorpNote.checked)&&(i+="&acrossCorpNote="+f.acrossCorpNote.value)}$.ajax({type:"POST",url:"/ftgw/fi/FIGetMinMaxRange?",data:i,success:function(e,g,h){isReqSuccess=!0;var i={status:"success",totalCount:0,minmax:{minprice:1,maxprice:100,minQuantity:1,maxQuantity:100,minyield:.1,maxyield:10,minQuantityBid:1,maxQuantityBid:1e3,mincoupon:0,maxcoupon:100}};try{i=$.parseJSON(e)}catch(a){}if(i&&"success"==i.status){if(hideAllSliderErrors(f),null!=c&&"acrossAll"==c?updateAcrossOffMinMaxValues(i.minmax,f):(updateMinMaxValues(i.minmax,f),"true"==$("#firstLoad").val()?(updateExpandedState(f),updateSlidersWithSavedValues(a),loadSavedValuesForMultiDropDown("statecode",a),loadSavedValuesForMultiDropDown("use",a),loadSavedValuesForMultiDropDown("sector",a),loadSavedValuesForMultiDropDown("subPaymentMonth",a),updateValuesFromQuery(a),updateValueForCallDrop("callind","callable","makeWholeCall",a),$("#firstLoad").val("false")):(initializeMultiSelectDropDowns("statecode",a),initializeMultiSelectDropDowns("use",a),initializeMultiSelectDropDowns("sector",a),initializeMultiSelectDropDowns("subPaymentMonth",a))),disableSliderbars(i.minmax,f.id),"treasatype"===d&&getBondCountFromSolr(a),"1"==i.totalCount){var j=$("#"+a+" .default-attributes-box input,#"+a+" .default-attributes-box select,#"+a+" .default-attributes-box img"),k=$("#"+a+" .additional-attributes-box input,#"+a+" .additional-attributes-box select,#"+a+" .additional-attributes-box img");"advOffersNew"!==a&&"advOffersSec"!==a||(j=j.not("input[id*=bond_type]"),k=k.not("input[id*=bond_type]")),j.attr("disabled","disabled"),k.attr("disabled","disabled")}else if("advOffersNew"===a||"advOffersSec"===a){var j=$("#"+a+" .default-attributes-box input,#"+a+" .default-attributes-box select,#"+a+" .default-attributes-box img").not("input[id*=bond_type]"),k=$("#"+a+" .additional-attributes-box input,#"+a+" .additional-attributes-box select,#"+a+" .additional-attributes-box img").not("input[id*=bond_type]");j.each(function(a,b){$(b).is(":disabled")&&$(b).removeAttr("disabled")})}b&&resetCheckBoxesWithTrigger(a)}else console.log("Get minmax failed");firstFlag&&referrerCross&&location.hash.indexOf(getRequestPageFromUrl(referrerCross))>-1&&(0===$("#"+a).find(".error-msg").find(":visible").size()?getBondCountFromSolr(a):($("#"+a).find(".matchingResults").hide().next().hide(),$("#"+a).find(".previewBondCount").text(""),$("#"+a).find("#adv_SeeResults").val("See CUSIPs")),firstFlag=!1),editFlag&&(editFlag=!1,0===$("#"+a).find(".error-msg").find(":visible").size()?getBondCountFromSolr(a):($("#"+a).find(".matchingResults").hide().next().hide(),$("#"+a).find(".previewBondCount").text(""),$("#"+a).find("#adv_SeeResults").val("See CUSIPs"))),animatedWaitDestroy()},error:function(){animatedWaitDestroy()}})}catch(a){animatedWaitDestroy(),console.log("Get minmax "+a.message)}}function updateMinMaxValues(a,b){b&&(!b.minprice||""!=b.minprice.value&&"1"!=b.minprice.value&&"true"==$("#firstLoad").val()||(b.minprice.value=a.minprice),b.maxprice&&(""!=b.maxprice.value&&"100"!=b.maxprice.value&&"true"==$("#firstLoad").val()||(b.maxprice.value=a.maxprice),addSliderEvents(b.id,"askPrice",a.minprice,a.maxprice,b.minprice.value,b.maxprice.value,.001)),!b.minQuantity||""!=b.minQuantity.value&&"1"!=b.minQuantity.value&&"true"==$("#firstLoad").val()||(b.minQuantity.value=a.minQuantity),b.maxQuantity&&(""!=b.maxQuantity.value&&"100"!=b.maxQuantity.value&&"true"==$("#firstLoad").val()||(b.maxQuantity.value=a.maxQuantity),addSliderEvents(b.id,"askQuantity",a.minQuantity,a.maxQuantity,b.minQuantity.value,b.maxQuantity.value,1)),!b.minyield||""!=b.minyield.value&&"0.1"!=b.minyield.value&&"true"==$("#firstLoad").val()||(b.minyield.value=a.minyield),b.maxyield&&(""!=b.maxyield.value&&"10"!=b.maxyield.value&&"true"==$("#firstLoad").val()||(b.maxyield.value=a.maxyield),addSliderEvents(b.id,"askYield",a.minyield,a.maxyield,b.minyield.value,b.maxyield.value,.001)),!b.minQuantityBid||""!=b.minQuantityBid.value&&"1"!=b.minQuantityBid.value&&"true"==$("#firstLoad").val()||(b.minQuantityBid.value=a.minQuantityBid),b.maxQuantityBid&&(""!=b.maxQuantityBid.value&&"1000"!=b.maxQuantityBid.value&&"true"==$("#firstLoad").val()||(b.maxQuantityBid.value=a.maxQuantityBid),addSliderEvents(b.id,"bidQuantity",a.minQuantityBid,a.maxQuantityBid,b.minQuantityBid.value,b.maxQuantityBid.value,1)),!b.mincoupon||""!=b.mincoupon.value&&"0"!=b.mincoupon.value&&"true"==$("#firstLoad").val()||(b.mincoupon.value=a.mincoupon),b.maxcoupon&&(""!=b.maxcoupon.value&&"100"!=b.maxcoupon.value&&"true"==$("#firstLoad").val()||(b.maxcoupon.value=a.maxcoupon),addSliderEvents(b.id,"coupon",a.mincoupon,a.maxcoupon,b.mincoupon.value,b.maxcoupon.value,.001)))}function updateSlider(a,b,c,d){var e="#"+a+' div[secid="'+b+'"]';$("#"+a+' :input[name="'+b+'"]').get(0).checked=!1,null!=c&&""!=c&&($(e).slider("option","min",c),$(e).prev("input").val(c)),null!=d&&""!=d&&($(e).slider("option","max",d),$(e).next("input").val(d))}function matchSlideData(a){return!isNaN(parseFloat(a))}function validSliderData(a,b,c,d){var e=parseFloat(a),f=parseFloat(b);return matchSlideData(a)&&e<=d&&e>=c&&matchSlideData(b)&&f<=d&&f>=c&&e<=f}function addSliderEvents(a,b,c,d,e,f,g){var h="#"+a+"_slider_"+b,i="#"+a+"_"+b,j="#"+a+"_sliderBox_"+b;if("advOffersSec"==a||"advOffersNew"==a)try{var k=1*c,l=1*d,m=0,n=0;$(h).prev("input").val(e),$(h).next("input").val(f),setAriaLabelledby(a,b,c,d,e,f),$(h).slider({range:!0,min:k,max:l,step:1*g,values:[e,f],slide:function(e,f){hideError(document.getElementById(a),b),setAriaLabelledby(a,b,c,d,f.values[0],f.values[1]),$(h).prev("input").val(f.values[0]),$(h).next("input").val(f.values[1]),prevVal=f.values[0],nextVal=f.values[1],$(h).prev("input").val()==c&&$(h).next("input").val()==d?$(i).attr("checked",!0):$(i).attr("checked",!1)},start:function(a,b){m=$(h).prev("input").val(),n=$(h).next("input").val()},stop:function(b,c){m==c.values[0]&&n==c.values[1]||getBondCountFromSolr(a)}}),$(i).click(function(){if($(this).is(":checked")){$(h).slider("values",[k,l]);var e=$(h).prev("input").val(),f=$(h).next("input").val();$(h).prev("input").val(k).attr("defval",k),$(h).next("input").val(l).attr("defval",l),setAriaLabelledby(a,b,c,d,k,l),hideError(this.form,this.name),Math.abs(parseFloat(e))===Math.abs(parseFloat(c))&&Math.abs(parseFloat(f))===Math.abs(parseFloat(d))||getBondCountFromSolr(a)}}),$(j+" input:text").keydown(function(e){13!=e.keyCode&&9!=e.keyCode||($(h).slider({values:[$(h).prev("input").val(),$(h).next("input").val()]}),setAriaLabelledby(a,b,c,d,$(h).prev("input").val(),$(h).next("input").val()),$(h).prev("input").val()==c&&$(h).next("input").val()==d?$(i).prop("checked",!0):$(i).prop("checked",!1))}),$(j+" input:text").change(function(e,f){$(this).trigger("blur"),$(h).slider({values:[$(h).prev("input").val(),$(h).next("input").val()]}),setAriaLabelledby(a,b,c,d,$(h).prev("input").val(),$(h).next("input").val()),$(h).prev("input").val()==c&&$(h).next("input").val()==d?$(i).attr("checked",!0):$(i).attr("checked",!1),parseFloat($(h).prev("input").val())<parseFloat(c)||parseFloat($(h).next("input").val())>parseFloat(d)||parseFloat($(h).prev("input").val())>parseFloat($(h).next("input").val())||f||getBondCountFromSolr(a)});var o=$(h).prev("input"),p=$(h).next("input");o.attr("defval",k),p.attr("defval",l)}catch(a){console.log(a.message)}else if($(h).data("events")){var k=1*c,l=1*d;$(h).slider("option",{range:!0,min:k,max:l,values:[e,f]}),$(h).slider("refresh"),$(h).prev("input").val(e),$(h).next("input").val(f),$(i).unbind("click"),$(i).click(function(){if($(this).is(":checked")){$(h).slider("values",[k,l]);var e=$(h).prev("input").val(),f=$(h).next("input").val();$(h).prev("input").val(k).attr("defval",k),$(h).next("input").val(l).attr("defval",l),setAriaLabelledby(a,b,c,d,k,l),hideError(this.form,this.name),Math.abs(parseFloat(e))===Math.abs(parseFloat(c))&&Math.abs(parseFloat(f))===Math.abs(parseFloat(d))||getBondCountFromSolr(a)}})}else try{var k=1*c,l=1*d,m=0,n=0;$(h).prev("input").val(e),$(h).next("input").val(f),setAriaLabelledby(a,b,c,d,e,f),$(h).slider({range:!0,min:k,max:l,step:1*g,values:[e,f],slide:function(e,f){hideError(document.getElementById(a),b),setAriaLabelledby(a,b,c,d,f.values[0],f.values[1]),$(h).prev("input").val(f.values[0]),$(h).next("input").val(f.values[1]),$(h).prev("input").val()==c&&$(h).next("input").val()==d?$(i).attr("checked",!0):$(i).attr("checked",!1)},start:function(a,b){m=$(h).prev("input").val(),n=$(h).next("input").val()},stop:function(a,b){m==b.values[0]&&n==b.values[1]||getBondCountFromSolr($(this).parents("form").attr("id"))}}),$(i).click(function(){if($(this).is(":checked")){$(h).slider("values",[k,l]);var e=$(h).prev("input").val(),f=$(h).next("input").val();$(h).prev("input").val(k).attr("defval",k),$(h).next("input").val(l).attr("defval",l),setAriaLabelledby(a,b,c,d,k,l),hideError(this.form,this.name),Math.abs(parseFloat(e))===Math.abs(parseFloat(c))&&Math.abs(parseFloat(f))===Math.abs(parseFloat(d))||getBondCountFromSolr(a)}}),$(j+" input:text").keydown(function(e){var f=$(h).prev("input").val(),g=$(h).next("input").val();13!=e.keyCode&&9!=e.keyCode||(validSliderData(f,g,c,d)&&($(h).slider({values:[$(h).prev("input").val(),$(h).next("input").val()]}),setAriaLabelledby(a,b,c,d,$(h).prev("input").val(),$(h).next("input").val())),$(h).prev("input").val()==c&&$(h).next("input").val()==d?$(i).attr("checked",!0):$(i).attr("checked",!1))}),$(j+" input:text").change(function(e,f){$(this).trigger("blur"),validSliderData($(h).prev("input").val(),$(h).next("input").val(),c,d)&&($(h).slider({values:[$(h).prev("input").val(),$(h).next("input").val()]}),setAriaLabelledby(a,b,c,d,$(h).prev("input").val(),$(h).next("input").val())),$(h).prev("input").val()==c&&$(h).next("input").val()==d?$(i).attr("checked",!0):$(i).attr("checked",!1),parseFloat($(h).prev("input").val())<parseFloat(c)||parseFloat($(h).next("input").val())>parseFloat(d)||parseFloat($(h).prev("input").val())>parseFloat($(h).next("input").val())||f||getBondCountFromSolr(a)});var o=$(h).prev("input"),p=$(h).next("input");o.attr("defval",k),p.attr("defval",l)}catch(a){console.log(a.message)}}function enableDisableRedemption(a,b){var c=$("#"+b);"YES"==a.value?(c.val(""),c.removeAttr("disabled")):(c.val(""),c.attr("disabled","disabled"))}function isNameAlphanumeric(a){return!a.search||-1==a.search(/[^\w\s&\-\/\.]/)&&-1==a.search(/[\_]/)&&-1==a.search(/^\s+$/)}function isCusipAlphanumeric(a){return!a.search||-1==a.search(/[^\w\s]/)&&-1==a.search(/[\_]/)&&-1==a.search(/^\s+$/)&&-1==a.indexOf(" ")}function checkCusipForm(){with(document.cusipForm){var alert_text="The cusip entered is invalid. Fixed Income cusips must be nine characters in length. The characters can be letters, numbers, or a combination of both letters and numbers only. Characters other than letters and numbers are invalid. Please reenter the cusip. To search for a specific bond / Fixed Income security or cusip, please select the Search Inventory link or call 800-544-6666 to confirm you have the correct cusip.",alert_text1='The name entered is invalid. Bond Names can be 16 characters in length. The characters can be letters, numbers, spaces, hyphens ("-"), backslashes ("/"), periods, ampersands ("&") or a combination of all.';if(prodmajor.value=CusipDropdown.value,""==prodmajor.value){if(document.cusipForm.action="/ftgw/fi/FICusipSearch",0==bondSearchField.value.length||"Enter CUSIP number"==bondSearchField.value&&!placeholderSupportFlag)return alert("Please enter a Cusip to complete your search."),!1;if(!isCusipAlphanumeric(bondSearchField.value))return alert(alert_text),!1}else{if(document.cusipForm.action="/ftgw/fi/FIBondSearchByName",0==bondSearchField.value.length||"Enter bond name"==bondSearchField.value&&!placeholderSupportFlag||"Enter CD name"==bondSearchField.value&&!placeholderSupportFlag)return alert("Please enter a Bond Name to complete your search."),!1;if(!isNameAlphanumeric(bondSearchField.value))return alert(alert_text1),!1}}return!0}function initPage(){setDefaultDate(),setFocusEventsForDate(':input[name="minmaturity"]'),setFocusEventsForDate(':input[name="maxmaturity"]'),setEventsForDecimals(':input[name="minprice"],:input[name="maxprice"]',"askPrice"),setEventsForDecimals(':input[name="minyield"],:input[name="maxyield"]',"askYield"),setEventsForDecimals(':input[name="mincoupon"],:input[name="maxcoupon"]',"coupon"),setEventsForNumber(':input[name="minQuantityBid"],:input[name="maxQuantityBid"]',"bidQuantity"),setEventsForNumber(':input[name="minQuantity"],:input[name="maxQuantity"]',"askQuantity")}function setFocusEventsForDate(a){$("body").on("focusin focusout change keydown",a,function(a){if("focusin"===a.type)$(this).val()==$(this).attr("defval")&&$(this).val("");else if("focusout"===a.type)""==$(this).val()?$(this).val($(this).attr("defval")):isMoreThan50Yrs($(this).val())?($(this).val(""),addInvalidMaturityErrorMSg(this)):validateMaturityDate(this)&&$(this).attr("defval",$(this).val());else if("change"===a.type)""==$(this).val()?($(this).val($(this).attr("defval")),clearMaturityErrMsg(this)):isMoreThan50Yrs($(this).val())?($(this).val(""),addInvalidMaturityErrorMSg(this)):validateMaturityDate(this)&&($(this).attr("defval",$(this).val()),getBondCountFromSolr($(this).closest("form").attr("id")));else if("keydown"===a.type&&13==a.which)return!1})}function isMoreThan50Yrs(a){var b=/(\d{2}\/\d{4})/,c=!1;if(a&&a.match(b)){var d=a.split("/"),e=new Date;c=parseInt(d[1])-e.getFullYear()>50}return c}function setEventsForDecimals(a,b){$("body").on("focusin focusout",a,function(a){if("focusin"===a.type)$(this).attr("defval",$(this).val()),$(this).val("");else if("focusout"===a.type){var c="#"+this.form.id+"_slider_"+b,d=$(c).prev("input").get(0),e=$(c).next("input").get(0);""==$(this).val()?$(this).val($(this).attr("defval")):validateForDecimalPlaces(d,3,b)&&validateForDecimalPlaces(e,3,b)?validateRange(d,b)&&validateRange(e,b)?(hideError(this.form,b),$(this).attr("defval",$(this).val())):showPropertyError(this,"Please enter a value within the range shown",b):showPropertyError(this,"Please enter a value in numeric format.",b)}})}function validateRange(a,b){var c=!0;if(a){var d=a.form.id,e="#"+d+"_slider_"+b,f=($(e).slider(),$(e).slider("option","min")),g=$(e).slider("option","max");(a.value>g||a.value<f)&&(c=!1)}return c}function setEventsForNumber(a,b){$("body").on("focusin focusout",a,function(a){if("focusin"===a.type)$(this).attr("defval",$(this).val()),$(this).val("");else if("focusout"===a.type){var c="#"+this.form.id+"_slider_"+b,d=$(c).prev("input").get(0),e=$(c).next("input").get(0);""==$(this).val()?$(this).val($(this).attr("defval")):validateForDecimalPlaces(d,0,b)&&validateForDecimalPlaces(e,0,b)?validateRange(d,b)&&validateRange(e,b)?(hideError(this.form,b),$(this).attr("defval",$(this).val())):showPropertyError(this,"Please enter a value within the range shown",b):showPropertyError(this,"Please enter a value in numeric format.",b)}})}function setDefaultDate(){var a=new Date,b=$.datepicker.formatDate("mm/yy",a);$(':input[name="minmaturity"]').each(function(){""===$(this).val()&&$(this).val(b).attr("defval",b)}),$(':input[name="maxmaturity"]').each(function(){""===$(this).val()?$(this).val("mm/yyyy"):$(this).attr("defval",$(this).val())})}function setDefaultDateToForm(a){var b=new Date,c=$.datepicker.formatDate("mm/yy",b);$("#"+a+' :input[name="minmaturity"]').val(c),$("#"+a+' :input[name="maxmaturity"]').val("mm/yyyy")}function updateAcrossOffMinMaxValues(a,b){b&&(b.minprice&&(b.minprice.value=a.minprice,b.maxprice.value=a.maxprice,addSliderEvents(b.id,"askPrice",a.minprice,a.maxprice,b.minprice.value,b.maxprice.value,.001)),b.minyield&&(b.minyield.value=a.minyield,b.maxyield.value=a.maxyield,addSliderEvents(b.id,"askYield",a.minyield,a.maxyield,b.minyield.value,b.maxyield.value,.001)),b.mincoupon&&(b.mincoupon.value=a.mincoupon,b.maxcoupon.value=a.maxcoupon,addSliderEvents(b.id,"coupon",a.mincoupon,a.maxcoupon,b.mincoupon.value,b.maxcoupon.value,.001)))}function restoreDefaultValues(a){var b=a.id,c="#"+b+" :input[type='text'][defval]";$(c).each(function(){""==$(this).val()&&$(this).val($(this).attr("defval"))})}function updateSlidersWithSavedValues(a){var b=$("#ui-id-4").attr("href");if(null!=b&&""!=b){b=b.substr(b.indexOf("?"));var c="#"+a+" :input",d="",e="";$(c).each(function(){d=this.name,(e=getParamByName(d,b))&&""!=e&&("checkbox"!=this.type||isMultiSelectBox(this.name)||this.value!=e?"minmaturity"==d||"maxmaturity"==d?10==e.length&&$(this).val(e.substring(3,10)):isMultiSelectBox(this.name)||($(this).val(e),$(this).trigger("blur")):$(this).val(e))}),"Y"!=getParamByName("orRating",b)&&"L"!=getParamByName("orRating",b)||$("#"+a+" input[name='eitherRatingsInd']").prop("checked",!0)}else{cdtaburl&&(b=cdtaburl),location.hash.indexOf("#tbindividual-bonds")>-1&&(b=$("#ui-id-4").attr("href"));-1==b.indexOf("?")||"Y"!=getParamByName("orRating",b)&&"L"!=getParamByName("orRating",b)||$("#"+a+" input[name='eitherRatingsInd']").prop("checked",!0)}}function getParamByName(a,b){var c="[\\?&]"+a+"=([^&#]*)",d=new RegExp(c),e=d.exec(b);return null==e?"":decodeURIComponent(e[1].replace(/\+/g," "))}function isParamExist(a,b){var c="[\\?&]"+a+"=([^&#]*)";return null!=new RegExp(c).exec(b)}function inputKeyUp(a,b,c){c.which=c.which||c.keyCode,13==c.which&&validateAccount(a,b)}function getSearchCount(a){}function getDate(a){var b=a.split("/"),c=new Date,d=parseInt(b[0]-1),e=parseInt(b[1]),f=new Date(e,d,c.getDate());return f.setHours(0,0,0,0),f}function setMinMaxInputAriaInvalid(a,b,c){switch(b){case"askQuantity":$("#"+a+"_minQuantity").attr("aria-invalid",c),$("#"+a+"_maxQuantity").attr("aria-invalid",c);break;case"bidQuantity":$("#"+a+"_minQuantityBid").attr("aria-invalid",c),$("#"+a+"_maxQuantityBid").attr("aria-invalid",c);break;case"askPrice":$("#"+a+"_minprice").attr("aria-invalid",c),$("#"+a+"_maxprice").attr("aria-invalid",c);break;case"coupon":$("#"+a+"_mincoupon").attr("aria-invalid",c),$("#"+a+"_maxcoupon").attr("aria-invalid",c);break;case"askYield":$("#"+a+"_minyield").attr("aria-invalid",c),$("#"+a+"_maxyield").attr("aria-invalid",c)}}function setAriaLabelledby(a,b,c,d,e,f){var g="#"+a+"_slider_"+b,h="";switch(b){case"askQuantity":h="Ask Quantity";break;case"bidQuantity":h="Bid Quantity";break;case"askPrice":h="Ask Price";break;case"coupon":h="Coupon";break;case"askYield":h="Ask Yield"}$(g+" a").each(function(a){0==a&&($(this).attr("aria-labelledby",h+" Min"),$(this).attr("aria-valuetext",h+" Min"),$(this).attr("aria-valuenow",e),$(this).attr("aria-valuemin",c),$(this).attr("aria-valuemax",d),$(this).attr("role","slider")),1==a&&($(this).attr("aria-labelledby",h+" Max"),$(this).attr("aria-valuetext",h+" Max"),$(this).attr("aria-valuenow",f),$(this).attr("aria-valuemin",c),$(this).attr("aria-valuemax",d),$(this).attr("role","slider"))})}function addCommas(a){a+="",x=a.split("."),x1=x[0],x2=x.length>1?"."+x[1]:"";for(var b=/(\d+)(\d{3})/;b.test(x1);)x1=x1.replace(b,"$1,$2");return x1+x2}function isMoreCriteriaCollapsed(a){return!$("#"+a.id+" a.toggle-attr-link").hasClass("expanded")}function expandShowMoreCriteria(a){$("#"+a.id+" a.toggle-attr-link").hasClass("expanded")||$("#"+a.id+" a.toggle-attr-link").trigger("click")}function clearCheckBoxesOf(a,b){var c="#"+b+" div.multi-select-dropdown :input[name='"+a+"']",d=c+":checked";$(c).size()==$(d).size()&&(checkedAllMapping[a]=!0,$(c).prop("checked",!1))}function isMultiSelectBox(a){return"statecode"==a||"use"==a||"sector"==a||"subPaymentMonth"==a}function restoreMultipleCheckBoxes(a,b,c){var d=$("#"+c+" div.multi-select-dropdown input:checkbox[name='"+a+"']");if("statecode"==a&&""!=referrerCross&&d.prop("checked",!1),d.size()>1&&""!=b){b=b.replace(/\+/g," ");var e=a+"=";d.each(function(){""!=this.value&&-1!=b.indexOf(e+this.value+"&")&&$(this).prop("checked",!0)})}}function initializeMultiSelectDropDowns(a,b){var c="#"+b+" div.multi-select-dropdown :input[name='"+a+"']",d=$(c),e=$(c+":checked"),f=$(d.eq(0)).parent(".multi-select-dropdown"),g=$(f).prev(".multi-select-input");d.size()>1&&0==e.size()?(d.prop("checked",!0),""==referrerCross&&-1==$("#ui-id-4").attr("href").indexOf("&preferenceName=")&&-1==cdtaburl.indexOf("&preferenceName=")||"statecode"==a&&g.val(d.eq(0).next("label").text())):e.size()==d.size()?""==referrerCross&&-1==$("#ui-id-4").attr("href").indexOf("&preferenceName=")&&-1==cdtaburl.indexOf("&preferenceName=")||g.val(d.eq(0).next("label").text()):e.size()>0&&g.val(e.size()+" Selected")}function loadSavedValuesForMultiDropDown(a,b){var c=$("#ui-id-4").attr("href");null!=c&&""!=c&&"null"!=c.split("?")[1]&&(c+="&",c=c.substr(c.indexOf("?")),restoreMultipleCheckBoxes(a,c,b)),initializeMultiSelectDropDowns(a,b)}function updateDownloadURL(a){var b=$("a#resultsDownloadLink").attr("href"),c=b+"&"+$("#"+a+" :input[value][value!='']").serialize();$("a#resultsDownloadLink").attr("href",c)}function updateAcrossFormForBondTypes(a,b){var c=$("#ui-id-4").attr("href");if(null!=c&&""!=c){c=c.substr(c.indexOf("?"));var d=getParamByName("acrossAll",c);a.acrossAll&&(a.acrossAll.value==d||-1!==c.indexOf("ref_rfi=0010")&&!isBackOrEdit&&b)&&(a.acrossAll.checked=!0),d=getParamByName("acrossTreas",c),a.acrossTreas&&(a.acrossTreas.value==d||-1!==c.indexOf("ref_rfi=0010")&&!isBackOrEdit&&b)&&(a.acrossTreas.checked=!0),d=getParamByName("acrossTIPS",c),a.acrossTIPS&&(a.acrossTIPS.value==d||-1!==c.indexOf("ref_rfi=0010")&&!isBackOrEdit&&b)&&(a.acrossTIPS.checked=!0),d=getParamByName("acrossCD",c),a.acrossCD&&(a.acrossCD.value==d||-1!==c.indexOf("ref_rfi=0010")&&!isBackOrEdit&&b)&&(a.acrossCD.checked=!0),d=getParamByName("acrossAgency",c),a.acrossAgency&&(a.acrossAgency.value==d||-1!==c.indexOf("ref_rfi=0010")&&!isBackOrEdit&&b)&&(a.acrossAgency.checked=!0),d=getParamByName("acrossMuni",c),a.acrossMuni&&(a.acrossMuni.value==d||-1!==c.indexOf("ref_rfi=0010")&&!isBackOrEdit&&b)&&(a.acrossMuni.checked=!0),d=getParamByName("acrossCorp",c),a.acrossCorp&&(a.acrossCorp.value==d||-1!==c.indexOf("ref_rfi=0010")&&!isBackOrEdit&&b)&&(a.acrossCorp.checked=!0),d=getParamByName("acrossHighYieldCorp",c),a.acrossHighYieldCorp&&(a.acrossHighYieldCorp.value==d||-1!==c.indexOf("ref_rfi=0010")&&!isBackOrEdit&&b)&&(a.acrossHighYieldCorp.checked=!0),d=getParamByName("acrossCorpNote",c),a.acrossCorpNote&&(a.acrossCorpNote.value==d||-1!==c.indexOf("ref_rfi=0010")&&!isBackOrEdit&&b)&&(a.acrossCorpNote.checked=!0)}else updateMultiSeletLabel(a.id);updateAcrossBondTypeLabel(a.id)}function updateMultiSeletLabel(a){var b="#"+a+" div.multi-select-dropdown";$(b).each(function(){var a=$(this).children("input:checkbox"),b=$(this).children("input:checkbox:checked"),c=$(a.eq(0)).parent(".multi-select-dropdown"),d=$(c).prev(".multi-select-input");a.size()>1&&0==b.size()?a.prop("checked",!0):b.size()==a.size()?d.val(a.eq(0).next("label").text()):b.size()>0&&d.val(b.size()+" Selected")})}function updateValuesFromQuery(a){var b="";if(cdtaburl&&(b=cdtaburl),location.hash.indexOf("#tbindividual-bonds")>-1&&(b=$("#ui-id-4").attr("href")),-1!=b.indexOf("?")){"Y"!=getParamByName("orRating",b)&&"L"!=getParamByName("orRating",b)||$("#"+a+" input[name='eitherRatingsInd']").prop("checked",!0);var c=getParamByName("minmoody",b),d=getParamByName("maxmoody",b),e=getParamByName("minsandp",b),f=getParamByName("maxsandp",b);""!=c&&""!=e&&$("#"+a+"_minRatings").val(c+"/"+e),""!=d&&""!=f&&$("#"+a+"_maxRatings").val(d+"/"+f);var g=getParamByName("bondtierind",b),h=getParamByName("bondotherind",b);if("Y"==g&&"Y"==h?$("#"+a+"_bondind").val("All"):"Y"==g&&""==h?$("#"+a+"_bondind").val("Y"):""==g&&"Y"==h&&$("#"+a+"_bondind").val(""),"advMunicipalSec"==a){var i=getParamByName("general",b),j=getParamByName("revenue",b);"G"==i&&"R"==j?$("#"+a+"_incomeSource").val(""):""==i&&"R"==j?$("#"+a+"_incomeSource").val("R"):"G"==i&&""==j&&$("#"+a+"_incomeSource").val("G");var k=getParamByName("taxable",b);""!=k&&null!=k&&$("#advMunicipalSec_taxable").val(k),isParamExist("sinkind",b)||($("#advMunicipalSec_sinkind").val("N"),$("#advCorpInvGradeSec_sinkind").val("N"),$("#advCorpHighYieldSec_sinkind").val("N"),$("#advOffersSec_sinkind").val("N"),$("#advOffersNew_sinkind").val("N")),isParamExist("amtind",b)||$("#advMunicipalSec_amtind").val("N")}updateValueFromreferrerCross("sinkind",a),updateValueFromreferrerCross("account",a),updateNextCallDateFromParam(a,b)}}function updateNextCallDateFromParam(a,b){var c=!1,d=!1,e=document.getElementById(a+"_typenextcalldate");if(null!==e){var f=e.options[e.selectedIndex].value;null!=f&&""!=f&&("BT"==f?(c=!0,d=!0):"AF"!=f&&"BE"!=f||(c=!0))}c?$("#"+a+"_nextCallDateField1").show():$("#"+a+"_nextCallDateField1").hide(),d?$("#"+a+"_nextCallDateField2").show():$("#"+a+"_nextCallDateField2").hide()}function updateValueFromreferrerCross(a,b){var c=""+$("#ui-id-4").attr("href");if(-1!=c.indexOf("?")){var d=getParamByName(a,c);d||""==d||$("#"+b+" :input[name='"+a+"']").val(d)}}function updateValueForCallDrop(a,b,c,d){var e="";if(cdtaburl&&(e=cdtaburl),location.hash.indexOf("#tbindividual-bonds")>-1&&(e=$("#ui-id-4").attr("href")),-1!=e.indexOf("?")){var f=getParamByName(a,e),g=getParamByName(b,e),h=$("#"+d+" :input[name='"+a+"']"),i=$("#"+d+" :input[name='"+b+"']");"NO"==f?h.val(f).trigger("change",!0):"Y"==g?i.val(g).trigger("change",!0):(h.val(f),i.val(g))}if(-1!=e.indexOf(c)){var j=getParamByName(c,e);$("#"+d+" :input[name='"+c+"']").val(j)}"Yes"!=$("#advMunicipalSec_taxable").find(":selected").text()&&"Yes"!=$("#advMunicipalSec_callind").find(":selected").text()&&($("#advMunicipalSec_makeWholeCall").removeAttr("disabled"),$("#advMunicipalSec_makeWholeCall_label").css("color","black"))}function resetAllFormsExceptThis(a){"true"==$("#firstLoad").val()&&$("div#main-content form").each(function(){var b=$(this).attr("id");a!=b&&resetFormById(b)})}function resetFormById(a){$("#"+a+" .multi-select-dropdown input:checkbox").prop("checked",!0),$("#"+a+" :input[name='askQuantity']").prop("checked",!0),$("#"+a+" :input[name='bidQuantity']").prop("checked",!0),$("#"+a+" :input[name='askPrice']").prop("checked",!0),$("#"+a+" :input[name='coupon']").prop("checked",!0),$("#"+a+" :input[name='askYield']").prop("checked",!0),$("#"+a+" :input:text").each(function(){$(this).hasClass("multi-select-input")||$(this).val("")}),$("#"+a+"_eitherRatingsInd").prop("checked",!0),$("#"+a+" select").each(function(){this.selectedIndex=0}),"advMunicipalSec"==a&&($("#advMunicipalSec_taxable").val("E"),disableDropdown("#advMunicipalSec_makeWholeCall"),$("#advMunicipalSec_sinkind").val("N"),$("#advMunicipalSec_amtind").val("N"),resetNextCallDate("advMunicipalSec")),"advCorpInvGradeSec"===a&&($("#advCorpInvGradeSec_sinkind").val("N"),resetNextCallDate("advCorpInvGradeSec")),"advCorpHighYieldSec"===a&&($("#advCorpHighYieldSec_sinkind").val("N"),resetNextCallDate("advCorpHighYieldSec")),"advOffersSec"===a&&($("#advOffersSec_sinkind").val("N"),resetNextCallDate("advOffersSec")),"advAgencySecodary"===a&&resetNextCallDate("advAgencySecodary"),"advOffersNew"===a&&$("#advOffersNew_sinkind").val("N")}function resetNextCallDate(a){$("#"+a+"_onenextcalldate").val(""),$("#"+a+"_twonextcalldate").val(""),$("#"+a+"_onenextcalldate").datepicker("option","minDate",0),$("#"+a+"_onenextcalldate").datepicker("option","maxDate",null),$("#"+a+"_twonextcalldate").datepicker("option","minDate",0),$("#"+a+"_twonextcalldate").datepicker("option","maxDate",null),$("#"+a+"_nextCallDateField1").hide(),$("#"+a+"_nextCallDateField2").hide(),clearNextCallDateErrMsg(a)}function updateAcrossBondTypeLabel(a){var b="#"+a+"_bondType_optDiv";$(b).each(function(){var b=$(this).children("input:checkbox"),c=$(this).children("input:checkbox:checked"),d=$(b.eq(0)).parent(".multi-select-dropdown"),e=$(d).prev(".multi-select-input");b.size()>1&&0==c.size()?(b.prop("checked",!0),"advOffersSec"==a?e.val("All including High Yield"):e.val("All Types")):c.size()==b.size()?e.val(b.eq(0).next("label").text()):c.size()>0&&e.val(c.size()+" Selected")})}function checkValue(){with(document.cusipForm)""==prodmajor.value?(document.getElementById("srch").value="",document.cusipForm.srch.disabled=!0):document.cusipForm.srch.disabled=!1}function stripPaymentMonth(){try{$('table.saved-searches-table a[href^="/ftgw/fi/"]').each(function(){var a=$(this).attr("href");-1!=a.indexOf("paymentmonth")&&$(this).attr("href",stripPayfreq(a))})}catch(a){console.log("bond-search.js stripPaymentMonth(): "+a.message)}}function stripPayfreq(a){var b=/paymentmonth=([0-9]+&?)/g;return null!=a&&""!=a?a.replace(b,""):""}function getLatestValueOfParam(a){var b="";return cdtaburl&&(b=cdtaburl),location.hash.indexOf("#tbindividual-bonds")>-1&&(b=$("#ui-id-4").attr("href")),getParamByName(a,b)}function isSilverlightInstalled(){var a=!1;try{try{a=!0}catch(b){navigator.plugins["Silverlight Plug-In"]&&(a=!0)}}catch(a){}return a}function getCookieValue(a){return currentcookie=document.cookie,currentcookie.length>0&&(firstidx=currentcookie.indexOf(a+"="),-1!=firstidx)?(firstidx=firstidx+a.length+1,lastidx=currentcookie.indexOf(";",firstidx),-1==lastidx&&(lastidx=currentcookie.length),unescape(currentcookie.substring(firstidx,lastidx))):""}function disableSliderbars(a,b){a&&(a.minyield==a.maxyield?disableSlider(b,"askYield"):enableSlider(b,"askYield"),a.minprice==a.maxprice?disableSlider(b,"askPrice"):enableSlider(b,"askPrice"),a.minQuantity==a.maxQuantity?disableSlider(b,"askQuantity"):enableSlider(b,"askQuantity"),a.minQuantityBid==a.maxQuantityBid?disableSlider(b,"bidQuantity"):enableSlider(b,"bidQuantity"),a.mincoupon==a.maxcoupon?disableSlider(b,"coupon"):enableSlider(b,"coupon"))}function disableSlider(a,b){$("div#"+a+"_sliderBox_"+b+" .slider-wrap").attr("disabled","disabled"),$("div#"+a+"_sliderBox_"+b+" .slider-wrap input:text").attr("disabled","disabled"),$("div#"+a+"_sliderBox_"+b+" .slider-title input").attr("disabled","disabled")}function enableSlider(a,b){$("div#"+a+"_sliderBox_"+b+" .slider-wrap").removeAttr("disabled"),$("div#"+a+"_sliderBox_"+b+" .slider-wrap input:text").removeAttr("disabled"),$("div#"+a+"_sliderBox_"+b+" .slider-title input").removeAttr("disabled")}function isValidaRequestPage(a){var b=["FISearchTIPS","FISearchTreasury","FISearchCD","FISearchAgency","FISearchMunicipal","FISearchHighYield","FISearchCorporate","FISearchAcrossOff","FISearchAcrossOffNewIssue","FISearchCatsTigrs"],c=!1;return $(b).each(function(){if(this==a)return c=!0,!1}),c}function updateExpandedState(a){var b=$("#ui-id-4").attr("href");location.hash.indexOf("#tbcds|treasury|cd-market")>-1&&cdtaburl&&(b=cdtaburl);var c=b.indexOf("expandedState="),d="";if(-1!=c){c=c+"expandedState".length+1;var e=b.indexOf("&",c);-1==e&&(e=b.length),d=b.substring(c,e)}"Y"==d&&expandShowMoreCriteria(a)}function isiPhoneOriPad(){return-1!=navigator.platform.indexOf("iPhone")||-1!=navigator.platform.indexOf("iPod")||null!=navigator.userAgent.match(/iPad/i)}function hideAllSliderErrors(a){a.askPrice&&hideError(a,"askPrice"),a.askYield&&hideError(a,"askYield"),a.coupon&&hideError(a,"coupon"),a.bidQuantity&&hideError(a,"bidQuantity"),a.askQuantity&&hideError(a,"askQuantity")}function disableEntryFields(a){var b=document.getElementById(a),c="";if(b.minmaturity){var d=new Date;c+="minmaturity="+$.datepicker.formatDate("mm/yy",d)+"&"}b.bondtierind&&(c+="bondtierind=Y&"),b.bondotherind&&(c+="bondotherind=Y&"),b.incomeSource&&(c+="general=G&revenue=R&"),b.prodmajor&&(c+="prodmajor="+b.prodmajor.value+"&"),b.prodminor&&(c+="prodminor="+b.prodminor.value+"&"),b.requestpage&&(c+="requestpage="+b.requestpage.value+"&"),b.sortby&&(c+="sortby="+b.sortby.value+"&"),b.acrossAgency&&(c+="acrossAgency=AGENCY&"),b.acrossAll&&(c+="acrossAll=ALL&"),b.acrossCD&&(c+="acrossCD=CD&"),b.acrossCorp&&("FISearchAcrossOff"==a&&(c+="acrossCorp=CORP&"),"FISearchAcrossOffNewIssue"==a&&(c+="acrossCorp=CPBOND&")),b.acrossCorpNote&&(c+="acrossCorpNote=CORPNT&"),b.acrossHighYieldCorp&&(c+="acrossHighYieldCorp=HIGHYIELDCORP&"),b.acrossMuni&&(c+="acrossMuni=MUNI&"),b.acrossTreas&&(c+="acrossTreas=TREAS&"),b.acrossTIPS&&(c+="acrossTIPS=TIPS&"),c+="tabPageLoad=tabPageLoad",$.ajax({type:"POST",url:"/ftgw/fi/FIIndividualBondsSearchCount?",data:c,success:function(b,c,d){try{obj=$.parseJSON(b),"success"==obj.status&&"1"==obj.totalCount&&($("#"+a+" .default-attributes-box input,#"+a+" .default-attributes-box select,#"+a+" .default-attributes-box img").attr("disabled","disabled"),$("#"+a+" .additional-attributes-box input,#"+a+" .additional-attributes-box select,#"+a+" .additional-attributes-box img").attr("disabled","disabled"))}catch(a){}}})}function validateAccount(a,b){if(validateCombinationNextCallDate(getBoundSearchId(document.getElementsByClassName("selected")[0].id)),"true"==a&&""==$("#account").val())alert("Please select an account");else{var c=$(b).parents("form:first").attr("id");0===$("#"+c).find(".error-msg:visible").size()&&("adv_SeeResults"===$(b).attr("id")&&animatedWaitCreate(),showOfferings(c,"FIIndividualBondsSearchCount",null,getDefaultValueForRatings(c)))}}function getSubTabTitle(a){var b="treasury";switch(a){case"FISearchTIPS":b="tips";break;case"FISearchCD":b="cd";break;case"FISearchAgency":b="agency";break;case"FISearchMunicipal":b="municipal";break;case"FISearchHighYield":b="corphysec";break;case"FISearchCorporate":b="corporate";break;case"FISearchAcrossOff":b="allofferings";break;case"FISearchAcrossOffNewIssue":b="advoffernew";break;case"FISearchCatsTigrs":b="advcatstigrs"}return"|"+b}function getRequestPageFromUrl(a){if(a){var b=null,c=a.indexOf("requestpage=");if(c>-1&&(a=a.substring(c+"requestpage=".length),c=a.indexOf("&"),b=c>-1?a.substring(0,c):a)){return getSubTabTitle(b).replace("|","")}}return""}function showDisclaimer(a,b){var c=0;c=null==b.newTab?b.tab.index():b.newTab.index(),3!=c&&$(".disclaimers").hide(),0===c?$("#legal-yields").show():1===c?$("#legal-indbonds").show():2===c?($("#legal-issues").show(),$('#attributesLegend ul li a[onclick*="bluesky"]').text("Blue Sky States")):4===c?$("#legal-annuities").show():5===c?$("#legal-funds").show():6===c&&$("#legal-ETFs").show()}function showDisclaimer4YieldsLanding(){$("#subTabs .tabs li[aria-controls=tbcurrent-yields]").hasClass("ui-tabs-active")&&"none"==$("#legal-yields").css("display")&&($(".disclaimers").hide(),$("#legal-yields").show())}function showDisclaimer4NewIssueCDsToggle(){$(".disclaimers").hide(),$("#legal-CDs--newissues").show()}function removeCDsDom(){$("#tbcds .panel-newissue").children().remove(),$("#tbcds .panel-secondary").children().remove()}function removeIndividuslBondsDom(){$("#subTabs ul li[aria-controls='tbindividual-bonds'] a").attr("href","/ftgw/fi/FindBondsCDsIndividualBonds?ref_rfi=0010")}function runEdit(a){-1===a.indexOf("amtind")&&(a.match("&$")?a+="amtind=":a+="&amtind=");var b=/^[a-zA-Z0-9_ \-\$\.!?$+#]{0,30}$/;if(!decodeURIComponent(getQueryValue(a,"preferenceName")).match(b))return window.location.href=a.replace("FindBondsCDsIndividualBonds","FIIndividualBondsSearch"),!1;editFlag=!0,animatedWaitCreate(),$("#saved_searches").trigger("click"),reloadIndividualBondTab(a,location.hash.indexOf("#tbindividual-bonds")>-1)}function reloadIndividualBondTab(a,b){if(a){var c=a.indexOf("requestpage");if(c>-1){c=c+"requestpage".length+1;var d=a.indexOf("&",c);d<0&&(d=a.length);var e=a.substring(c,d),f=getSubTabTitle(e);$("#ui-id-4").attr("href",a);var g=$("li[aria-controls=tbindividual-bonds]").index();$("#subTabs").tabs({active:g}),saveFormLayout("tbindividual-bonds",f.substring(1)),b&&$("#subTabs").tabs("load",g)}else $("#ui-id-4").attr("href",a),saveFormLayout("tbindividual-bonds","treasury"),$("#subTabs").tabs({active:1}),b&&$("#subTabs").tabs("load",1)}}function animatedWaitCreate(){overlay||(overlay=$(".loading-indicator--container"),overlayHTML=$(".loading-indicator").html(),$("body").append(overlayHTML)),$(".loading-indicator--wait-image").show(),overlay.show(),$(".loading-indicator--modal-overlay-mask").show()}function animatedWaitDestroy(){$(".loading-indicator--wait-image").hide(),overlay&&overlay.hide(),$(".loading-indicator--modal-overlay-mask").hide()}function secondaryIssuePanel(){$("#subTabs #tbcds .linkTabs li.cd-market a").trigger("click")}function loginForCDsNewIssuePanel(){return window.location=contextPath+"/gotoFIBL/FILanding?tab=tbcds",!1}function updateCDsNewIssuePanel(a){$("#newIssueCDs").empty();var b;location.hash.indexOf("cd-ladder");if("true"===a){if(b="/ftgw/fi/ajax/FICorpNotesDisplay?name=CD&requestpage=FILandingCD&sortby=MA&maturityRange=A",$(".landingRWVAccounts .account-select-component").length){var c=$(".landingRWVAccounts .account-select-component .account-dropdown").val();null!=c&&""!=c&&(b+="&account="+c)}}else b="/ftgw/fi/FILanding?requestpage=FILandingCD&tab="+encodeURIComponent("tbcds|treasury|cd-new-issue");animatedWaitCreate(),jQuery.ajax({type:"GET",async:!0,url:b,dataType:"text",data:"",success:function(a){if(null!=a&&""!=a)if($("#tbcds .panel-newissue").html(a),null!=screenerForm.savedMaturityRange&&"all"!=screenerForm.savedMaturityRange){var b=$(".landingRWVAccounts #account").val();if($(".landingRWVAccounts #account").length&&!b)saveFormLayout("tbcds","treasury","cd-new-issue","all"),animatedWaitDestroy();else{var c=$("#subTabs #tbcds #newIssueCDs .topRates #topRate-"+screenerForm.savedMaturityRange+" a");0==c.size()?(saveFormLayout("tbcds","treasury","cd-new-issue","all"),animatedWaitDestroy()):c.trigger("click")}}else animatedWaitDestroy();else $("#tbcds .panel-newissue").html("<div><p>The application is experiencing technical difficulties.  Please try again later.</p></div>"),animatedWaitDestroy()},error:function(a,b,c){FixedIncome.isSessionTimeout(a)||($("#tbcds .panel-newissue").html("<div><p>The application is experiencing technical difficulties.  Please try again later.</p></div>"),animatedWaitDestroy())}})}function updateCDsSecondaryPanel(a){$("#tbcds .panel-secondary").removeClass("display-panel"),a||(a="/ftgw/fi/FindBondsCDsIndividualBonds?requestpage=FILandingCD&callind=&minmaturity=&maxmaturity="),jQuery.ajax({type:"GET",async:!0,url:a,dataType:"text",data:"",success:function(b){null!=b&&""!=b?$("#tbcds .panel-secondary").html(b):$("#tbcds .panel-secondary").html("<div><p>The application is experiencing technical difficulties.  Please try again later.</p></div>"),referrerCross=a,loadBondSearch("pcb_advCDsSecondary"),$("#tbcds .panel-secondary").addClass("display-panel")},error:function(a,b,c){$("#tbcds .panel-secondary").html("<div><p>The application is experiencing technical difficulties.  Please try again later.</p></div>"),$("#tbcds .panel-secondary").addClass("display-panel")}})}function updateNewIssueBondTypePannel(){var a="/ftgw/fi/ajax/FICorpNotesDisplay?name=acrossOffering&requestpage=FILandingNewIssue&viewBy=BondType";if($(".landingRWVAccounts .account-select-component").length){var b=$(".landingRWVAccounts .account-select-component .account-dropdown").val();null!=b&&""!=b&&(a+="&account="+b)}animatedWaitCreate(),jQuery.ajax({type:"GET",async:!0,url:a,dataType:"text",data:"",success:function(a){null!=a&&""!=a?($("#tbnewissues .panel-new-issue--bond-type").html(a),FixedIncome.newIssuesTab.openAccordions(screenerForm.savedOpenedNewIssueTypes)):$("#tbnewissues .panel-new-issue--bond-type").html("<div><p>The application is experiencing technical difficulties.  Please try again later.</p></div>"),animatedWaitDestroy()},error:function(a,b,c){FixedIncome.isSessionTimeout(a)||($("#tbnewissues .panel-new-issue--bond-type").html("<div><p>The application is experiencing technical difficulties.  Please try again later.</p></div>"),animatedWaitDestroy())}})}function updateNewIssueAllOfferingsPannel(){var a="/ftgw/fi/ajax/FICorpNotesDisplay?name=acrossOffering&requestpage=FILandingNewIssue";if($(".landingRWVAccounts .account-select-component").length){var b=$(".landingRWVAccounts .account-select-component .account-dropdown").val();null!=b&&""!=b&&(a+="&account="+b)}animatedWaitCreate(),jQuery.ajax({type:"GET",async:!0,url:a,dataType:"text",data:"",success:function(a){null!=a&&""!=a?$("#tbnewissues .panel-new-issue--all-offerings").html(a):$("#tbnewissues .panel-new-issue--all-offerings").html("<div><p>The application is experiencing technical difficulties.  Please try again later.</p></div>"),animatedWaitDestroy()},error:function(a,b,c){FixedIncome.isSessionTimeout(a)||($("#tbnewissues .panel-new-issue--all-offerings").html("<div><p>The application is experiencing technical difficulties.  Please try again later.</p></div>"),animatedWaitDestroy())}})}function sortNewissues(a){animatedWaitCreate(),jQuery.ajax({type:"GET",async:!0,url:a,dataType:"text",data:"",success:function(a){null!=a&&""!=a?$("#tbnewissues .panel-new-issue--all-offerings").html(a):$("#tbnewissues .panel-new-issue--all-offerings").html("<div><p>The application is experiencing technical difficulties.  Please try again later.</p></div>"),animatedWaitDestroy()},error:function(a,b,c){FixedIncome.isSessionTimeout(a)||($("#tbnewissues .panel-new-issue--all-offerings").html("<div><p>The application is experiencing technical difficulties.  Please try again later.</p></div>"),animatedWaitDestroy())}})}function sortNewissuesByType(a,b){$("#"+a+" .loading-indicator-mask--new-issues").show(),$("#"+a+" .wait-image-container--new-issues").show(),jQuery.ajax({type:"GET",async:!0,url:b,dataType:"text",data:"",success:function(b){if(null!=b&&""!=b){$("#"+a+" div.by-type-block").html(b);var c=$("#"+a+" div.by-type-block").find("#countOneType").html(),d=$.trim(c);$("#"+a+"> a span").html(d),"0"==d&&($("#"+a+"> a").removeClass("expand-collapse--fancyexpand"),$("#"+a+"> a").addClass("expand-collapse--fancycollapse"),$("#"+a+"> a").addClass("bond-type-title--no-inventory"))}else $("#"+a).html("<div><p>The application is experiencing technical difficulties.  Please try again later.</p></div>");$("#"+a+" .loading-indicator-mask--new-issues").hide(),$("#"+a+" .wait-image-container--new-issues").hide()},error:function(b,c,d){FixedIncome.isSessionTimeout(b)||($("#"+a).html("<div><p>The application is experiencing technical difficulties.  Please try again later.</p></div>"),$("#"+a+" .loading-indicator-mask--new-issues").hide(),$("#"+a+" .wait-image-container--new-issues").hide())}})}function showRerunForRWV(){$(".landingRWVAccounts .account-select-component").length&&"none"===$(".landingRWVAccounts .account-select-component .rerun-search").css("display")&&$(".landingRWVAccounts .account-select-component .rerun-search").show()}function hideRerunForRWV(){"none"!=$(".landingRWVAccounts .account-select-component .rerun-search").css("display")&&$(".landingRWVAccounts .account-select-component .rerun-search").hide()}function rerunSearchForLanding(){if($(".landingRWVAccounts .account-select-component").length){var a=$(".landingRWVAccounts .account-select-component .account-dropdown").val();if(null==a||""==a)return alert("Please select an account"),!1;if($("#subTabs li[aria-controls=tbnewissues]").hasClass("ui-tabs-active")){var b=$(".tabs li[aria-controls=tbnewissues] a").attr("href");b=updateQueryStringParameter(b,"account",a),$(".tabs li[aria-controls=tbnewissues] a").attr("href",b),$("#tbnewissues .new-issue--all-offerings").hasClass("ui-tabs-active")?$("#tbnewissues .linkTabs li.new-issue--all-offerings a").trigger("click"):$("#tbnewissues .linkTabs li.new-issue--bond-type a").trigger("click")}else $("#subTabs li[aria-controls=tbcds]").hasClass("ui-tabs-active")&&$("#tbcds .cd-new-issue").hasClass("ui-tabs-active")&&$("#tbcds #newIssueCDs table.topRates th a.clicked").trigger("click")}animatedWaitCreate()}function updateQueryStringParameter(a,b,c){var d=new RegExp("([?&])"+b+"=.*?(&|$)","i"),e=-1!==a.indexOf("?")?"&":"?";return a.match(d)?a.replace(d,"$1"+b+"="+c+"$2"):a+e+b+"="+c}function getScoreCard(a,b,c){var d=$(a).closest("form").parent(),e=document.getElementById("account").value,f="actionFlg=scorecard&account="+e+"&cusip="+b+"&orderSys="+c+"&includeOutsideHoldings="+getOHSInd(d),g=document.getElementsByName("name")[0].value;jQuery.ajax({type:"POST",url:"/ftgw/fi/FIWriteToSiebel",dataType:"json",data:f,success:function(c){null!=c&&FormatScoreCardVal(c,b,d),"CORPNTALL"==g&&(d.find("#suitability-layer #last_event_test_dataTag").closest("tr").show(),d.find("#suitability-layer #risk_considerations").closest("tr").show(),d.find("#last_event_test").text("--"),d.find("#last_event_test_dataTag").html("<a href='javascript:popWinME(\"/ftgw/fi/FIPopupIssuerEvents?cusip="+b+"\", this)' >Material / Issuer Events</a>")),"FANNIE"==g&&(d.find("#suitability-layer #last_event_test_dataTag").closest("tr").show(),d.find("#suitability-layer #risk_considerations").closest("tr").show(),d.find("#last_event_test").text("--"),d.find("#last_event_test_dataTag").html("<a href='javascript:popWinME(\"/ftgw/fi/FIPopupIssuerEvents?cusip="+b+"\", this)' >Material / Issuer Events</a>"),d.find("#proceeds_points").text("--")),"MUNIBD"==g&&(d.find("#suitability-layer #last_event_test_dataTag").closest("tr").show(),d.find("#suitability-layer #risk_considerations").closest("tr").show(),d.find("#suitability-layer #proceeds_points_dataTag").removeClass("bottomLine2Px"),d.find("#suitability-layer #proceeds_points").removeClass("bottomLine2Px")),"acrossOffering"!=g&&"CD"!=g&&"CDIP"!=g&&"FRCS"!=g&&"PPN"!=g&&"TIPS"!=g&&"TREASA"!=g||d.find("#proceeds_points").text("--"),d.find("#suitability-layer").css("top",jQuery(a).position().top-94+"px"),d.find("#suitability-layer").css("left",jQuery(a).position().left-jQuery("#suitability-layer").outerWidth()-25+"px"),$("#filterRates").css("overflow-y","scroll"),$("#filterRates").css("overflow-x","hidden"),d.find("#last_event_test_dataTag a").attr("style",anchorCss),showActivepopup(a,"popup-layer-component","close-window")},error:function(a,b,c){alert(c)}})}function showActivepopup(a,b,c){sourceID=a;var d=$(a).closest("form").parent(),e=$(a).closest("form").attr("id");FixedIncome.hidePopupScoreCard4NIBondType(e),d.find("#"+b).show(),d.find("#"+c)&&d.find("#"+c).focus(),d.find("#"+b).find(".suitability-layer").is(":visible")&&$(document).one("click",function(){hideActivepopup("popup-layer-component",null,d)})}function hideActivepopup(a,b,c){flag=!1,window.clearTimeout(timeoutID),timeoutID=setTimeout(function(){void 0!=c&&""!=c&&null!=c&&0!=c.find("#"+a)&&c.find("#"+a).hide(),$("#filterRates").css("overflow-y","visible")},0)}function popWinME(a,b){infowindowME&&infowindowME.close(),setTimeout(function(){infowindowME=window.open(a,"infowindowME","width=450,height=380,left=80,top=80,location=no,resizable=yes,menubar=no,status=no,toolbar=no,scrollbars=yes"),infowindowME.focus()},500)}function getOHSInd(a){var b="N";return a.find("#includeOutsideHoldings")&&$("#includeOutsideHoldings").is(":checked")&&(b=a.find("#includeOutsideHoldings").val()),b}function FormatScoreCardVal(a,b,c){var d=["inv_purp","fin_sit","age","tax_status","risk_tol","liquidity","invest_exp","time_horiz","concent"];$.each(d,function(b,d){"F"==a[d+"_test"]?(c.find("#"+d+"_points").removeClass("data-cell-pass").addClass("data-cell-fail"),c.find("#"+d+"_points").text("FAIL")):"P"==a[d+"_test"]&&(c.find("#"+d+"_points").removeClass("data-cell-fail").addClass("data-cell-pass"),c.find("#"+d+"_points").text(a[d+"_points"]))}),"F"==a.last_event_test?(c.find("#last_event_test").removeClass("data-cell-pass").addClass("data-cell-fail"),c.find("#last_event_test").text("FAIL"),c.find("#last_event_test_dataTag").html("<a href='javascript:popWinME(\"/ftgw/fi/FIPopupMaterialEvents?cusip="+b+"\", this)'  >Material / Issuer Events</a>")):"P"==a.last_event_test?(c.find("#last_event_test").text("PASS"),c.find("#last_event_test").removeClass("data-cell-fail").addClass("data-cell-pass"),c.find("#last_event_test_dataTag").html("<a href='javascript:popWinME(\"/ftgw/fi/FIPopupMaterialEvents?cusip="+b+"\", this)' >Material / Issuer Events</a>")):(c.find("#last_event_test_dataTag").html("<span style='font-weight:bold;color:#0f57c2;'>Material / Issuer Events</span>"),c.find("#last_event_test").text("N/A"),c.find("#last_event_test_dataTag").html("<a href='javascript:popWinME(\"/ftgw/fi/FIPopupMaterialEvents?cusip="+b+"\", this)' >Material / Issuer Events</a>")),"F"==a.proceeds_test?(c.find("#proceeds_points").removeClass("data-cell-pass").addClass("data-cell-fail"),c.find("#proceeds_points").text("FAIL")):"P"==a.proceeds_test&&(c.find("#proceeds_points").removeClass("data-cell-fail").addClass("data-cell-pass"),c.find("#proceeds_points").text(a.proceeds_points)),""==a.orderPrice?c.find("#orderPrice").text("0"):c.find("#orderPrice").text(a.orderPrice),c.find("#price_test_dataTag").addClass("data-labels-cell"),"F"==a.price_test?(c.find("#price_test").text("FAIL"),c.find("#price_test").removeClass("data-cell-pass").addClass("data-cell-fail")):"P"==a.price_test&&(c.find("#price_test").text("Pass"),c.find("#price_test").removeClass("data-cell-fail").addClass("data-cell-pass")),c.find("#risk_test_dataTag").addClass("data-labels-cell"),"F"==a.risk_test?(c.find("#risk_test").text("FAIL"),c.find("#risk_test").removeClass("data-cell-pass").addClass("data-cell-fail")):"P"==a.risk_test?(c.find("#risk_test").text("Pass"),c.find("#risk_test").removeClass("data-cell-fail").addClass("data-cell-pass")):c.find("#risk_test").text(""),c.find("#tam_stock_alloc").text(formatDouble(a.tam_stock_alloc)+"/"+formatDouble(a.tam_bond_alloc)+"/"+formatDouble(a.tam_cash_alloc)),c.find("#pre_trd_stk_alloc").text(formatDouble(a.pre_trd_stk_alloc)+"/"+formatDouble(a.pre_trd_bond_alloc)+"/"+formatDouble(a.pre_trd_cash_alloc)),c.find("#post_trd_stk_alloc").text(formatDouble(a.post_trd_stk_alloc)+"/"+formatDouble(a.post_trd_bond_alloc)+"/"+formatDouble(a.post_trd_cash_alloc)),"F"==a.asset_alloc_test?c.find("#post_trd_stk_alloc").addClass("data-cell-red"):c.find("#post_trd_stk_alloc").removeClass("data-cell-red"),c.find("#orderQuantity").text(a.orderQuantity),"Y"==a.warning_indicator?(""==a.maxAllowed?c.find("#maxAllowed").text("0"):c.find("#maxAllowed").text(a.maxAllowed),""!=a.maxAllowed&&(""==a.order_quantity||parseInt(a.order_quantity),parseInt(a.maxAllowed)),c.find("#maxAllowed").addClass("data-cell-green")):c.find("#maxAllowed").text(""),"F"==a.base_suit_test?(c.find("#orderQuantity").removeClass("data-cell-green").addClass("data-cell-red"),c.find("#totalPoints").text("FAIL"),c.find("#totalPoints").removeClass("data-cell-pass").addClass("data-cell-fail")):"P"==a.base_suit_test&&(c.find("#orderQuantity").removeClass("data-cell-red").addClass("data-cell-green"),c.find("#totalPoints").text("PASS"),c.find("#totalPoints").removeClass("data-cell-fail").addClass("data-cell-pass")),"F"==a.overall_suit_test?(c.find("#orderQuantity").removeClass("data-cell-green").addClass("data-cell-red"),c.find("#overallResults").text("FAIL"),c.find("#overallResults").removeClass("data-cell-pass").addClass("data-cell-fail")):"P"==a.overall_suit_test&&(c.find("#orderQuantity").removeClass("data-cell-red").addClass("data-cell-green"),c.find("#overallResults").text("PASS"),c.find("#overallResults").removeClass("data-cell-fail").addClass("data-cell-pass")),"F"==a.asset_alloc_test?(c.find("#allocationResults").text("FAIL"),c.find("#allocationResults").removeClass("data-cell-pass").addClass("data-cell-fail")):"P"==a.asset_alloc_test&&(c.find("#allocationResults").text("PASS"),c.find("#allocationResults").removeClass("data-cell-fail").addClass("data-cell-pass")),"F"==a.dol_test?(c.find("#BICSecurityRow").css("display",""),c.find("#BICSecurity").text("FAIL"),c.find("#BICSecurity").removeClass("data-cell-pass").addClass("data-cell-fail")):"P"==a.dol_test?(c.find("#BICSecurityRow").css("display",""),c.find("#BICSecurity").text("PASS"),c.find("#BICSecurity").removeClass("data-cell-fail").addClass("data-cell-pass")):c.find("#BICSecurityRow").css("display","none")}function formatDouble(a){if(null==a||""==a)return 0;if(a.match("^[0-9]*.[0-9]*$"))return Math.round(1*a);var b=Math.round(1*a.substring(0,a.length-1)),c=a.substring(a.length-1,a.length);return b.toString()+c}function getBondCountFromSolr(a){"advOffersNew"===a||"advCatsTigrs"===a||$("#"+a).find(".error-msg:visible").size()>0||(prevValMap=getDefaultValueForRatings(a),showOfferings(a,"FISecBondCount",accessTime,prevValMap))}function getDefaultValueForRatings(a){var b=$("#"+a),c={};if(b.find("[name=minRatings]").is(":visible")&&(c.minRatingsVal=b.find("[name=minRatings]").val(),c.maxRatingsVal=b.find("[name=maxRatings]").val()),b.find("[name=minUnderlying]").is(":visible")&&(c.minUnderlyingVal=b.find("[name=minUnderlying]").val(),c.maxUnderlyingVal=b.find("[name=maxUnderlying]").val()),b.find("[name=minmoody]").is(":visible")&&(c.minmoody=b.find("[name=minmoody]").val(),c.maxmoody=b.find("[name=maxmoody]").val(),c.minsandp=b.find("[name=minsandp]").val(),c.maxsandp=b.find("[name=maxsandp]").val()),b.find("[name=minMoodyUnderlying]").is(":visible")&&(c.minMoodyUnderlying=b.find("[name=minMoodyUnderlying]").val(),c.maxMoodyUnderlying=b.find("[name=maxMoodyUnderlying]").val(),c.minSandPUnderlying=b.find("[name=minSandPUnderlying]").val(),c.maxSandPUnderlying=b.find("[name=maxSandPUnderlying]").val()),"advOffersSec"===a){0===$("#advOffersSec .bondTypeMulti .multi-select-dropdown").children("input:checkbox:checked").size()&&(c.checkedAllFlag=!1)}return c}function initTakeAction(a){$(a).on("change",":checkbox",function(a){$(a.target).closest("td").toggleClass("highlight",this.checked),$(a.target).closest("tr").toggleClass("highlight",this.checked)}),$(a).on("click",".takeActionButton",function(a){var b=$(a.target).closest("table"),c=b.find(":checkbox:checked"),d=b.find(".takeActionPanel"),e=$(this);$(".customCDLadderPanel").is(":visible")&&($(".customCDLadderPanel").hide(),e.removeClass("openCustomCDLadderPanel")),location.hash.indexOf("cd-new-issue")>-1&&(d.removeClass("margin-top-186px"),d.removeClass("margin-top-160px"),e.toggleClass("openCustomCDLadderPanel")),e.next(d).toggle(),0===c.length?(location.hash.indexOf("cd-new-issue")>-1&&d.addClass("margin-top-186px"),b.find(".noSelected").show(),b.find(".someSelected").hide()):(location.hash.indexOf("cd-new-issue")>-1&&d.addClass("margin-top-160px"),b.find(".noSelected").hide(),b.find(".someSelected").show())}),$(a).on("click",".takeActionPanel--closeLink, .okButton",function(a){var b=$(a.target).closest("table");$(location.hash.indexOf("cd-new-issue")>-1)&&b.find(".takeActionButton").removeClass("openCustomCDLadderPanel"),$(this).closest(".takeActionPanel").hide()}),$(a).on("click",".customCDLadderPanel--closeLink",function(a){$(a.target).closest("table").find(".takeActionButton").removeClass("openCustomCDLadderPanel"),$(this).closest(".customCDLadderPanel").hide()})}function changeSearchBricklet(){"true"==$('#subTabs > ul[class~="tabs"] > li[aria-controls="tbbondfund"] ').attr("aria-selected")?"true"!=$("#searchFundsBtn").attr("aria-selected")&&$("#searchFundsBtn a").trigger("click"):"true"!=$("#searchBondsBtn").attr("aria-selected")&&$("#searchBondsBtn a").trigger("click")}function fiNIopenAnalusis(a,b){var c=document.getElementById("account"),d=c.options[c.selectedIndex];if(""==d.value&&g<1)return alert("Please select Account(s) and Bond(s)."),!1;if(""==d.value)return alert("Please select an account."),!1;var e,f="",g=0;e=""===a?theForm:document.getElementById(a),null==e.cuvalue.length&&e.cuvalue.checked&&(f=e.cuvalue.value,g++);for(var h=0;h<e.cuvalue.length;h++)e.cuvalue[h].checked&&(g>=1&&(f+=","),f+=e.cuvalue[h].value,g++);if(g<1)return alert("Please select bonds."),!1;document.getElementById("account").value=d.value,gotoUrl="/ftgw/fi/FISuitability?account="+d.value+"&checkedCusips="+f+"&bondType=NewIssue&pageName="+document.getElementsByName("name")[0].value,void 0!==b&&"undefined"!=b&&null!=b&&""!=b&&(gotoUrl+="&requestType="+b),popWin(gotoUrl,1024,600,200,150)}function showLearnMore(){var a=location.hash.substring(1),b=$(".learn-more"),c=$(".learn-more--about-cds"),d=$(".exclude-from-learn-more--about-cds");b.show(),0===a.indexOf("tbcds")?(c.show(),d.hide()):(c.hide(),d.show())}function showPopInConfirm(a){var b=$(".loading-indicator--container"),c=b.find(".loading-indicator--modal-overlay-mask"),d=b.find(".login-message-window-wrapper");d.find(".close, .modal-ok").off("click").on("click",function(a){b.hide(),d.hide(),c.hide(),a.preventDefault()}),d.find(".modal-content .login-link").off("click").on("click",a),b.show(),d.show(),c.show()}var initialVal={},placeholderSupportFlag=!0,previewCountInvalid=!1,clickedListId="treasury",screenerForm={contentDivIdsArray:["tbcurrent-yields","tbindividual-bonds","tbcds","tbnewissues","tbannuities","tbbondfund","tbetfs"],savedMarket:"",savedType:{}};const VALID_DATE_FORMAT=new RegExp(/\b\d{1,2}[\//]\d{1,2}[\//]\d{4}\b/),isValidDate=function(a){return VALID_DATE_FORMAT.test(a)};var requestPageHashMappings={FISearchTIPS:"tips",FISearchTreasury:"treasury",FISearchCD:"cd",FISearchAgency:"agency",FISearchMunicipal:"municipal",FISearchHighYield:"corphysec",FISearchCorporate:"corporate",FISearchAcrossOff:"allofferings",FISearchAcrossOffNewIssue:"advoffernew",FISearchCatsTigrs:"advcatstigrs"},referrerCross="",tokenF2=null,openPopup="",listItemCollapsedClass="news-expand-plus",listItemExpandedClass="news-expand-minus",hideDivClass="news-detail-hide",showDivClass="news-detail-show";showDetail=function(a,b){document.getElementById(a).className==listItemCollapsedClass?(document.getElementById(a).alt="Hide",document.getElementById(a).className=listItemExpandedClass,document.getElementById(b).className=showDivClass):(document.getElementById(a).alt="Show",document.getElementById(a).className=listItemCollapsedClass,document.getElementById(b).className=hideDivClass)},Pagination.prototype.nextPage=function(a){if(this.selected<this.links.length-1)return this.changePage(this.selected+1),!1},Pagination.prototype.prevPage=function(a){return this.selected>0?this.changePage(this.selected-1):this.prevLinkBack&&history.go(-1),!1},Pagination.prototype.changePage=function(a){return $(this.links[this.selected]).parent().removeClass("selected"),$(this.pages[this.selected]).addClass("hidden"),this.selected=a,$(this.pages[this.selected]).removeClass("hidden"),$(this.links[this.selected]).parent().addClass("selected"),0===this.selected&&1==this.hideNextPrev?$(this.prevLink).parent().css("display","none"):$(this.prevLink).parent().css("display",""),this.selected===this.links.length-1&&this.nextLink.hasClass("last-next")&&1==this.hideNextPrev?$(this.nextLink).parent().css("display","none"):$(this.nextLink).parent().css("display",""),!1},Pagination.prototype.changePageHandler=function(a){return this.changePage(a.data.pageNum),!1};var IE4Win=-1!=navigator.appVersion.indexOf("MSIE 4")&&-1!=navigator.appVersion.indexOf("Windows"),chatsourceID,changeRecent=function(a){return newtab=$(".time-period #"+a+"tab"),selectedtab=$(".time-period .selected"),newtab[0]!=selectedtab[0]&&($(selectedtab).removeClass("selected"),$(newtab).addClass("selected"),selectedid=selectedtab[0].id,selectedid=selectedid.substring(0,selectedid.length-3),$("#"+selectedid).addClass("hidden"),$("#"+a).removeClass("hidden")),!1},cdtaburl="",firstFlag=!1;$(document).ready(function(){function a(a,b,d){var e=new c;b.style.display="block",b.style.position="absolute",b.style.left=getAbsoluteLeft(a)-b.offsetWidth/2+30+"px",b.style.top=getAbsoluteTop(a)+a.offsetHeight+10+"px",parseInt(b.style.left,10)+b.offsetWidth>e.right&&(b.style.left=e.right-b.offsetWidth-10+"px"),h=a,d&&d.focus()}function b(a){a.style.display="none",h&&h.focus()}function c(){var a=document.height||document.body.offsetHeight,b=document.width||document.body.offsetWidth;return this.left=getScrollXY()[0],this.right=b>getWindowSize()[0]?getWindowSize()[0]+getScrollXY()[0]:b,this.top=getScrollXY()[1],this.bottom=a>getWindowSize()[1]?getWindowSize()[1]+getScrollXY()[1]:a,this}function a(a,b,c){b.style.display="block",b.style.position="absolute",b.style.left=a.offsetLeft-b.offsetWidth/2+30+"px",b.style.top=a.offsetTop+a.offsetHeight+10+"px",parseInt(b.style.left,10)+b.offsetWidth>screen.right&&(b.style.left=screen.right-b.offsetWidth-10+"px"),h=a,c&&c.focus()}function b(a){a.style.display="none",h&&h.focus()}if(initPage(),referrerCross=$("#referrerCrossVal").val(),$("#main-content form").unbind("submit").submit(function(){return!1}),"placeholder"in document.createElement("input")?placeholderSupportFlag=!0:(placeholderSupportFlag=!1,$("input[placeholder],textarea[placeholder]").each(function(){var a=$(this),b=a.attr("placeholder");""===a.val()&&(b=a.attr("placeholder"),a.val(b).addClass("placeholder")),a.focus(function(){b=a.attr("placeholder"),a.val()===b&&a.val("").removeClass("placeholder")}).blur(function(){b=a.attr("placeholder"),""===a.val()&&a.val(b).addClass("placeholder")}).closest("form").submit(function(){b=a.attr("placeholder"),a.val()===b&&a.val("")})})),$.fn.tabIndex=function(){return $(this).parent().find(this).index()-1},$.fn.selectTabByID=function(a){$(this).tabs("option","active",$("#"+a).tabIndex())},$.fn.selectTabByIndex=function(a){$(this).tabs("option","active",a)},location.hash&&location.hash.length>1){var d=location.hash.substring(1),e="";if("tbnewissues"===(e=d.indexOf("%7C")>0?d.split("%7C")[0]:d.split("|")[0])){if($("#subTabs li[aria-controls="+e+"]").find(".ui-tabs-anchor.locked").length>0||-1===document.cookie.indexOf("SC="))return void(window.location=contextPath+"/gotoFIBL/FILanding?tab="+encodeURIComponent(d))}}$("#subTabs, #searchBonds").tabs(),$("#tbcds .linkTabs li a").bind("click",function(){$(this).closest("li").addClass("ui-tabs-active"),$(this).closest("li").addClass("ui-state-active"),$(this).closest("li").siblings().removeClass("ui-tabs-active"),$(this).closest("li").siblings().removeClass("ui-state-active"),1==$(this).closest("li").hasClass("cd-new-issue")?(showRerunForRWV(),$("#tbcds .panel-secondary").removeClass("display-panel"),$("#tbcds .panel-newissue").addClass("display-panel"),$(this).closest("ul").addClass("hidden"),showDisclaimer4NewIssueCDsToggle(),updateCDsNewIssuePanel($("[name='isLogin']").val()),saveFormLayout("tbcds","treasury","cd-new-issue"),cdtaburl=""):1==$(this).closest("li").hasClass("cd-market")&&($("#tbcds .panel-newissue").removeClass("display-panel"),$("#tbcds .panel-secondary").addClass("display-panel"),$(this).closest("ul").removeClass("hidden"),firstFlag||(cdtaburl=""),hideRerunForRWV(),updateCDsSecondaryPanel(cdtaburl),saveFormLayout("tbcds","treasury","cd-market"),$(".disclaimers").hide(),$("#legal-indbonds").show())}),$("#tbnewissues .linkTabs li a").bind("click",function(){$(this).closest("li").addClass("ui-tabs-active"),$(this).closest("li").addClass("ui-state-active"),$(this).closest("li").siblings().removeClass("ui-tabs-active"),$(this).closest("li").siblings().removeClass("ui-state-active"),1==$(this).closest("li").hasClass("new-issue--bond-type")?($("#tbnewissues .panel-new-issue--all-offerings").removeClass("display-panel"),$("#tbnewissues .panel-new-issue--bond-type").addClass("display-panel"),updateNewIssueBondTypePannel(),$(".disclaimers").hide(),$("#legal-issues").show(),saveFormLayout("tbnewissues",null,"bond-type")):1==$(this).closest("li").hasClass("new-issue--all-offerings")&&($("#tbnewissues .panel-new-issue--bond-type").removeClass("display-panel"),$("#tbnewissues .panel-new-issue--all-offerings").addClass("display-panel"),updateNewIssueAllOfferingsPannel(),$(".disclaimers").hide(),$("#legal-issues").show(),saveFormLayout("tbnewissues",null,"all-offerings"))}),$("#tbcurrent-yields").on("click"," .linkTabs li a",function(){$(this).closest("li").addClass("ui-tabs-active"),$(this).closest("li").addClass("ui-state-active"),$(this).closest("li").siblings().removeClass("ui-tabs-active"),$(this).closest("li").siblings().removeClass("ui-state-active"),1==$(this).closest("li").hasClass("yields--highest-yield")?($("#tbcurrent-yields .medianYields").hide(),$("#tbcurrent-yields .highestYields").show(),saveFormLayout("tbcurrent-yields",null,"highest-yield")):1==$(this).closest("li").hasClass("yields--median-yield")&&($("#tbcurrent-yields .highestYields").hide(),$("#tbcurrent-yields .medianYields").show(),saveFormLayout("tbcurrent-yields",null,"median-yield"))}),$("#tbcurrent-yields").on("click","a.popup-link-yieldTable",function(a){var b=$("#tbcurrent-yields ul li.yields--highest-yield").hasClass("ui-tabs-active"),c="/ftgw/fi/FIYieldTable?popupMode=Y";c+=b?"&yldTabSelected=H":"&yldTabSelected=M",popWin(c,870,605,60,60)}),initSubtabs(),$("#CusipDropdown").selectmenu({width:"100%",appendTo:"#selectGroup"}),$("#CusipDropdown-menu").css("height","auto"),$("#selectGroup select optgroup option").attr("selected",!1),$("#selectGroup select optgroup option[class='change-cusip']").attr("selected",!0),null!==$("#selectGroup span a .ui-selectmenu-status").text()&&""===$("#selectGroup span a .ui-selectmenu-status").text()&&$("#selectGroup span a .ui-selectmenu-status").text("CUSIP");var f=$("#bondSearchField");if(f.attr("maxlength","9"),$(".update-text").text("by CUSIP"),!placeholderSupportFlag){var g=f.attr("placeholder");null===f.val()&&""===f.val()&&f.val(g).addClass("placeholder")}$("#saveSearchDrop").selectmenu({width:"100%",appendTo:"#savedSearch",positionOptions:{my:"right+0 top-1",at:"right bottom"}}),$("#saveBondLadderDrop").selectmenu({width:"100%",appendTo:"#savedBondLadder",positionOptions:{my:"right+0 top-1",at:"right bottom"}}),$(".takeActionDrop").selectmenu({width:"75%",menuWidth:"75%"}),$("#newIssuesAccordion .accordionTitle").click(function(){return $(this).find(".accord").toggleClass("accordion-icons accordion-icon-active"),$(this).next(".accordionContent").slideToggle(),!1}),$("#tbcds").on("click","a.attributes-legend-title",function(a){var b=$("#tbcds a.attributes-legend-title");b.hasClass("collapse-sign")?(b.removeClass("collapse-sign"),b.addClass("expand-sign")):(b.removeClass("expand-sign"),b.addClass("collapse-sign")),$('#tbcds #attributesLegend div[role="list"]').toggle()}),initTakeAction("#tbnewissues"),initTakeAction("#tbcds"),$("#CusipDropdown").on("change",function(){var a=$(this),b=a.val(),c="",d="",e=$("#findBondsForm .searchBox .action-button--small"),f=e.find(".locked");if(""==b?(f.length>0&&(e.addClass("login-required"),f.show()),c="by CUSIP",d="Enter CUSIP number",$("#bondSearchField").attr("maxlength","9")):(f.length>0&&(e.removeClass("login-required"),f.hide()),$("#bondSearchField").attr("maxlength","16"),"AGENCY"==b?(c="Agency/GSE Bonds",d="Enter bond name"):"CD"==b?(c="CDs",d="Enter CD name"):"CORP"==b?(c="Corporate Bonds",d="Enter bond name"):"MUNI"==b&&(c="Municipal Bonds",d="Enter bond name")),$(".update-text").text(c),$("#bondSearchField").attr("placeholder",d),$("#bondSearchField").val(""),!placeholderSupportFlag){var g=$("#bondSearchField");text=g.attr("placeholder"),g.val(text).addClass("placeholder")}});var h;$(".contextual-help-link").each(function(c,d){var e=d.href.indexOf("#");if(-1!=e){var f=d.href.substring(e+1),g=$("#"+f),h=$(g).parent().parent();$(g).css("display","block");var i=$(".contextual-help-focus",h)[0];$(d).bind("click",function(b){a(d,h[0],i),b.preventDefault()}),$(".contextual-help-close-link",h).bind("click",function(a){b(h[0]),a.preventDefault()})}}),"undefined"==typeof isMember&&(isMember=!1),-1==document.cookie.indexOf("SC=")||isMember?($("#savedSearchLoginLink").removeClass("hidden"),$("#savedSearchLabel").text("Log in to View Searches"),$("#searches option:first-child").text("Log in to View Searches")):($("#savedSearchLabel").text("Select Your Option"),$("#searches option:first-child").text("Select Your Option"),$("#savedSearchButton").removeAttr("disabled"),"undefined"!=typeof savedSearchesMap&&savedSearchesMap&&$.each(savedSearchesMap,function(a,b){var c=$("<option/>",{value:b,text:a});$("#searches").append(c)})),$("#saved_searches").click(function(a){var b=$(".saved-searches-table tr").length;$(".flyout-wrapper").hasClass("login-required")?($("#saved_searches_box_alert").toggle(),$("#saved_searches_box_alert").is(":visible")?($(this).addClass("selected"),$("#saved_searches .off-screen").text("Menu open, click to close")):($(this).removeClass("selected"),$("#saved_searches .off-screen").text("Menu closed, click to open"))):($("#saved_searches_box").toggle(),$("#saved_searches_box").is(":visible")?(b>5?($("#content_1").addClass("widget-height"),$(".mCustomScrollBox").is(":visible")||$("#content_1").mCustomScrollbar(),$("#flyout-data .mCSB_scrollTools").css("display","block")):$("#content_1").removeClass("widget-height"),$(this).addClass("selected"),$("#saved_searches .off-screen").text("Menu open, click to close")):($(this).removeClass("selected"),$("#saved_searches .off-screen").text("Menu closed, click to open")),$(".mCSB_container").removeClass("mCS_no_scrollbar")),$(".saved-searches-table a:first").focus(),a.stopPropagation(),$("#saved_searches_box_alert").is(":visible")||$("#saved_searches_box").is(":visible")?($(this).removeClass("downArrow").addClass("reverseArrow"),$(document).one("click",function(a){resetElements()})):$(this).removeClass("reverseArrow").addClass("downArrow")}),$("#saved_searches, #saved_searches_box, #saved_searches_box_alert").click(function(a){a.stopPropagation()}),$(document).on("TMS_Trigger",function(a,b){}),changeSearchBricklet(),FixedIncome.initNewIssueBondType(),FixedIncome.initialCalendar(),FixedIncome.toggleAttrsBox(),FixedIncome.savedSearch(),FixedIncome.initMultiSelInput(),FixedIncome.initSolrMatchResultQ(),FixedIncome.initAdvBasic4IndividualTab(),FixedIncome.TreasTypeChange(),FixedIncome.callIndChange(),FixedIncome.callAbleChange(),$(".twoLineItmes").each(function(a,b){var c=$(this).find(":hidden").attr("name");$(this).find("h3").text(c),"Economic"!=c?$(this).find("ul li:gt(1)").remove():$(this).find("ul:gt(0)").find("li:gt(1)").remove(),$(this).removeClass("twoLineItmes")}),$(".latest-list li").each(function(a,b){var c=$(this).find(".source:eq(0)");c.prepend("<span>BY </span>");var d=c.next(".source");d.removeClass("source").text(" "+d.text()).appendTo(c)}),$(".source").each(function(){$(this).addClass("timestamp")}),$(".podcast-bricklet").each(function(a,b){0==a?$(this).children().first().replaceWith("<h5>Municipal</h5>"):$(this).children().first().replaceWith("<h5>Corporate</h5>")}),$(".researchReports h3").each(function(a,b){if(!isAuthorized){var c="/",d=$("<img/>",{alt:"Log in required",title:"Log in required",src:fiContentUrl+c+"img/lock_grey.png",height:12,width:9}),e=$("<span class='auto-padlock'></span>").html(d);$(b).append(e)}}),$(".contextual-help-link").each(function(c,d){var e=d.href.indexOf("#");if(-1!=e){var f=d.href.substring(e+1),g=$("#"+f),h=$(g).parent().parent();$(g).css("display","block");var i=$(".contextual-help-focus",h)[0];$(d).bind("click",function(b){a(d,h[0],i),b.preventDefault()}),$(".contextual-help-close-link",h).bind("click",function(a){b(h[0]),a.preventDefault()})}}),$(".municipal-report").find("a[name='top']").remove();var h=null;showLearnMore(),$(document).ajaxError(function(a,b,c,d){if(FixedIncome.isSessionTimeout(b)){var e=location.hash.substring(1),f="";e.length>0&&(f=encodeURIComponent("?tab="+e)),-1!=e.indexOf("tbcds")?updateCDsNewIssuePanel(!1):window.location.href="/ftgw/fi/gotoFIBL/FILanding"+f}})}),$.browser.chrome=/chrome/.test(navigator.userAgent.toLowerCase()),fontControl={adjustFont:function(a,b,c){var d=null,e=null,f=null,g=null;try{if(d=b,e=c,f=a,null==typeof d||"undefined"==d||null==typeof e||"undefined"==e||null==typeof f||"undefined"==f)return!1;if(null==typeof(g=document.getElementById(d))||"undefined"==g)return!1;g.style.fontSize=e+"px",fontControl.changeAnchorText(f)}catch(a){}},changeAnchorText:function(a){var b=new Array;b[0]=document.getElementById("txt0"),b[1]=document.getElementById("txt1"),b[2]=document.getElementById("txt2");for(var c=0;c<b.length;c++){if(void 0===b[c]||null==b[c])return!1;b[c].id==a?b[c].className=a+" active":b[c].className=b[c].id}}};var searchValueCount=0,triggerChangeFlag=!1,checkedAllMapping={statecode:!1,subPaymentMonth:!1,use:!1,sector:!1},editFlag=!1,overlay=null,overlayHTML=null;$(".previewBondCount .question").click(function(){$("#suitability-layer").css("top",$(this).offset().top-90+"px"),$("#suitability-layer").css("left",$(this).offset().left-460+"px"),$("#popup-layer-component").show()});var sourceID,timeoutID=0,flag=!0,anchorCss="{color:#0F57C2;text-decoration:none;font-family:arial, helvetica, sans-serif} :visited{color:#800080;text-decoration:none} :active, :focus{color:#E74B00;text-decoration:underline} :hover{text-decoration:underline}",IE4Win=-1!=navigator.appVersion.indexOf("MSIE 4")&&-1!=navigator.appVersion.indexOf("Windows"),infowindowME;$("html").click(function(a){var b=$(".multi-select-dropdown:visible");if(b.length>0){for(var c=!!b.next(".error-msg").is(":visible"),d=b.find(":checked"),e=initialVal[2],f=d.length,g=!1,h=0;h<f;h++)if(d.eq(h).attr("id")!==e.eq(h).attr("id")){g=!0;break}c||"advOffersNew"===b.closest("form").attr("id")||initialVal[0]===b.prev("input").val()&&initialVal[1]===f&&!g||getBondCountFromSolr(b.closest("form").attr("id")),b.hide()}}),$("body").keyup(function(a){if(27==a.which){resetElements(),completedSaveSearch(),$("#calendar").addClass("hidden");var b=$(".multi-select-dropdown:visible");if(b.length>0){for(var c=!!b.next(".error-msg").is(":visible"),d=b.find(":checked"),e=initialVal[2],f=d.length,g=!1,h=0;h<f;h++)if(d.eq(h).attr("id")!==e.eq(h).attr("id")){g=!0;break}c||"advOffersNew"===b.closest("form").attr("id")||initialVal[0]===b.prev("input").val()&&initialVal[1]===f&&!g||getBondCountFromSolr(b.closest("form").attr("id")),b.hide()}}}),function(a,b){b.initNewIssueBondType=function(){a("#tbnewissues").on("click",".expand-collapse--question a.expand-collapse--head",function(c){var d="-";a(this).toggleClass("expand-collapse--fancyexpand expand-collapse--fancycollapse"),a(this).attr("aria-expanded",function(a,b){return"false"===b?"true":"true"===b?"false":b}),a(this).siblings().toggleClass("bond-type--block");var e="",f=new Array;if(a("#tbnewissues #viewAllOfferings ul.expand-collapse--list li").each(function(c){var d=a(this);if(d.find(".by-type-block.bond-type--block").length>0){var e=b.newIssuesTab.ABBR_ARRAY[a.inArray(d.attr("id"),b.newIssuesTab.LI_ID_ARRAY)];f.push(e)}}),0==f.length)e=d;else{e=f[0];for(var g=1;g<f.length;g++)e+=d+f[g]}saveFormLayout("tbnewissues","bond-type",null,null,e)})}}(jQuery,window.FixedIncome=window.FixedIncome||{}),function(a,b){b.toggleAttrsBox=function(){a(".income-products").on("click",".toggle-attr-link",function(b){a(this).prev(".additional-attributes-box").toggle();var c=a(this).closest("form").attr("id");return a(this).prev().is(":visible")?(a(this).addClass("expanded").text("Show fewer criteria"),a("#"+c+" .additional-attributes-box a,#"+c+" .additional-attributes-box button,#"+c+" .additional-attributes-box input,#"+c+" .additional-attributes-box select").each(function(){a(this).attr("tabIndex","0")})):(a(this).removeClass("expanded").text("Show more criteria"),a("#"+c+" .additional-attributes-box a,#"+c+" .additional-attributes-box button,#"+c+" .additional-attributes-box input,#"+c+" .additional-attributes-box select").each(function(){a(this).attr("tabIndex","-1")})),!1})}}(jQuery,window.FixedIncome=window.FixedIncome||{}),function(a,b){var c;b.initialCalendar=function(){var b=a("body");b.on("click",".calButton",function(b){addUniqueClass(a(".cal_error_msg"),"none"),a(".month li a").removeClass("select"),a(".year li a").removeClass("select"),a("#calendar").addClass("hidden").removeClass("hidden");var d=a(this).position();c=a(this).prev("input"),a("#calendar").css("left",d.left+23).css("top",d.top)}),b.on("keypress",".calButton",function(b){addUniqueClass(a(".cal_error_msg"),"none"),a(".month li a").removeClass("select"),a(".year li a").removeClass("select"),a("#calendar").addClass("hidden").removeClass("hidden");var d=a(this).position();c=a(this).prev("input"),a("#calendar").css("left",d.left+23).css("top",d.top),a(".month li a:first").focus()}),b.on("click",".month li a",function(b){a(".month li a").removeClass("select"),a(this).addClass("select").attr("aria-pressed","true")}),b.on("click",".year li a",function(b){a(".year li a").removeClass("select"),a(this).addClass("select").attr("aria-pressed","true")}),b.on("click",".button",function(b){if(""!=a(".year li a.select").text()&&a(".month li a.select").text()){a("#calendar").addClass("hidden"),addUniqueClass(a(".cal_error_msg"),"none");var d=a(".month li a.select").attr("name")+"/"+a(".year li a.select").text(),e=c.val()!==d;c.val(d),validateMaturityDate(document.getElementById(c.attr("id")))&&(c.parent().children("div.label-wrap").removeClass("error"),c.parent().children("div.error-msg").addClass("none"),e&&getBondCountFromSolr(c.parents("form").attr("id")))}else a(".cal_error_msg").removeClass("none")}),b.on("click",".cancel",function(){a("#calendar").addClass("hidden"),addUniqueClass(a(".cal_error_msg"),"none")}),b.on("click","#next",function(){var b=a(".year-page .active:eq(0)").attr("id"),c=a(".year-page .active:eq(1)").attr("id");null!=a("#"+c).next().val()&&(a("#"+b).addClass("hidden"),a("#"+b).removeClass("active"),a("#"+c).next().removeClass("hidden"),a("#"+c).next().addClass("active"))}),b.on("click","#prev",function(){var b=a(".year-page .active:eq(0)").attr("id"),c=a(".year-page .active:eq(1)").attr("id");null!=a("#"+b).prev().val()&&(a("#"+c).addClass("hidden"),a("#"+c).removeClass("active"),a("#"+b).prev().removeClass("hidden"),a("#"+b).prev().addClass("active"))})}}(jQuery,window.FixedIncome=window.FixedIncome||{}),function(a,b){b.savedSearch=function(){var b=a("body");b.on("click","#popUpTrigger_SaveSearch",function(){return showModal("#modelPopUp_SaveSearch"),a("#modelPopUp_SaveSearch").show(),!1}),b.on("click","#cancelSaveSearch",function(){a("#modelPopUp_SaveSearch").hide(),a("#mask").hide(),a(".modal-window-wrapper").hide(),a(".alert-new-bonds").show()}),b.on("click","#buttonSaveSearch",function(){for(var b="@#%^&*()+=[]\\';,/{}|\":<>~`",c="<p>You have entered an invalid character in your search title. Invalid characters include '_', '*', or '_*.</p><p>Please rename your search and save again.</p>",d=0;d<a("#searchName").val().length;d++)if(-1!=b.indexOf(a("#searchName").val().charAt(d)))return a("#searchName").addClass("error-bdr"),a("#invalidSearchNameBox").show(),a("#invalidSearchNameBox").html(c),a("#searchName").focus(),a("#searchName").val(""),!1;if(""==a("#searchName").val())a("#searchName").addClass("error-bdr"),a("#invalidSearchNameBox").show(),a("#invalidSearchNameBox").html("<p>Please Enter Search Criteria</p>");else{a("#searchName").removeClass("error-bdr"),a("#searchNameBox").hide(),a("#invalidSearchNameBox").hide(),a("#saveSearchWindowButtonsBox").hide();var e=a("#searchName").val();a("#validSearchNameBox p strong").append(e),a("#validSearchNameBox").show(),a(".alert-new-bonds").hide(),a("#closeWindowButtonsBox").show()}}),b.on("click","#closeWindowButtonsBox input",function(){completedSaveSearch()}),b.on("click",".modal-window .close",function(){completedSaveSearch()}),b.on("click",".modal-window .modal-ok",function(){a("#mask").hide(),a(".modal-window-wrapper").hide(),a(".modal-window").hide(),a(".alert-new-bonds").show()})}}(jQuery,window.FixedIncome=window.FixedIncome||{}),function(a,b){b.initMultiSelInput=function(){var b=a("body");b.on("click",".findbondscds-individual--bonds .multi-select-input",function(b){b.stopPropagation();var c=a(this).position().left,d=a(this).position().top+a(this).outerHeight();a(this).next(".multi-select-dropdown").css({top:d,left:c}),inputLenght=a(this).next(".multi-select-dropdown").children("input").length,inputLenght>14&&a(this).next(".multi-select-dropdown").css({height:"300px","overflow-y":"auto"}),a(".multi-select-dropdown").not(a(this).next(".multi-select-dropdown")).hide(),a(this).next(".multi-select-dropdown").toggle();var e=a(this).next(".multi-select-dropdown").children("input:checked");initialVal=[a(this).val(),e.length,e],"advCorpInvGradeSec"==b.target.form.id&&a("#advCorpInvGradeSec_sectorNoCountMsg").addClass("none")}),b.on("keydown",".findbondscds-individual--bonds .multi-select-input",function(b){if(13==b.keyCode||13==b.charCode){b.stopPropagation();var c=a(this).offset().left,d=a(this).offset().top+a(this).outerHeight();a(this).next(".multi-select-dropdown").css({top:d,left:c}),inputLenght=a(this).next(".multi-select-dropdown").children("input").length,inputLenght>14&&a(this).next(".multi-select-dropdown").css({height:"300px","overflow-y":"auto"}),a(this).next(".multi-select-dropdown").toggle();var e=a(this).next(".multi-select-dropdown").children("input:checked");initialVal=[a(this).val(),e.length,e]}})}}(jQuery,window.FixedIncome=window.FixedIncome||{}),function(a,b){b.initSolrMatchResultQ=function(){a("body").on("click",".income-products .matchingResults .question",function(b){var c=a(this).next(".suitability-layer");c.is(":visible")?c.hide():(c.find(".errorcontent").html(a(".resulthandling .inline_result").html()),c.show()),b.stopPropagation(),a(document).one("click",function(a){c.hide()})})}}(jQuery,window.FixedIncome=window.FixedIncome||{}),function(a,b){b.initAdvBasic4IndividualTab=function(){var b=a("body");b.on("click",".findbondscds-individual--bonds .show-advanced a",function(){return a(this).parents(".field-box01").hide(),a(this).parents(".field-box01").next().show(),!1}),b.on("click",".findbondscds-individual--bonds .show-basic a",function(){return a(this).parents(".field-box01").hide(),a(this).parents(".field-box01").prev().show(),!1})}}(jQuery,window.FixedIncome=window.FixedIncome||{}),function(a,b){b.initAdvBasic4IndividualTab=function(){var b=a("body");b.on("click",".findbondscds-individual--bonds .show-advanced a",function(){return a(this).parents(".field-box01").hide(),a(this).parents(".field-box01").next().show(),!1}),b.on("click",".findbondscds-individual--bonds .show-basic a",function(){return a(this).parents(".field-box01").hide(),a(this).parents(".field-box01").prev().show(),!1})}}(jQuery,window.FixedIncome=window.FixedIncome||{}),function(a,b){b.TreasTypeChange=function(){a("body").on("change","#usTreasSec_type",function(){animatedWaitCreate(),triggerChangeFlag=!0,getMinMax(a(this).parents("form").attr("id"),!0,null,"treasatype")})}}(jQuery,window.FixedIncome=window.FixedIncome||{}),function(a,b){b.callIndChange=function(){a("body").on("change",'.income-products select[name="callind"]',function(b,c){var d=a(this).val(),e=a(this).parents(".attr-section").last().find("select[name='callable']");"NO"==d&&(e.val("N").attr("disabled","disabled"),e.prev().addClass("greyout")),"NO"!=d&&1==e.prop("disabled")&&(e.val("").removeAttr("disabled"),e.prev().removeClass("greyout")),c||getBondCountFromSolr(a(this).closest("form").attr("id"))})}}(jQuery,window.FixedIncome=window.FixedIncome||{}),function(a,b){b.callAbleChange=function(){a("body").on("change",'.findbondscds-individual--bonds select[name="callable"]',function(b,c){var d=a(this).val(),e=a(this).parents(".attr-section").last().find("select[name='callind']");"Y"==d&&(e.val("YES").attr("disabled","disabled"),e.prev().addClass("greyout")),"Y"!=d&&1==e.prop("disabled")&&(e.val("").removeAttr("disabled"),e.prev().removeClass("greyout")),c||getBondCountFromSolr(a(this).closest("form").attr("id"))})}}(jQuery,window.FixedIncome=window.FixedIncome||{}),function(a,b){var c=["newIssuestheForm_treasByType","newIssuestheForm_cdByType","newIssuestheForm_agencyByType","newIssuestheForm_corpByType","newIssuestheForm_muniByType"];b.isInNewIssueTypeArray=function(a){return jQuery.inArray(a,c)},b.hidePopupScoreCard4NIBondType=function(a){var d=b.isInNewIssueTypeArray(a);-1!=d&&jQuery.each(c,function(a,b){if(a!=d&&0!=jQuery("#"+b).length){var c="popup-layer-component",e=jQuery("#"+b).parent();void 0!=e&&""!=e&&null!=e&&0!=e.find("#"+c)&&e.find("#"+c).hide()}})}}(jQuery,window.FixedIncome=window.FixedIncome||{}),function(a,b){b.gotoFILandingTab=function(a,b,c,d){var e;"tbindividual-bonds"===a&&(e=a+"|"+c),window.location=contextPath+"/FILanding?tab="+encodeURIComponent(e)}}(jQuery,window.FixedIncome=window.FixedIncome||{}),function(a,b){b.isSessionTimeout=function(a){return 500==a.status&&a.responseText.indexOf("timeoutMsg")>-1&&a.responseText.indexOf("Your session has expired")>-1}}(jQuery,window.FixedIncome=window.FixedIncome||{}),function(a,b){b.newIssuesTab={ABBR_ARRAY:["te","cd","ag","cp","mu"],LI_ID_ARRAY:["treasByType","cdByType","agencyByType","corpByType","muniByType"],openAccordions:function(c){if(void 0==c||null==c);else if(a("#tbnewissues #viewAllOfferings #muniByType a.expand-collapse--head").click(),"-"===c);else{var d=c.split("-");a.each(d,function(c,d){var e=b.newIssuesTab.LI_ID_ARRAY[a.inArray(d,b.newIssuesTab.ABBR_ARRAY)];a("#tbnewissues #viewAllOfferings #"+e+" a.expand-collapse--head").click()})}}}}(jQuery,window.FixedIncome=window.FixedIncome||{}),function(a,b){b.HttpTask=function(b){this.options=b||{},this.data=this.options.data||{},this.context=b.context,this.canLoading=!0===b.isLoading&&null!=this.context&&null!=this.context.showLoading,this.$=a,this.onPreExecute=b.onPreExecute,this.onProgress=b.onProgress,this.onSuccess=b.onSuccess,this.onError=b.onError,this.onComplete=b.onComplete,this.initialize(this.options)},b.HttpTask.prototype={initialize:function(a){},buildParams:function(a){return a},run:function(){var b=this;return b.onPreExecute&&b.onPreExecute.call(b.context),b.onProgress&&b.onProgress.call(b.context),b.canLoading&&b.context.showLoading(),a.ajax({url:b.url,dataType:b.dataType||"html",type:b.type||"GET",data:b.buildParams(b.data),contentType:b.contentType||"application/x-www-form-urlencoded; charset=UTF-8",xhrFields:{withCredentials:!0},success:function(a){b.onSuccess&&b.onSuccess.call(b.context,a)},error:function(a,c,d){b.onError&&b.onError.call(b.context,a,c,d)},complete:function(){b.canLoading&&b.context.hideLoading(),b.onComplete&&b.onComplete.call(b.context)}})}},b.HttpTask.extend=Backbone.Model.extend}(jQuery,window.FixedIncome=window.FixedIncome||{}),function(a,b){b.PreviewCountTask=b.HttpTask.extend({url:"/fundscreener/api/match/v1/filtercriteria/totalcount",dataType:"json",type:"POST",contentType:"application/json",buildParams:function(a){return JSON.stringify(a)}})}(jQuery,window.FixedIncome=window.FixedIncome||{}),function(a,b){b.MFEDisclosureTask=b.HttpTask.extend({url:"/fundscreener/api/disclosure/v1/datavalue/Retail-MARKITMFE",dataType:"json",type:"GET",buildParams:function(){return{}}})}(jQuery,window.FixedIncome=window.FixedIncome||{}),function(a,b){b.MFEFundTypesTask=b.HttpTask.extend({url:"/fundscreener/api/classification/v1/assetclassesandcategories",dataType:"json",type:"GET",buildParams:function(){return{}}})}(jQuery,window.FixedIncome=window.FixedIncome||{}),function(a,b){b.MFEAvalTask=b.HttpTask.extend({url:"/fundscreener/api/disclosure/v1/application/Retail-MARKITMFE",dataType:"json",type:"GET",buildParams:function(){return{}}})}(jQuery,window.FixedIncome=window.FixedIncome||{}),function(a,b){b.MFEPreCountParam=Backbone.Model.extend({defaults:{openToNewInvestors:"OPEN",ntf:"Y",includeLeveragedFunds:"N",includeInverseFunds:"N",assetClass:"MBND,TBND",businessChannel:"RETAIL"}})}(jQuery,window.FixedIncome=window.FixedIncome||{}),function(a,b){b.FundsSearchBottomView=Backbone.View.extend({events:{"click button#see-results-button":"seeResultsAction","refresh ":"loadData","click #learn-more-link":"showLearnMore","keyup #learn-more-link":"showLearnMoreShortcut","click #learn-more .close":"hideLearnMore"},initialize:function(b){_.bindAll(this,"render","loadData","seeResultsAction","refreshPreCount","showLearnMore","showLearnMoreShortcut","hideLearnMore","renderLearMore"),this.model.on("change",this.refreshPreCount,this),this.previewCountDeferred=this.loadData(!0),this.$el.find("#learn-more").draggable({handle:"h2",cursor:"move",containment:"html"}).css("position","absolute"),a.when(b.aValDeferred).done(this.renderLearMore)},showLearnMoreShortcut:function(a){32==a.keyCode||13==a.keyCode?this.showLearnMore(a):27==a.keyCode&&this.hideLearnMore(a)},showLearnMore:function(b){return b.preventDefault(),a("#learn-more").show(),a("#readonly").show(),!1},hideLearnMore:function(b){return b.preventDefault(),a("#learn-more").hide(),a("#readonly").hide(),!1},isExist:function(a){var b=!0;return void 0!==a&&"error"!==a.status||(b=!1),b},showWarningMsg:function(){var b=a("#search-panel");b.height();a("#warning").css({height:b}).html('<div class="warning" id="alert_warning">Fidelity is unable to provide the information that you requested at this time. This may be due to scheduled system maintenance or an intermittent outage.<br />Please refresh your page or retry your request at a later time.</div>').show(),b.remove(),a("#search-bottom").empty(),a("#disclosure").empty(),a("#bondfund input:button").attr("disabled","disabled")},renderLearMore:function(b){var c=this;void 0!=b&&void 0!=b[0]&&void 0!=b[0].disclosures&&a.each(b[0].disclosures[0].sectionCodes,function(b,d){if("MFELAND"==d.code){var e=d.disclosureList;a.each(e,function(a,b){"MFE Learn More"==b.code&&c.$el.find("#learn-more .scrollable-section").html(b.text)})}})},loadData:function(a){var c=this;return new b.PreviewCountTask({context:this,data:c.model.toJSON(),onPreExecute:function(){b.bodyView.animatedWaitCreate(),c.$el.find(".fund-count .count").hide(),c.$el.find(".fund-count .waiting-indicator").show()},onSuccess:function(a){c.responseData=a;var b="--";c.isExist(c.responseData)?b=c.responseData.totalCount:c.showWarningMsg(),c.$el.find(".fund-count .count").text(b)},onError:function(a,d,e){c.showWarningMsg(),b.bodyView.animatedWaitDestroy()},onComplete:function(){c.$el.find(".fund-count .waiting-indicator").hide(),c.$el.find(".fund-count .count").show(),a||b.bodyView.animatedWaitDestroy()}}).run()},seeResultsAction:function(){var b=this.model.attributes,c={},d=["$FundType"];for(var e in b)if(b[e]!==this.model.defaults[e]||"ntf"==e)if("assetClass"!==e&&"category"!==e)c[e]=b[e],"mStarRating"===e&&d.push("$MorningstarRatings"),"returns"===e&&d.push("$Returns"),"expenses"===e&&d.push("$Expenses");else if("assetClass"===e){var f=b[e],g=b.category,h="";if(g){var i=g.split(",");i.length>0?(a.each(i,function(a,b){h+=b+","}),h=h.substring(0,h.length-1)):h+=g}else"MBND"===f?h="MJ,MI,HM,MP,MY,MT,MO,SI,SS,SM,MC,SL,MN,MF,MS,ML,MM":"TBND"===f&&(h="HY,GL,EB,CL,MU,IP,GI,RR,CS,CI,BL,TW,GS,UB,NT,WH,PI,XP,IB");c.category=h}c.category||(c.category="MJ,MI,HM,MP,MY,MT,MO,SI,SS,SM,MC,SL,MN,MF,MS,ML,MM,HY,GL,EB,CL,MU,IP,GI,RR,CS,CI,BL,TW,GS,UB,NT,WH,PI,XP,IB"),c.expand=d.join(",");var j=a.param(c);resultsPage=fundresearch_url+"fund-screener/results/table/overview/averageAnnualReturnsYear3/desc/1?"+j,window.location=resultsPage},refreshPreCount:function(){this.loadData(!1)}})}(jQuery,window.FixedIncome=window.FixedIncome||{}),function(a,b){b.FundsSearchMiddleFilter=Backbone.View.extend({events:{"click ul li .checkbox-div input":"filterFunds"},nameToValForSelectedMap:{fidelityFundOnly:"F",fundPicks:"Y",ntf:"Y"},initialize:function(){_.bindAll(this,"filterFunds")},filterFunds:function(b){var c=a(b.target),d=b.target.name;c.prop("checked")?this.model.set(d,this.nameToValForSelectedMap[d]):this.model.unset(d)}})}(jQuery,window.FixedIncome=window.FixedIncome||{}),function(a,b){b.FundsSearchSelectTypeView=Backbone.View.extend({events:{"click .selectbox-1 a":"toggleAssetClassDropdown","keydown .selectbox-1 a":"toggleAssetClassDropdown","mouseover .asset-list ul li ":"highlightAssetClass","click #assetList li ":"selectOneAssetClass","click .grey-area":"stopPropagationAndPreventDefault","click #risk-distribution-link":"displayRiskDistribution","click #cat-risk-dist .close":"closeRiskDistribution","keydown #cat-risk-dist .close":"closeRiskDistribution","keydown .asset-overlay #assetList li":"reactToKeydownForAssetClassDropdown","click .cat-select a":"toggleCategoryDropdown","keydown .cat-select a":"toggleCategoryDropdown","click #category-list li ":"selectOneCategory","click .category-overlay .all-categories input":"toggleAllCats","click .category-overlay .all-categories":"stopPropagation","mouseover .category-list li":"toggleCatToolip","mouseout .category-list li":"toggleCatToolip","click #category-list a#more-on-risk-link":"displayMoreOnRisk","click #cat-more-on-risk .close":"closeMoreOnRisk","keydown .category-overlay .all-categories input":"reactToKeydownForCategoryDropdown","keydown #category-list a#more-on-risk-link":"reactToKeydownForCategoryDropdown","keydown #category-list li input":"reactToKeydownForCategoryDropdown"},initialize:function(){_.bindAll(this,"renderAssetClassDropDown","renderCategoryDropdown","renderMoreOnRisk","loadData","toggleAssetClassDropdown","highlightAssetClass","selectOneAssetClass","stopPropagationAndPreventDefault","stopPropagation","displayRiskDistribution","closeRiskDistribution","reactToKeydownForAssetClassDropdown","toggleCategoryDropdown","selectOneCategory","toggleAllCats","toggleCatToolip","displayMoreOnRisk","reactToKeydownForCategoryDropdown"),this.fundtypeDeferred=this.loadData()},renderAssetClassDropDown:function(){var b=this.respDataForMFEDisclosure,c=this;if(void 0!==b[0].disclosures){a.each(this.assetClassArray,function(d,e){var f="<li aria-owns='"+d+"_class' tabindex='0' role='option' id='"+e.id+"'>"+e.name+"</li>";c.$el.find("#assetOverlay .asset-list #assetList").append(f);var g=null,h=b[0].disclosures[0].entities;a.each(h,function(b,c){"ASET_CLASS_X"==c.entityName&&(dataList=c.sectionCodes[0].disclosureList,a.each(dataList,function(a,b){("Mstar Taxable Bond Desc"===b.code&&"TBND"===e.id||"Mstar Municipal Bond Desc"===b.code&&"MBND"===e.id||"Mstar All Asset Classes Desc"===b.code&&"ALL"===e.id)&&(g=b.text)}))});var i="<div aria-live='assertive' id='"+d+"_class' style='display:none' tabindex=-1> <aside><div class='asset-content'>"+g+"</div></aside></div>";c.$el.find("#assetOverlay .grey-area").append(i)}),c.$el.find("#assetOverlay .asset-list #assetList #ALL").addClass("selected focused"),c.$el.find("#assetOverlay .grey-area #0_class .asset-content b").text("All Bond Asset Classes");c.$el.find("#assetOverlay .grey-area #0_class .asset-content").append("<p>The All Bond Asset Classes selection includes both Municipal Bond and Taxable Bond asset classes as defined by Morningstar.</p>"),c.$el.find("#assetOverlay .grey-area #0_class").show()}},allItemsArrayInCategoryDropdown:null,renderCategoryDropdown:function(b){var c=this;if(this.$el.find(".frm-category #selcat .cat-select a").text("All Categories"),"All Bond Asset Classes"==b)this.$el.find(".frm-category #frm-category-mask").show(),this.allItemsArrayInCategoryDropdown=null,this.model.set({assetClass:"MBND,TBND"});else{c.$el.find(".category-overlay .category-list ul").empty();var d=null;void 0!=this.respDataForMFEFundType&&a.each(this.assetClassArray,function(e,f){if(b==f.name){d=f.id,c.model.set({assetClass:d}),c.$el.find(".category-overlay .all-categories input").attr("value",d);var g=c.respDataForMFEFundType;a.each(g,function(b,e){if(e.code==d){var f=e.categories;if("[object Array]"===Object.prototype.toString.call(f)){f.length>0&&(c.$el.find(".category-overlay .all-categories input").removeAttr("disabled"),c.$el.find(".category-overlay .all-categories lable").text("All Categories"),c.$el.find(".category-overlay .all-categories input").attr("checked",!0));for(var g=0;g<f.length;g++){var h=f[g],i=a('<li role="option"><input name="category" type="checkbox"/><label></label></li>');i.attr("id",h.code+"0"),i.find("input").attr("id",h.code).attr("value",d),i.find("label").attr("for",h.code).text(h.description),c.$el.find(".category-overlay .category-list ul").append(i)}}}}),c.$el.find(".category-overlay .category-list ul").append('<div class="clear-both"></div>')}}),this.$el.find(".frm-category #frm-category-mask").hide();var e=this.$el.find("#category-list .all-categories input").toArray(),f=this.$el.find("#category-list .all-categories .risk a").toArray();e=e.concat(f),f=this.$el.find("#category-list .category-list ul li input").toArray(),e=e.concat(f),this.allItemsArrayInCategoryDropdown=e}this.clearCategoryDropdownList()},renderMoreOnRisk:function(){var b=this.respDataForMFEAval,c=this;void 0!=b&&void 0!=b[0]&&void 0!=b[0].disclosures&&a.each(b[0].disclosures[0].sectionCodes,function(b,d){if("MFELAND"==d.code){var e=d.disclosureList;a.each(e,function(b,d){if("MFE More on Ctgy Risk Disc"==d.code){var e=d.text;c.$el.find("#cat-more-on-risk .scrollable-section").html(e)}if("MFE Learn More"==d.code){var e=a("<div/>").html(d.text).text();c.$el.find("#learn-more .scrollable-section").html(e)}})}})},assetClassArray:[{id:"ALL",name:"All Bond Asset Classes"},{id:"MBND",name:"Municipal Bond"},{id:"TBND",name:"Taxable Bond"}],getAssetClassNameById:function(a){for(var b=0;b<this.assetClassArray.length;b++)if(this.assetClassArray[b].id==a)return this.assetClassArray[b].name},createHoverBoxes:function(b,c){var d,e=a('<div id="#hoverboxes"/>').appendTo("body");c[0].disclosures&&c[0].disclosures[0].entities&&(a.each(c[0].disclosures[0].entities,function(a,b){if("MSTAR_CTGY_C"===b.entityName&&b.sectionCodes.length>0)return d=b.sectionCodes[0].disclosureList,!1}),a.each(b,function(b,c){if("Municipal Bond"!==c.description&&"Taxable Bond"!==c.description)return!0;a.each(c.categories,function(b,c){var f="";a.each(d,function(a,b){if(b.code.substring(2,4)===c.code)return f=b.text,!1});var g='<div class="category-popup" id="'+c.code+'0_tip" style="display:none;"><h2>Category Risk</h2>'+f+"</div>";e.append(g)})}))},toggleCatToolip:function(b){var c=b.currentTarget,d=a(c),e=d.offset().left+d.width()+"px",f=d.offset().top-d.height()+"px",g=d.attr("id"),h=a("#"+g+"_tip");h.css({left:e,top:f}),h.toggle()},loadData:function(){var c=this;return new b.MFEFundTypesTask({context:this,data:{},onPreExecute:function(){},onSuccess:function(b){c.respDataForMFEFundType=b,this.respDataForMFEFundType&&a.when(c.fundtypeDeferred).done(function(a){c.createHoverBoxes(c.respDataForMFEFundType,c.respDataForMFEDisclosure)})},onError:function(a,b,c){alert("error in fetching asset class")},onComplete:function(){}}).run(),this.aValDeferred=new b.MFEAvalTask({context:this,data:{},onPreExecute:function(){},onSuccess:function(a){c.respDataForMFEAval=a,c.renderMoreOnRisk()},onError:function(a,b,c){},onComplete:function(){}}).run(),new b.MFEDisclosureTask({context:this,data:{},onPreExecute:function(){},onSuccess:function(a){c.respDataForMFEDisclosure=a,c.renderAssetClassDropDown()},onError:function(a,b,c){},onComplete:function(){}}).run()},toggleAssetClassDropdown:function(a){if("keydown"==a.type){if("9"==a.which)return this.$el.find(".frm-category .cat-select a").focus(),a.stopPropagation(),!1;if("13"!=a.which)return!1}a.stopPropagation(),this.$el.find("#category-list:visible").length>0&&this.$el.find("#category-list").hide(),this.$el.find("#assetOverlay").toggle(),this.$el.find("#assetOverlay:visible").length>0&&(this.$el.find(".selected").focus(),this.highlightAssetClassByli(this.$el.find("#assetList li.selected")[0]))},highlightAssetClass:function(a){this.highlightAssetClassByli(a.target)},highlightAssetClassByli:function(b){var c=b.id;this.$el.find(".grey-area").children().hide();for(var d,e=this.$el.find("#assetList li"),f=0;f<e.length;f+=1)value=e.eq(f),d=f+"_class",value.attr("id")==c?(this.$el.find("#assetList li.focused").removeClass("focused"),a(b).addClass("focused"),this.$el.find("#"+d).show()):(value.removeClass("focused"),this.$el.find("#"+d).hide())},selectOneAssetClass:function(a){a.stopPropagation(),a.preventDefault();var b=this.$el.find("#assetList li.focused").text();this.$el.find("#assetList li.selected").removeClass("selected"),this.$el.find("#assetList li.focused").addClass("selected"),this.$el.find("#allasset").html(this.$el.find("#assetList li.focused").text()),this.$el.find("#assetOverlay").hide(),this.$el.find(".selectbox-1 a").focus(),this.model.unset("category"),this.renderCategoryDropdown(b)},stopPropagationAndPreventDefault:function(a){a.stopPropagation(),a.preventDefault()},stopPropagation:function(a){a.stopPropagation()},displayRiskDistribution:function(b){var c=null;if(null!=this.respDataForMFEDisclosure&&void 0!==this.respDataForMFEDisclosure[0].disclosures){var d=this.respDataForMFEDisclosure[0].disclosures[0].entities,e=this.$el.find("#assetList li.focused").attr("id");a.each(d,function(b,d){"ASET_CLASS_X"==d.entityName&&(dataList=d.sectionCodes[0].disclosureList,a.each(dataList,function(a,b){("MFE Ctgy Risk Dstrb Desc ALT"===b.code&&"TBND"===e||"MFE Ctgy Risk Dstrb Desc ALT"===b.code&&"MBND"===e)&&(c=b.text)}))}),a("#bondfund #cat-risk-dist .scrollable-section").html(c)}var f=a("#bondfund #cat-risk-dist");this.locateModal(f),f.show(),a(".loading-indicator--modal-overlay-mask").show()},locateModal:function(b){var c=(a(window).width()-b.width())/2,d=(a(window).height()-b.height())/2;b.css({left:c,top:d})},closeRiskDistribution:function(b){if("keydown"==b.type&&"13"!=b.which)return!1;this.stopPropagationAndPreventDefault(b),a("#bondfund #cat-risk-dist").hide(),a(".loading-indicator--modal-overlay-mask").hide()},reactToKeydownForAssetClassDropdown:function(b){var c=null,d=this.$el.find(".asset-overlay #assetList li");if(13===b.which)this.selectOneAssetClass(b);else{if(27===b.which)return a("#assetOverlay").hide(),this.$el.find(".selectbox-1 a").focus(),!1;if(40===b.which||!b.shiftKey&&9===b.which)return c=this.getNeighbor(b.target,1,d.toArray()),this.highlightAssetClassByli(c[0]),c.focus(),!1;if(38===b.which||b.shiftKey&&9===b.which)return c=this.getNeighbor(b.target,-1,d.toArray()),this.highlightAssetClassByli(c[0]),c.focus(),!1}},getNeighbor:function(b,c,d){for(var e=0;e<d.length;e++)if(b.id==d[e].id){var f=-1;return f=1==c?e==d.length-1?0:e+1:0==e?d.length-1:e-1,a(d[f])}},toggleCategoryDropdown:function(a){if("keydown"==a.type&&"13"!=a.which||"none"!=this.$el.find("#frm-category-mask").css("display"))return!1;a.stopPropagation(),this.$el.find(".category-overlay").toggle(),this.$el.find(".category-overlay .all-categories input").focus()},selectOneCategory:function(a){a.stopPropagation();var b=this.$el.find(".category-overlay ul li input:checked"),c=b.length;if(0==c)this.$el.find(".frm-category #selcat .cat-select a").text("All Categories"),this.$el.find(".category-overlay .all-categories input").prop("checked",!0),this.model.unset("category");else{var d=null;if(1==c)this.$el.find(".frm-category #selcat .cat-select a").text("1 Category Selected"),this.$el.find(".category-overlay .all-categories input").prop("checked",!1),d=this.$el.find(".category-overlay ul li input:checked")[0].id;else{this.$el.find(".frm-category #selcat .cat-select a").text(c+" Categories Selected"),this.$el.find(".category-overlay .all-categories input").prop("checked",!1),d=b[0].id;for(var e=1;e<b.length;e++)d=d+","+b[e].id}this.model.set("category",d)}},toggleAllCats:function(a){a.stopPropagation(),this.$el.find(".category-overlay .all-categories input").is(":checked")&&(this.$el.find(".category-overlay ul li input:checked").prop("checked",!1),this.$el.find(".frm-category #selcat .cat-select a").text("All Categories"),this.model.unset("category"))},displayMoreOnRisk:function(b){return b.stopPropagation(),$moreOnRisk=this.$el.find("#cat-more-on-risk"),this.locateModal($moreOnRisk),a(".loading-indicator--modal-overlay-mask").show(),$moreOnRisk.show(),!1},closeMoreOnRisk:function(b){this.stopPropagationAndPreventDefault(b),a("#bondfund #cat-more-on-risk").hide(),a(".loading-indicator--modal-overlay-mask").hide()},clearCategoryDropdownList:function(){this.$el.find(".category-overlay ul li input:checked").prop("checked",!1),this.$el.find(".category-overlay .all-categories input").prop("checked",!0),this.$el.find(".frm-category #selcat .cat-select a").text("All Categories")},reactToKeydownForCategoryDropdown:function(a){return 40===a.which||!a.shiftKey&&9===a.which?(this.getNeighbor(a.target,1,this.allItemsArrayInCategoryDropdown).focus(),!1):38===a.which||a.shiftKey&&9===a.which?(this.getNeighbor(a.target,-1,this.allItemsArrayInCategoryDropdown).focus(),!1):void 0}})}(jQuery,window.FixedIncome=window.FixedIncome||{}),function(a,b){b.BodyView=Backbone.View.extend({events:{"click body":"hideDropdowns"},overlay:null,overlayHTML:null,initialize:function(){_.bindAll(this,"render","hideDropdowns"),this.render()},render:function(){return this},hideDropdowns:function(){this.$el.find(".loading-indicator--modal-overlay-mask:visible").length>0&&0==this.$el.find(".loading-indicator--wait-image:visible").length||(this.$el.find("#assetOverlay:visible").length>0&&this.$el.find("#assetOverlay").hide(),this.$el.find("#category-list:visible").length>0&&this.$el.find("#category-list").hide())},animatedWaitCreate:function(){this.overlay||(this.overlay=a(".loading-indicator--container"),this.overlayHTML=a(".loading-indicator").html(),a("body").append(this.overlayHTML)),a(".loading-indicator--wait-image").show(),this.overlay.show(),a(".loading-indicator--modal-overlay-mask").show()},animatedWaitDestroy:function(){a(".loading-indicator--wait-image").hide(),this.overlay&&this.overlay.hide(),a(".loading-indicator--modal-overlay-mask").hide()}}),b.bodyView=new b.BodyView({el:a(document)})}(jQuery,window.FixedIncome=window.FixedIncome||{}),function(a,b){b.QuantileView=Backbone.View.extend({defaults:{quintileFor:"ratings",selectedTextId:"selectedRating",el:"#ratings-sec",modelKey:"mStarRating",model:{}},events:{"click .star-rating a":"preventDefault"},initialize:function(a){this.options=_.extend({},this.defaults,a),_.bindAll(this,"render","initializeQuantile"),this.initializeQuantile(this.options.quintileFor,this.options.selectedTextId,this.options.modelKey)},render:function(){return this},initializeQuantile:function(b,c,d){var e="#"+b+" :radio.star",f=a("#"+c),g=defaultMessage=f.data("title")||f.html(),h=this;f.data("default-message",defaultMessage),this.quntls=a(e).rating({focus:function(b,c){f.html(c.title||"value: "+b),a(".clear-both").addClass("ie-please-rerender-clear").removeClass("ie-please-rerender-clear")},blur:function(b,c){f.html(g),a(".clear-both").addClass("ie-please-rerender-clear").removeClass("ie-please-rerender-clear")},callback:function(a,b){a&&(h.value&&h.value===a?(g=f.data("default-message"),h.value=0,h.model.unset(d),h.quntls.rating("select",-1)):(g=f.html(),h.value=a,h.model.set(d,h.value)))}})},preventDefault:function(a){a.preventDefault()}})}(jQuery,window.FixedIncome=window.FixedIncome||{});